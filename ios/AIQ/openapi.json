{
  "components": {
    "schemas": {
      "ABComparisonResult": {
        "description": "Response model for A/B comparison of scoring methods.",
        "properties": {
          "domain_scores": {
            "additionalProperties": {
              "type": "object"
            },
            "description": "Per-domain performance breakdown used in calculations",
            "title": "Domain Scores",
            "type": "object"
          },
          "equal_weights_score": {
            "$ref": "#/components/schemas/ABComparisonScore",
            "description": "Score using equal weights across all domains"
          },
          "score_difference": {
            "description": "Difference between weighted and equal scores (weighted - equal)",
            "nullable": true,
            "title": "Score Difference",
            "type": "integer"
          },
          "session_id": {
            "description": "Test session ID for which comparison was calculated",
            "title": "Session Id",
            "type": "integer"
          },
          "weighted_score": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ABComparisonScore"
              }
            ],
            "description": "Score using configured domain weights (None if no weights configured)",
            "nullable": true
          },
          "weights_used": {
            "additionalProperties": {
              "type": "number"
            },
            "description": "Domain weights used for weighted calculation",
            "nullable": true,
            "title": "Weights Used",
            "type": "object"
          }
        },
        "required": [
          "equal_weights_score",
          "domain_scores",
          "session_id"
        ],
        "title": "ABComparisonResult",
        "type": "object"
      },
      "ABComparisonScore": {
        "description": "Individual score result for A/B comparison.",
        "properties": {
          "accuracy_percentage": {
            "description": "Weighted or unweighted accuracy percentage",
            "title": "Accuracy Percentage",
            "type": "number"
          },
          "iq_score": {
            "description": "Calculated IQ score",
            "title": "Iq Score",
            "type": "integer"
          },
          "method": {
            "description": "Scoring method used: 'equal_weights' or 'weighted'",
            "title": "Method",
            "type": "string"
          }
        },
        "required": [
          "iq_score",
          "accuracy_percentage",
          "method"
        ],
        "title": "ABComparisonScore",
        "type": "object"
      },
      "ActionNeededQuestion": {
        "description": "A question requiring admin review or monitoring.",
        "properties": {
          "discrimination": {
            "description": "Current discrimination value (point-biserial correlation)",
            "title": "Discrimination",
            "type": "number"
          },
          "quality_flag": {
            "description": "Current quality flag status",
            "title": "Quality Flag",
            "type": "string"
          },
          "question_id": {
            "description": "Unique identifier of the question",
            "title": "Question Id",
            "type": "integer"
          },
          "reason": {
            "description": "Reason this question needs attention",
            "title": "Reason",
            "type": "string"
          },
          "response_count": {
            "description": "Number of responses used to calculate discrimination",
            "minimum": 0.0,
            "title": "Response Count",
            "type": "integer"
          }
        },
        "required": [
          "question_id",
          "discrimination",
          "response_count",
          "reason",
          "quality_flag"
        ],
        "title": "ActionNeededQuestion",
        "type": "object"
      },
      "AnalyticsEvent": {
        "description": "Schema for a single analytics event from the client.",
        "properties": {
          "event_name": {
            "description": "Event type identifier (e.g., 'user.login', 'test.started')",
            "maxLength": 100,
            "minLength": 1,
            "title": "Event Name",
            "type": "string"
          },
          "properties": {
            "description": "Optional event properties/metadata",
            "nullable": true,
            "title": "Properties",
            "type": "object"
          },
          "timestamp": {
            "description": "ISO 8601 timestamp when the event occurred on the client",
            "format": "date-time",
            "title": "Timestamp",
            "type": "string"
          }
        },
        "required": [
          "event_name",
          "timestamp"
        ],
        "title": "AnalyticsEvent",
        "type": "object"
      },
      "AnalyticsEventsBatch": {
        "description": "Schema for submitting a batch of analytics events.",
        "properties": {
          "app_version": {
            "description": "App version string",
            "maxLength": 20,
            "minLength": 1,
            "title": "App Version",
            "type": "string"
          },
          "client_platform": {
            "default": "ios",
            "description": "Client platform (e.g., 'ios', 'android', 'web')",
            "title": "Client Platform",
            "type": "string"
          },
          "device_id": {
            "description": "Optional device identifier for event correlation",
            "maxLength": 100,
            "nullable": true,
            "title": "Device Id",
            "type": "string"
          },
          "events": {
            "description": "List of analytics events (1-100 events per batch)",
            "items": {
              "$ref": "#/components/schemas/AnalyticsEvent"
            },
            "maxItems": 100,
            "minItems": 1,
            "title": "Events",
            "type": "array"
          }
        },
        "required": [
          "events",
          "app_version"
        ],
        "title": "AnalyticsEventsBatch",
        "type": "object"
      },
      "AnalyticsEventsResponse": {
        "description": "Response schema for analytics events submission.",
        "properties": {
          "events_received": {
            "description": "Number of events received",
            "title": "Events Received",
            "type": "integer"
          },
          "message": {
            "description": "Response message",
            "title": "Message",
            "type": "string"
          },
          "success": {
            "description": "Whether events were received successfully",
            "title": "Success",
            "type": "boolean"
          }
        },
        "required": [
          "success",
          "events_received",
          "message"
        ],
        "title": "AnalyticsEventsResponse",
        "type": "object"
      },
      "AnomalySummary": {
        "description": "Summary of response time anomalies across all sessions.",
        "properties": {
          "pct_flagged": {
            "description": "Percentage of sessions with any validity concern",
            "minimum": 0.0,
            "title": "Pct Flagged",
            "type": "number"
          },
          "sessions_with_extended_times": {
            "description": "Number of sessions with extended response times (> 5 minutes)",
            "minimum": 0.0,
            "title": "Sessions With Extended Times",
            "type": "integer"
          },
          "sessions_with_rapid_responses": {
            "description": "Number of sessions with rapid responses (< 3 seconds)",
            "minimum": 0.0,
            "title": "Sessions With Rapid Responses",
            "type": "integer"
          }
        },
        "required": [
          "sessions_with_rapid_responses",
          "sessions_with_extended_times",
          "pct_flagged"
        ],
        "title": "AnomalySummary",
        "type": "object"
      },
      "BackgroundJobListResponse": {
        "description": "Response model for listing background jobs.",
        "properties": {
          "completed": {
            "title": "Completed",
            "type": "integer"
          },
          "failed": {
            "title": "Failed",
            "type": "integer"
          },
          "jobs": {
            "items": {
              "$ref": "#/components/schemas/BackgroundJobResponse"
            },
            "title": "Jobs",
            "type": "array"
          },
          "running": {
            "title": "Running",
            "type": "integer"
          },
          "total": {
            "title": "Total",
            "type": "integer"
          }
        },
        "required": [
          "jobs",
          "total",
          "running",
          "completed",
          "failed"
        ],
        "title": "BackgroundJobListResponse",
        "type": "object"
      },
      "BackgroundJobResponse": {
        "description": "Response model for background job status.",
        "properties": {
          "command": {
            "items": {
              "type": "string"
            },
            "title": "Command",
            "type": "array"
          },
          "exit_code": {
            "nullable": true,
            "title": "Exit Code",
            "type": "integer"
          },
          "finished_at": {
            "nullable": true,
            "title": "Finished At",
            "type": "string"
          },
          "job_id": {
            "title": "Job Id",
            "type": "string"
          },
          "job_type": {
            "title": "Job Type",
            "type": "string"
          },
          "metadata": {
            "default": {},
            "title": "Metadata",
            "type": "object"
          },
          "pid": {
            "title": "Pid",
            "type": "integer"
          },
          "started_at": {
            "title": "Started At",
            "type": "string"
          },
          "status": {
            "title": "Status",
            "type": "string"
          },
          "working_directory": {
            "nullable": true,
            "title": "Working Directory",
            "type": "string"
          }
        },
        "required": [
          "job_id",
          "pid",
          "job_type",
          "started_at",
          "status",
          "command"
        ],
        "title": "BackgroundJobResponse",
        "type": "object"
      },
      "BackgroundJobStatsResponse": {
        "description": "Response model for background job statistics.",
        "properties": {
          "completed": {
            "title": "Completed",
            "type": "integer"
          },
          "failed": {
            "title": "Failed",
            "type": "integer"
          },
          "running": {
            "title": "Running",
            "type": "integer"
          },
          "terminated": {
            "title": "Terminated",
            "type": "integer"
          },
          "total_registered": {
            "title": "Total Registered",
            "type": "integer"
          }
        },
        "required": [
          "total_registered",
          "running",
          "completed",
          "failed",
          "terminated"
        ],
        "title": "BackgroundJobStatsResponse",
        "type": "object"
      },
      "ByDifficultyStats": {
        "description": "Response time statistics broken down by difficulty level.",
        "properties": {
          "easy": {
            "$ref": "#/components/schemas/DifficultyTimeStats",
            "description": "Time statistics for easy questions"
          },
          "hard": {
            "$ref": "#/components/schemas/DifficultyTimeStats",
            "description": "Time statistics for hard questions"
          },
          "medium": {
            "$ref": "#/components/schemas/DifficultyTimeStats",
            "description": "Time statistics for medium questions"
          }
        },
        "required": [
          "easy",
          "medium",
          "hard"
        ],
        "title": "ByDifficultyStats",
        "type": "object"
      },
      "ByQuestionTypeStats": {
        "description": "Response time statistics broken down by question type.",
        "properties": {
          "logic": {
            "$ref": "#/components/schemas/QuestionTypeTimeStats",
            "description": "Time statistics for logical reasoning questions"
          },
          "math": {
            "$ref": "#/components/schemas/QuestionTypeTimeStats",
            "description": "Time statistics for mathematical questions"
          },
          "memory": {
            "$ref": "#/components/schemas/QuestionTypeTimeStats",
            "description": "Time statistics for memory questions"
          },
          "pattern": {
            "$ref": "#/components/schemas/QuestionTypeTimeStats",
            "description": "Time statistics for pattern recognition questions"
          },
          "spatial": {
            "$ref": "#/components/schemas/QuestionTypeTimeStats",
            "description": "Time statistics for spatial reasoning questions"
          },
          "verbal": {
            "$ref": "#/components/schemas/QuestionTypeTimeStats",
            "description": "Time statistics for verbal reasoning questions"
          }
        },
        "required": [
          "pattern",
          "logic",
          "spatial",
          "math",
          "verbal",
          "memory"
        ],
        "title": "ByQuestionTypeStats",
        "type": "object"
      },
      "CalibrationHealthResponse": {
        "description": "Response schema for GET /v1/admin/questions/calibration-health.\n\nProvides a comprehensive overview of question calibration status\nacross the question pool.",
        "example": {
          "by_difficulty": {
            "easy": {
              "calibrated": 150,
              "miscalibrated": 20
            },
            "hard": {
              "calibrated": 90,
              "miscalibrated": 25
            },
            "medium": {
              "calibrated": 180,
              "miscalibrated": 35
            }
          },
          "by_severity": {
            "major": 25,
            "minor": 45,
            "severe": 10
          },
          "summary": {
            "correctly_calibrated": 420,
            "miscalibrated": 80,
            "miscalibration_rate": 0.16,
            "total_questions_with_data": 500
          },
          "worst_offenders": [
            {
              "assigned_difficulty": "hard",
              "empirical_difficulty": 0.85,
              "expected_range": [
                0.15,
                0.4
              ],
              "question_id": 123,
              "response_count": 156,
              "severity": "severe",
              "suggested_label": "easy"
            }
          ]
        },
        "properties": {
          "by_difficulty": {
            "$ref": "#/components/schemas/DifficultyBreakdown",
            "description": "Calibration status broken down by difficulty level"
          },
          "by_severity": {
            "$ref": "#/components/schemas/SeverityBreakdown",
            "description": "Miscalibrated questions broken down by severity level"
          },
          "summary": {
            "$ref": "#/components/schemas/CalibrationSummary",
            "description": "Overall calibration summary statistics"
          },
          "worst_offenders": {
            "description": "Top 10 most severely miscalibrated questions",
            "items": {
              "$ref": "#/components/schemas/MiscalibratedQuestion"
            },
            "maxItems": 10,
            "title": "Worst Offenders",
            "type": "array"
          }
        },
        "required": [
          "summary",
          "by_severity",
          "by_difficulty",
          "worst_offenders"
        ],
        "title": "CalibrationHealthResponse",
        "type": "object"
      },
      "CalibrationSummary": {
        "description": "Summary statistics for calibration health.",
        "properties": {
          "correctly_calibrated": {
            "description": "Number of questions where empirical difficulty matches label",
            "title": "Correctly Calibrated",
            "type": "integer"
          },
          "miscalibrated": {
            "description": "Number of questions where empirical difficulty doesn't match label",
            "title": "Miscalibrated",
            "type": "integer"
          },
          "miscalibration_rate": {
            "description": "Proportion of questions that are miscalibrated (0.0-1.0)",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Miscalibration Rate",
            "type": "number"
          },
          "total_questions_with_data": {
            "description": "Total number of questions with sufficient response data",
            "title": "Total Questions With Data",
            "type": "integer"
          }
        },
        "required": [
          "total_questions_with_data",
          "correctly_calibrated",
          "miscalibrated",
          "miscalibration_rate"
        ],
        "title": "CalibrationSummary",
        "type": "object"
      },
      "ConfidenceIntervalSchema": {
        "description": "Schema for confidence interval data around an IQ score.\n\nConfidence intervals quantify the uncertainty in score measurement,\nproviding a range within which the true score is likely to fall.\nThis is calculated using the Standard Error of Measurement (SEM)\nderived from the test's reliability coefficient.\n\nExample: A score of 108 with CI [101, 115] at 95% confidence means\nthere is a 95% probability the true score falls between 101 and 115.",
        "properties": {
          "confidence_level": {
            "description": "Confidence level as a decimal (must be strictly between 0 and 1, e.g., 0.95 for 95% CI)",
            "exclusiveMaximum": 1.0,
            "exclusiveMinimum": 0.0,
            "title": "Confidence Level",
            "type": "number"
          },
          "lower": {
            "description": "Lower bound of the confidence interval (clamped to valid IQ range 40-160)",
            "maximum": 160.0,
            "minimum": 40.0,
            "title": "Lower",
            "type": "integer"
          },
          "standard_error": {
            "description": "Standard Error of Measurement (SEM) used to calculate the interval",
            "minimum": 0.0,
            "title": "Standard Error",
            "type": "number"
          },
          "upper": {
            "description": "Upper bound of the confidence interval (clamped to valid IQ range 40-160)",
            "maximum": 160.0,
            "minimum": 40.0,
            "title": "Upper",
            "type": "integer"
          }
        },
        "required": [
          "lower",
          "upper",
          "confidence_level",
          "standard_error"
        ],
        "title": "ConfidenceIntervalSchema",
        "type": "object"
      },
      "Day30ReminderPreviewResponse": {
        "description": "Response model for previewing Day 30 reminder candidates.",
        "properties": {
          "message": {
            "title": "Message",
            "type": "string"
          },
          "users": {
            "items": {},
            "title": "Users",
            "type": "array"
          },
          "users_count": {
            "title": "Users Count",
            "type": "integer"
          }
        },
        "required": [
          "message",
          "users_count",
          "users"
        ],
        "title": "Day30ReminderPreviewResponse",
        "type": "object"
      },
      "Day30ReminderResponse": {
        "description": "Response model for Day 30 reminder trigger.",
        "properties": {
          "failed": {
            "title": "Failed",
            "type": "integer"
          },
          "message": {
            "title": "Message",
            "type": "string"
          },
          "notifications_sent": {
            "title": "Notifications Sent",
            "type": "integer"
          },
          "success": {
            "title": "Success",
            "type": "integer"
          },
          "users_found": {
            "title": "Users Found",
            "type": "integer"
          }
        },
        "required": [
          "message",
          "users_found",
          "notifications_sent",
          "success",
          "failed"
        ],
        "title": "Day30ReminderResponse",
        "type": "object"
      },
      "DeviceTokenRegister": {
        "description": "Schema for registering an APNs device token.",
        "properties": {
          "device_token": {
            "description": "APNs device token (64-200 characters)",
            "maxLength": 200,
            "minLength": 64,
            "title": "Device Token",
            "type": "string"
          }
        },
        "required": [
          "device_token"
        ],
        "title": "DeviceTokenRegister",
        "type": "object"
      },
      "DeviceTokenResponse": {
        "description": "Schema for device token registration response.",
        "properties": {
          "message": {
            "description": "Response message",
            "title": "Message",
            "type": "string"
          },
          "success": {
            "description": "Whether registration was successful",
            "title": "Success",
            "type": "boolean"
          }
        },
        "required": [
          "success",
          "message"
        ],
        "title": "DeviceTokenResponse",
        "type": "object"
      },
      "DifficultyBreakdown": {
        "description": "Breakdown of calibration status by difficulty level.",
        "properties": {
          "easy": {
            "$ref": "#/components/schemas/DifficultyCalibrationStatus",
            "description": "Calibration status for easy questions"
          },
          "hard": {
            "$ref": "#/components/schemas/DifficultyCalibrationStatus",
            "description": "Calibration status for hard questions"
          },
          "medium": {
            "$ref": "#/components/schemas/DifficultyCalibrationStatus",
            "description": "Calibration status for medium questions"
          }
        },
        "required": [
          "easy",
          "medium",
          "hard"
        ],
        "title": "DifficultyBreakdown",
        "type": "object"
      },
      "DifficultyCalibrationStatus": {
        "description": "Calibration status for a specific difficulty level.",
        "properties": {
          "calibrated": {
            "description": "Number of correctly calibrated questions at this difficulty",
            "minimum": 0.0,
            "title": "Calibrated",
            "type": "integer"
          },
          "miscalibrated": {
            "description": "Number of miscalibrated questions at this difficulty",
            "minimum": 0.0,
            "title": "Miscalibrated",
            "type": "integer"
          }
        },
        "required": [
          "calibrated",
          "miscalibrated"
        ],
        "title": "DifficultyCalibrationStatus",
        "type": "object"
      },
      "DifficultyDiscrimination": {
        "description": "Discrimination statistics for a difficulty level.",
        "properties": {
          "mean_discrimination": {
            "description": "Mean discrimination value for this difficulty level",
            "title": "Mean Discrimination",
            "type": "number"
          },
          "negative_count": {
            "description": "Number of questions with negative discrimination at this difficulty",
            "minimum": 0.0,
            "title": "Negative Count",
            "type": "integer"
          }
        },
        "required": [
          "mean_discrimination",
          "negative_count"
        ],
        "title": "DifficultyDiscrimination",
        "type": "object"
      },
      "DifficultyTimeStats": {
        "description": "Response time statistics for a specific difficulty level.",
        "properties": {
          "mean_seconds": {
            "description": "Mean response time in seconds",
            "nullable": true,
            "title": "Mean Seconds",
            "type": "number"
          },
          "median_seconds": {
            "description": "Median response time in seconds",
            "nullable": true,
            "title": "Median Seconds",
            "type": "number"
          }
        },
        "title": "DifficultyTimeStats",
        "type": "object"
      },
      "DiscriminationDetailHistory": {
        "description": "Historical discrimination data point.",
        "properties": {
          "date": {
            "description": "Date of this discrimination calculation (ISO 8601 format)",
            "title": "Date",
            "type": "string"
          },
          "discrimination": {
            "description": "Discrimination value at this point in time",
            "title": "Discrimination",
            "type": "number"
          },
          "responses": {
            "description": "Number of responses at this point in time",
            "minimum": 0.0,
            "title": "Responses",
            "type": "integer"
          }
        },
        "required": [
          "date",
          "discrimination",
          "responses"
        ],
        "title": "DiscriminationDetailHistory",
        "type": "object"
      },
      "DiscriminationDetailResponse": {
        "description": "Response schema for GET /v1/admin/questions/{id}/discrimination-detail.\n\nProvides detailed discrimination information for a specific question.",
        "example": {
          "compared_to_difficulty_avg": "above",
          "compared_to_type_avg": "above",
          "discrimination": 0.42,
          "history": [
            {
              "date": "2025-11-01",
              "discrimination": 0.38,
              "responses": 50
            },
            {
              "date": "2025-11-15",
              "discrimination": 0.4,
              "responses": 100
            },
            {
              "date": "2025-12-01",
              "discrimination": 0.42,
              "responses": 156
            }
          ],
          "percentile_rank": 85,
          "quality_flag": "normal",
          "quality_tier": "excellent",
          "question_id": 123,
          "response_count": 156
        },
        "properties": {
          "compared_to_difficulty_avg": {
            "description": "How this question compares to the average for its difficulty (above, below, at)",
            "nullable": true,
            "title": "Compared To Difficulty Avg",
            "type": "string"
          },
          "compared_to_type_avg": {
            "description": "How this question compares to the average for its type (above, below, at)",
            "nullable": true,
            "title": "Compared To Type Avg",
            "type": "string"
          },
          "discrimination": {
            "description": "Current discrimination value (point-biserial correlation)",
            "nullable": true,
            "title": "Discrimination",
            "type": "number"
          },
          "history": {
            "description": "Historical discrimination values over time",
            "items": {
              "$ref": "#/components/schemas/DiscriminationDetailHistory"
            },
            "title": "History",
            "type": "array"
          },
          "percentile_rank": {
            "description": "Percentile rank of this question's discrimination among all questions",
            "maximum": 100.0,
            "minimum": 0.0,
            "nullable": true,
            "title": "Percentile Rank",
            "type": "integer"
          },
          "quality_flag": {
            "description": "Current quality flag status (normal, under_review, deactivated)",
            "title": "Quality Flag",
            "type": "string"
          },
          "quality_tier": {
            "allOf": [
              {
                "$ref": "#/components/schemas/QualityTier"
              }
            ],
            "description": "Quality tier classification based on discrimination value",
            "nullable": true
          },
          "question_id": {
            "description": "Unique identifier of the question",
            "title": "Question Id",
            "type": "integer"
          },
          "response_count": {
            "description": "Number of responses used to calculate discrimination",
            "minimum": 0.0,
            "title": "Response Count",
            "type": "integer"
          }
        },
        "required": [
          "question_id",
          "response_count",
          "quality_flag"
        ],
        "title": "DiscriminationDetailResponse",
        "type": "object"
      },
      "DiscriminationReportResponse": {
        "description": "Response schema for GET /v1/admin/questions/discrimination-report.\n\nProvides comprehensive discrimination analysis across all questions.",
        "example": {
          "action_needed": {
            "immediate_review": [
              {
                "discrimination": -0.15,
                "quality_flag": "under_review",
                "question_id": 123,
                "reason": "Negative discrimination: high scorers missing this question more than low scorers",
                "response_count": 87
              }
            ],
            "monitor": [
              {
                "discrimination": 0.05,
                "quality_flag": "normal",
                "question_id": 456,
                "reason": "Very poor discrimination: not differentiating between ability levels",
                "response_count": 62
              }
            ]
          },
          "by_difficulty": {
            "easy": {
              "mean_discrimination": 0.28,
              "negative_count": 2
            },
            "hard": {
              "mean_discrimination": 0.31,
              "negative_count": 3
            },
            "medium": {
              "mean_discrimination": 0.35,
              "negative_count": 3
            }
          },
          "by_type": {
            "logical_reasoning": {
              "mean_discrimination": 0.31,
              "negative_count": 1
            },
            "mathematical": {
              "mean_discrimination": 0.36,
              "negative_count": 1
            },
            "pattern_recognition": {
              "mean_discrimination": 0.33,
              "negative_count": 2
            },
            "spatial_reasoning": {
              "mean_discrimination": 0.29,
              "negative_count": 3
            },
            "verbal_reasoning": {
              "mean_discrimination": 0.3,
              "negative_count": 1
            }
          },
          "quality_distribution": {
            "acceptable_pct": 34.7,
            "excellent_pct": 19.8,
            "good_pct": 29.8,
            "problematic_pct": 15.8
          },
          "summary": {
            "acceptable": 156,
            "excellent": 89,
            "good": 134,
            "negative": 8,
            "poor": 45,
            "total_questions_with_data": 450,
            "very_poor": 18
          },
          "trends": {
            "mean_discrimination_30d": 0.32,
            "new_negative_this_week": 2
          }
        },
        "properties": {
          "action_needed": {
            "additionalProperties": {
              "items": {
                "$ref": "#/components/schemas/ActionNeededQuestion"
              },
              "type": "array"
            },
            "description": "Questions requiring attention, grouped by urgency (immediate_review, monitor)",
            "title": "Action Needed",
            "type": "object"
          },
          "by_difficulty": {
            "additionalProperties": {
              "$ref": "#/components/schemas/DifficultyDiscrimination"
            },
            "description": "Discrimination statistics grouped by difficulty level (easy, medium, hard)",
            "title": "By Difficulty",
            "type": "object"
          },
          "by_type": {
            "additionalProperties": {
              "$ref": "#/components/schemas/TypeDiscrimination"
            },
            "description": "Discrimination statistics grouped by question type",
            "title": "By Type",
            "type": "object"
          },
          "quality_distribution": {
            "$ref": "#/components/schemas/QualityDistribution",
            "description": "Percentage distribution of quality tiers"
          },
          "summary": {
            "$ref": "#/components/schemas/DiscriminationSummary",
            "description": "Summary counts by quality tier"
          },
          "trends": {
            "$ref": "#/components/schemas/DiscriminationTrends",
            "description": "Trend information for discrimination"
          }
        },
        "required": [
          "summary",
          "quality_distribution",
          "by_difficulty",
          "by_type",
          "action_needed",
          "trends"
        ],
        "title": "DiscriminationReportResponse",
        "type": "object"
      },
      "DiscriminationSummary": {
        "description": "Summary counts by quality tier.",
        "properties": {
          "acceptable": {
            "description": "Questions with discrimination 0.20-0.30",
            "minimum": 0.0,
            "title": "Acceptable",
            "type": "integer"
          },
          "excellent": {
            "description": "Questions with discrimination > 0.40",
            "minimum": 0.0,
            "title": "Excellent",
            "type": "integer"
          },
          "good": {
            "description": "Questions with discrimination 0.30-0.40",
            "minimum": 0.0,
            "title": "Good",
            "type": "integer"
          },
          "negative": {
            "description": "Questions with discrimination < 0.00",
            "minimum": 0.0,
            "title": "Negative",
            "type": "integer"
          },
          "poor": {
            "description": "Questions with discrimination 0.10-0.20",
            "minimum": 0.0,
            "title": "Poor",
            "type": "integer"
          },
          "total_questions_with_data": {
            "description": "Total questions with sufficient response data for discrimination analysis",
            "minimum": 0.0,
            "title": "Total Questions With Data",
            "type": "integer"
          },
          "very_poor": {
            "description": "Questions with discrimination 0.00-0.10",
            "minimum": 0.0,
            "title": "Very Poor",
            "type": "integer"
          }
        },
        "required": [
          "total_questions_with_data",
          "excellent",
          "good",
          "acceptable",
          "poor",
          "very_poor",
          "negative"
        ],
        "title": "DiscriminationSummary",
        "type": "object"
      },
      "DiscriminationTrends": {
        "description": "Trend information for discrimination analysis.",
        "properties": {
          "mean_discrimination_30d": {
            "description": "Mean discrimination across questions recalculated in last 30 days",
            "nullable": true,
            "title": "Mean Discrimination 30D",
            "type": "number"
          },
          "new_negative_this_week": {
            "description": "Number of questions newly flagged for negative discrimination this week",
            "minimum": 0.0,
            "title": "New Negative This Week",
            "type": "integer"
          }
        },
        "required": [
          "new_negative_this_week"
        ],
        "title": "DiscriminationTrends",
        "type": "object"
      },
      "DistractorAnalysisResponse": {
        "description": "Response schema for GET /v1/admin/questions/{id}/distractor-analysis.\n\nProvides detailed distractor effectiveness analysis for a single question.",
        "example": {
          "correct_answer": "32",
          "options": [
            {
              "bottom_quartile_rate": 0.23,
              "discrimination": "good",
              "discrimination_index": 0.15,
              "is_correct": false,
              "option_key": "A",
              "selection_rate": 0.12,
              "status": "functioning",
              "top_quartile_rate": 0.08
            },
            {
              "bottom_quartile_rate": 0.5,
              "discrimination": "inverted",
              "discrimination_index": -0.35,
              "is_correct": true,
              "option_key": "B",
              "selection_rate": 0.72,
              "status": "functioning",
              "top_quartile_rate": 0.85
            },
            {
              "bottom_quartile_rate": 0.03,
              "discrimination": "neutral",
              "discrimination_index": 0.02,
              "is_correct": false,
              "option_key": "C",
              "selection_rate": 0.01,
              "status": "non-functioning",
              "top_quartile_rate": 0.01
            },
            {
              "bottom_quartile_rate": 0.26,
              "discrimination": "good",
              "discrimination_index": 0.2,
              "is_correct": false,
              "option_key": "D",
              "selection_rate": 0.15,
              "status": "functioning",
              "top_quartile_rate": 0.06
            }
          ],
          "question_id": 123,
          "question_text": "What is the next number in the sequence: 2, 4, 8, 16, ?",
          "recommendations": [
            "Option 'C' is non-functioning (selected by only 1.0% of respondents). Consider revising or replacing."
          ],
          "summary": {
            "effective_option_count": 2.1,
            "functioning_distractors": 2,
            "guessing_probability": 0.48,
            "inverted_distractors": 0,
            "non_functioning_distractors": 1,
            "weak_distractors": 0
          },
          "total_responses": 234
        },
        "properties": {
          "correct_answer": {
            "description": "The correct answer for this question",
            "nullable": true,
            "title": "Correct Answer",
            "type": "string"
          },
          "options": {
            "description": "Analysis for each answer option",
            "items": {
              "$ref": "#/components/schemas/DistractorOptionAnalysis"
            },
            "title": "Options",
            "type": "array"
          },
          "question_id": {
            "description": "Unique identifier of the question",
            "title": "Question Id",
            "type": "integer"
          },
          "question_text": {
            "description": "The question text",
            "title": "Question Text",
            "type": "string"
          },
          "recommendations": {
            "description": "Actionable recommendations for improving distractors",
            "items": {
              "type": "string"
            },
            "title": "Recommendations",
            "type": "array"
          },
          "summary": {
            "$ref": "#/components/schemas/DistractorSummary",
            "description": "Summary statistics for distractor effectiveness"
          },
          "total_responses": {
            "description": "Total number of responses analyzed",
            "minimum": 0.0,
            "title": "Total Responses",
            "type": "integer"
          }
        },
        "required": [
          "question_id",
          "question_text",
          "total_responses",
          "options",
          "summary",
          "recommendations"
        ],
        "title": "DistractorAnalysisResponse",
        "type": "object"
      },
      "DistractorDiscrimination": {
        "description": "Discrimination classification for a distractor.",
        "enum": [
          "good",
          "neutral",
          "inverted"
        ],
        "title": "DistractorDiscrimination",
        "type": "string"
      },
      "DistractorOptionAnalysis": {
        "description": "Analysis of a single answer option (distractor or correct answer).",
        "properties": {
          "bottom_quartile_rate": {
            "description": "Selection rate among bottom 25% scorers",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Bottom Quartile Rate",
            "type": "number"
          },
          "discrimination": {
            "$ref": "#/components/schemas/DistractorDiscrimination",
            "description": "Discrimination classification based on quartile analysis"
          },
          "discrimination_index": {
            "description": "Discrimination index: bottom_quartile_rate - top_quartile_rate",
            "maximum": 1.0,
            "minimum": -1.0,
            "title": "Discrimination Index",
            "type": "number"
          },
          "is_correct": {
            "description": "Whether this is the correct answer",
            "title": "Is Correct",
            "type": "boolean"
          },
          "option_key": {
            "description": "The option identifier (e.g., 'A', 'B', 'C', 'D')",
            "title": "Option Key",
            "type": "string"
          },
          "selection_rate": {
            "description": "Proportion of respondents who selected this option (0.0-1.0)",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Selection Rate",
            "type": "number"
          },
          "status": {
            "$ref": "#/components/schemas/DistractorStatus",
            "description": "Status classification based on selection rate"
          },
          "top_quartile_rate": {
            "description": "Selection rate among top 25% scorers",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Top Quartile Rate",
            "type": "number"
          }
        },
        "required": [
          "option_key",
          "is_correct",
          "selection_rate",
          "status",
          "discrimination",
          "discrimination_index",
          "top_quartile_rate",
          "bottom_quartile_rate"
        ],
        "title": "DistractorOptionAnalysis",
        "type": "object"
      },
      "DistractorStatus": {
        "description": "Status classification for a distractor based on selection rate.",
        "enum": [
          "functioning",
          "weak",
          "non-functioning"
        ],
        "title": "DistractorStatus",
        "type": "string"
      },
      "DistractorSummary": {
        "description": "Summary statistics for distractor analysis.",
        "properties": {
          "effective_option_count": {
            "description": "Effective number of options using inverse Simpson index",
            "minimum": 0.0,
            "title": "Effective Option Count",
            "type": "number"
          },
          "functioning_distractors": {
            "description": "Number of distractors with >=5% selection rate",
            "minimum": 0.0,
            "title": "Functioning Distractors",
            "type": "integer"
          },
          "guessing_probability": {
            "description": "Probability of guessing correctly (1 / effective_option_count)",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Guessing Probability",
            "type": "number"
          },
          "inverted_distractors": {
            "description": "Number of distractors where high scorers select more than low scorers",
            "minimum": 0.0,
            "title": "Inverted Distractors",
            "type": "integer"
          },
          "non_functioning_distractors": {
            "description": "Number of distractors with <2% selection rate",
            "minimum": 0.0,
            "title": "Non Functioning Distractors",
            "type": "integer"
          },
          "weak_distractors": {
            "description": "Number of distractors with 2-5% selection rate",
            "minimum": 0.0,
            "title": "Weak Distractors",
            "type": "integer"
          }
        },
        "required": [
          "functioning_distractors",
          "weak_distractors",
          "non_functioning_distractors",
          "inverted_distractors",
          "effective_option_count",
          "guessing_probability"
        ],
        "title": "DistractorSummary",
        "type": "object"
      },
      "DistractorSummaryResponse": {
        "description": "Response schema for GET /v1/admin/questions/distractor-summary.\n\nProvides aggregate distractor effectiveness statistics across all\nmultiple-choice questions with sufficient response data.",
        "example": {
          "avg_effective_option_count": 3.1,
          "by_non_functioning_count": {
            "one": 52,
            "three_or_more": 3,
            "two": 12,
            "zero": 383
          },
          "by_question_type": {
            "logic": {
              "avg_effective_options": 3.4,
              "questions_with_issues": 10,
              "total_questions": 80
            },
            "pattern": {
              "avg_effective_options": 3.2,
              "questions_with_issues": 15,
              "total_questions": 100
            }
          },
          "inverted_rate": 0.027,
          "non_functioning_rate": 0.149,
          "questions_below_threshold": 25,
          "questions_with_inverted_distractors": 12,
          "questions_with_non_functioning_distractors": 67,
          "total_questions_analyzed": 450,
          "worst_offenders": [
            {
              "difficulty_level": "medium",
              "effective_option_count": 1.2,
              "inverted_count": 1,
              "non_functioning_count": 3,
              "question_id": 123,
              "question_type": "pattern",
              "total_responses": 156
            }
          ]
        },
        "properties": {
          "avg_effective_option_count": {
            "description": "Average effective option count across all analyzed questions",
            "nullable": true,
            "title": "Avg Effective Option Count",
            "type": "number"
          },
          "by_non_functioning_count": {
            "$ref": "#/components/schemas/NonFunctioningCountBreakdown",
            "description": "Breakdown of questions by number of non-functioning distractors"
          },
          "by_question_type": {
            "description": "Distractor statistics grouped by question type",
            "title": "By Question Type",
            "type": "object"
          },
          "inverted_rate": {
            "description": "Proportion of questions with inverted distractors",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Inverted Rate",
            "type": "number"
          },
          "non_functioning_rate": {
            "description": "Proportion of questions with non-functioning distractors",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Non Functioning Rate",
            "type": "number"
          },
          "questions_below_threshold": {
            "description": "Questions with insufficient responses for analysis",
            "minimum": 0.0,
            "title": "Questions Below Threshold",
            "type": "integer"
          },
          "questions_with_inverted_distractors": {
            "description": "Questions with at least one inverted distractor (high scorers prefer)",
            "minimum": 0.0,
            "title": "Questions With Inverted Distractors",
            "type": "integer"
          },
          "questions_with_non_functioning_distractors": {
            "description": "Questions with at least one non-functioning distractor (<2% selection)",
            "minimum": 0.0,
            "title": "Questions With Non Functioning Distractors",
            "type": "integer"
          },
          "total_questions_analyzed": {
            "description": "Total multiple-choice questions with sufficient data for analysis",
            "minimum": 0.0,
            "title": "Total Questions Analyzed",
            "type": "integer"
          },
          "worst_offenders": {
            "description": "Top 10 questions with most distractor issues (sorted by severity)",
            "items": {
              "$ref": "#/components/schemas/WorstOffenderQuestion"
            },
            "title": "Worst Offenders",
            "type": "array"
          }
        },
        "required": [
          "total_questions_analyzed",
          "questions_with_non_functioning_distractors",
          "questions_with_inverted_distractors",
          "non_functioning_rate",
          "inverted_rate",
          "by_non_functioning_count",
          "worst_offenders",
          "by_question_type",
          "questions_below_threshold"
        ],
        "title": "DistractorSummaryResponse",
        "type": "object"
      },
      "DomainWeightsRequest": {
        "description": "Request model for setting domain weights.",
        "properties": {
          "weights": {
            "additionalProperties": {
              "type": "number"
            },
            "description": "Domain weights. Keys should be domain names (pattern, logic, spatial, math, verbal, memory). Values should be positive floats that ideally sum to 1.0.",
            "examples": [
              {
                "logic": 0.18,
                "math": 0.17,
                "memory": 0.14,
                "pattern": 0.2,
                "spatial": 0.16,
                "verbal": 0.15
              }
            ],
            "title": "Weights",
            "type": "object"
          }
        },
        "required": [
          "weights"
        ],
        "title": "DomainWeightsRequest",
        "type": "object"
      },
      "DomainWeightsResponse": {
        "description": "Response model for domain weights configuration.",
        "properties": {
          "message": {
            "description": "Human-readable message describing the operation result",
            "title": "Message",
            "type": "string"
          },
          "updated_at": {
            "description": "When the weights were updated",
            "format": "date-time",
            "title": "Updated At",
            "type": "string"
          },
          "weights": {
            "additionalProperties": {
              "type": "number"
            },
            "description": "The configured domain weights",
            "title": "Weights",
            "type": "object"
          }
        },
        "required": [
          "weights",
          "message",
          "updated_at"
        ],
        "title": "DomainWeightsResponse",
        "type": "object"
      },
      "EducationLevelSchema": {
        "description": "Education level enumeration for API schemas.",
        "enum": [
          "high_school",
          "some_college",
          "associates",
          "bachelors",
          "masters",
          "doctorate",
          "prefer_not_to_say"
        ],
        "title": "EducationLevelSchema",
        "type": "string"
      },
      "FactorAnalysisRecommendation": {
        "description": "Recommendation based on factor analysis results.",
        "properties": {
          "category": {
            "description": "Category of recommendation (e.g., 'sample_size', 'reliability', 'loadings')",
            "title": "Category",
            "type": "string"
          },
          "message": {
            "description": "Human-readable recommendation message",
            "title": "Message",
            "type": "string"
          },
          "severity": {
            "description": "Severity level: 'info', 'warning', or 'critical'",
            "title": "Severity",
            "type": "string"
          }
        },
        "required": [
          "category",
          "message",
          "severity"
        ],
        "title": "FactorAnalysisRecommendation",
        "type": "object"
      },
      "FactorAnalysisResponse": {
        "description": "Response schema for GET /v1/admin/analytics/factor-analysis.\n\nProvides comprehensive factor analysis results including g-loadings\nper domain, variance explained, and reliability metrics.",
        "example": {
          "analysis_date": "2025-12-06T12:00:00Z",
          "g_loadings": {
            "logical_reasoning": 0.68,
            "mathematical": 0.65,
            "memory": 0.52,
            "pattern_recognition": 0.72,
            "spatial_reasoning": 0.61,
            "verbal_reasoning": 0.58
          },
          "n_items": 200,
          "recommendations": [
            {
              "category": "loadings",
              "message": "Pattern recognition shows highest g-loading (0.72). Consider weighting this domain more heavily.",
              "severity": "info"
            }
          ],
          "reliability": {
            "cronbachs_alpha": 0.78
          },
          "sample_size": 850,
          "variance_explained": 0.45,
          "warnings": []
        },
        "properties": {
          "analysis_date": {
            "description": "Timestamp when the analysis was performed",
            "format": "date-time",
            "title": "Analysis Date",
            "type": "string"
          },
          "g_loadings": {
            "additionalProperties": {
              "type": "number"
            },
            "description": "G-loading for each domain (domain name -> loading value)",
            "title": "G Loadings",
            "type": "object"
          },
          "n_items": {
            "description": "Number of questions included in the analysis",
            "minimum": 0.0,
            "title": "N Items",
            "type": "integer"
          },
          "recommendations": {
            "description": "Recommendations based on the analysis results",
            "items": {
              "$ref": "#/components/schemas/FactorAnalysisRecommendation"
            },
            "title": "Recommendations",
            "type": "array"
          },
          "reliability": {
            "$ref": "#/components/schemas/ReliabilityMetrics",
            "description": "Reliability metrics for the analysis"
          },
          "sample_size": {
            "description": "Number of completed test sessions used in the analysis",
            "minimum": 0.0,
            "title": "Sample Size",
            "type": "integer"
          },
          "variance_explained": {
            "description": "Proportion of total variance explained by the g-factor (0-1)",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Variance Explained",
            "type": "number"
          },
          "warnings": {
            "description": "Warnings generated during the analysis",
            "items": {
              "type": "string"
            },
            "title": "Warnings",
            "type": "array"
          }
        },
        "required": [
          "analysis_date",
          "sample_size",
          "n_items",
          "g_loadings",
          "variance_explained",
          "reliability"
        ],
        "title": "FactorAnalysisResponse",
        "type": "object"
      },
      "FeedbackCategorySchema": {
        "description": "Feedback category enumeration for API schemas.",
        "enum": [
          "bug_report",
          "feature_request",
          "general_feedback",
          "question_help",
          "other"
        ],
        "title": "FeedbackCategorySchema",
        "type": "string"
      },
      "FeedbackSubmitRequest": {
        "description": "Schema for feedback submission request.",
        "properties": {
          "category": {
            "$ref": "#/components/schemas/FeedbackCategorySchema",
            "description": "Feedback category"
          },
          "description": {
            "description": "Detailed feedback description",
            "maxLength": 5000,
            "minLength": 10,
            "title": "Description",
            "type": "string"
          },
          "email": {
            "description": "Email address for follow-up",
            "format": "email",
            "title": "Email",
            "type": "string"
          },
          "name": {
            "description": "Name of person submitting feedback",
            "maxLength": 100,
            "minLength": 1,
            "title": "Name",
            "type": "string"
          }
        },
        "required": [
          "name",
          "email",
          "category",
          "description"
        ],
        "title": "FeedbackSubmitRequest",
        "type": "object"
      },
      "FeedbackSubmitResponse": {
        "description": "Schema for feedback submission response.",
        "example": {
          "message": "Thank you for your feedback! We'll review it shortly.",
          "submission_id": 42,
          "success": true
        },
        "properties": {
          "message": {
            "description": "Success message",
            "title": "Message",
            "type": "string"
          },
          "submission_id": {
            "description": "ID of the created feedback submission",
            "title": "Submission Id",
            "type": "integer"
          },
          "success": {
            "description": "Whether submission was successful",
            "title": "Success",
            "type": "boolean"
          }
        },
        "required": [
          "success",
          "submission_id",
          "message"
        ],
        "title": "FeedbackSubmitResponse",
        "type": "object"
      },
      "FlagSource": {
        "description": "Source of a validity flag (which analysis generated it).",
        "enum": [
          "person_fit",
          "time_check",
          "guttman_check"
        ],
        "title": "FlagSource",
        "type": "string"
      },
      "FlagTypeBreakdown": {
        "description": "Counts of each flag type detected across sessions.",
        "properties": {
          "aberrant_response_pattern": {
            "default": 0,
            "description": "Sessions with aberrant person-fit pattern",
            "minimum": 0.0,
            "title": "Aberrant Response Pattern",
            "type": "integer"
          },
          "elevated_guttman_errors": {
            "default": 0,
            "description": "Sessions with elevated Guttman error rate (20-30%)",
            "minimum": 0.0,
            "title": "Elevated Guttman Errors",
            "type": "integer"
          },
          "extended_pauses": {
            "default": 0,
            "description": "Sessions with extended pauses (>5 min)",
            "minimum": 0.0,
            "title": "Extended Pauses",
            "type": "integer"
          },
          "high_guttman_errors": {
            "default": 0,
            "description": "Sessions with high Guttman error rate (>30%)",
            "minimum": 0.0,
            "title": "High Guttman Errors",
            "type": "integer"
          },
          "multiple_rapid_responses": {
            "default": 0,
            "description": "Sessions with multiple rapid responses (<3s)",
            "minimum": 0.0,
            "title": "Multiple Rapid Responses",
            "type": "integer"
          },
          "suspiciously_fast_on_hard": {
            "default": 0,
            "description": "Sessions with suspiciously fast correct hard answers",
            "minimum": 0.0,
            "title": "Suspiciously Fast On Hard",
            "type": "integer"
          },
          "total_time_excessive": {
            "default": 0,
            "description": "Sessions taking too long (>2 hours)",
            "minimum": 0.0,
            "title": "Total Time Excessive",
            "type": "integer"
          },
          "total_time_too_fast": {
            "default": 0,
            "description": "Sessions completed too quickly (<5 min total)",
            "minimum": 0.0,
            "title": "Total Time Too Fast",
            "type": "integer"
          }
        },
        "title": "FlagTypeBreakdown",
        "type": "object"
      },
      "GenerationRunStatusSchema": {
        "description": "Status enumeration for question generation runs.",
        "enum": [
          "running",
          "success",
          "partial_failure",
          "failed"
        ],
        "title": "GenerationRunStatusSchema",
        "type": "string"
      },
      "GuttmanCheckDetails": {
        "description": "Detailed results from Guttman error detection.",
        "properties": {
          "correct_count": {
            "description": "Number of correct responses",
            "minimum": 0.0,
            "title": "Correct Count",
            "type": "integer"
          },
          "details": {
            "description": "Human-readable explanation",
            "title": "Details",
            "type": "string"
          },
          "error_count": {
            "description": "Number of Guttman errors detected",
            "minimum": 0.0,
            "title": "Error Count",
            "type": "integer"
          },
          "error_rate": {
            "description": "Error rate (error_count / max_possible_errors)",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Error Rate",
            "type": "number"
          },
          "incorrect_count": {
            "description": "Number of incorrect responses",
            "minimum": 0.0,
            "title": "Incorrect Count",
            "type": "integer"
          },
          "interpretation": {
            "description": "Classification: 'normal', 'elevated_errors', or 'high_errors_aberrant'",
            "title": "Interpretation",
            "type": "string"
          },
          "max_possible_errors": {
            "description": "Maximum possible errors for this response pattern",
            "minimum": 0.0,
            "title": "Max Possible Errors",
            "type": "integer"
          },
          "total_responses": {
            "description": "Number of responses analyzed",
            "minimum": 0.0,
            "title": "Total Responses",
            "type": "integer"
          }
        },
        "required": [
          "error_count",
          "max_possible_errors",
          "error_rate",
          "interpretation",
          "total_responses",
          "correct_count",
          "incorrect_count",
          "details"
        ],
        "title": "GuttmanCheckDetails",
        "type": "object"
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "title": "Detail",
            "type": "array"
          }
        },
        "title": "HTTPValidationError",
        "type": "object"
      },
      "InsufficientSampleResponse": {
        "description": "Error response when sample size is insufficient for factor analysis.",
        "example": {
          "error": "insufficient_sample",
          "message": "Sample size (250) is below minimum (500) required for reliable factor analysis.",
          "minimum_required": 500,
          "recommendation": "Approximately 250 more completed test sessions are needed before factor analysis can be performed.",
          "sample_size": 250
        },
        "properties": {
          "error": {
            "default": "insufficient_sample",
            "description": "Error code for insufficient sample size",
            "title": "Error",
            "type": "string"
          },
          "message": {
            "description": "Human-readable error message",
            "title": "Message",
            "type": "string"
          },
          "minimum_required": {
            "description": "Minimum sample size required for analysis",
            "minimum": 0.0,
            "title": "Minimum Required",
            "type": "integer"
          },
          "recommendation": {
            "description": "Recommendation for when to retry",
            "title": "Recommendation",
            "type": "string"
          },
          "sample_size": {
            "description": "Current sample size",
            "minimum": 0.0,
            "title": "Sample Size",
            "type": "integer"
          }
        },
        "required": [
          "message",
          "sample_size",
          "minimum_required",
          "recommendation"
        ],
        "title": "InsufficientSampleResponse",
        "type": "object"
      },
      "InternalConsistencyMetrics": {
        "description": "Metrics for internal consistency (Cronbach's alpha).\n\nCronbach's alpha measures how well test items measure the same construct.\nValues range from 0 to 1, with higher values indicating better consistency.",
        "properties": {
          "cronbachs_alpha": {
            "description": "Cronbach's alpha coefficient (0.0-1.0). None if insufficient data.",
            "maximum": 1.0,
            "minimum": 0.0,
            "nullable": true,
            "title": "Cronbachs Alpha",
            "type": "number"
          },
          "interpretation": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ReliabilityInterpretation"
              }
            ],
            "description": "Interpretation of alpha value: excellent (>=0.90), good (>=0.80), acceptable (>=0.70), questionable (>=0.60), poor (>=0.50), unacceptable (<0.50)",
            "nullable": true
          },
          "item_total_correlations": {
            "additionalProperties": {
              "type": "number"
            },
            "description": "Item-total correlations by question_id. Shows each item's contribution to overall reliability.",
            "nullable": true,
            "title": "Item Total Correlations",
            "type": "object"
          },
          "last_calculated": {
            "description": "Timestamp when this metric was last calculated",
            "format": "date-time",
            "nullable": true,
            "title": "Last Calculated",
            "type": "string"
          },
          "meets_threshold": {
            "description": "Whether alpha meets the minimum acceptable threshold (>= 0.70)",
            "title": "Meets Threshold",
            "type": "boolean"
          },
          "num_items": {
            "description": "Number of test items (questions) included in the analysis",
            "minimum": 0.0,
            "nullable": true,
            "title": "Num Items",
            "type": "integer"
          },
          "num_sessions": {
            "description": "Number of test sessions used in the calculation",
            "minimum": 0.0,
            "title": "Num Sessions",
            "type": "integer"
          }
        },
        "required": [
          "meets_threshold",
          "num_sessions"
        ],
        "title": "InternalConsistencyMetrics",
        "type": "object"
      },
      "MetricType": {
        "description": "Type of reliability metric stored in the database.",
        "enum": [
          "cronbachs_alpha",
          "test_retest",
          "split_half"
        ],
        "title": "MetricType",
        "type": "string"
      },
      "MiscalibratedQuestion": {
        "description": "Details of a miscalibrated question.",
        "properties": {
          "assigned_difficulty": {
            "description": "AI-assigned difficulty label (easy, medium, hard)",
            "title": "Assigned Difficulty",
            "type": "string"
          },
          "empirical_difficulty": {
            "description": "Empirical p-value (proportion of users answering correctly)",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Empirical Difficulty",
            "type": "number"
          },
          "expected_range": {
            "description": "Expected p-value range for assigned difficulty [min, max]",
            "items": {
              "type": "number"
            },
            "maxItems": 2,
            "minItems": 2,
            "title": "Expected Range",
            "type": "array"
          },
          "question_id": {
            "description": "Unique identifier of the question",
            "title": "Question Id",
            "type": "integer"
          },
          "response_count": {
            "description": "Number of responses used to calculate empirical difficulty",
            "minimum": 0.0,
            "title": "Response Count",
            "type": "integer"
          },
          "severity": {
            "$ref": "#/components/schemas/app__schemas__calibration__SeverityLevel",
            "description": "Severity of miscalibration (minor, major, severe)"
          },
          "suggested_label": {
            "description": "Recommended difficulty label based on empirical data",
            "title": "Suggested Label",
            "type": "string"
          }
        },
        "required": [
          "question_id",
          "assigned_difficulty",
          "empirical_difficulty",
          "expected_range",
          "suggested_label",
          "response_count",
          "severity"
        ],
        "title": "MiscalibratedQuestion",
        "type": "object"
      },
      "NonFunctioningCountBreakdown": {
        "description": "Breakdown of questions by number of non-functioning distractors.",
        "properties": {
          "one": {
            "description": "Questions with 1 non-functioning distractor",
            "minimum": 0.0,
            "title": "One",
            "type": "integer"
          },
          "three_or_more": {
            "description": "Questions with 3+ non-functioning distractors",
            "minimum": 0.0,
            "title": "Three Or More",
            "type": "integer"
          },
          "two": {
            "description": "Questions with 2 non-functioning distractors",
            "minimum": 0.0,
            "title": "Two",
            "type": "integer"
          },
          "zero": {
            "description": "Questions with 0 non-functioning distractors",
            "minimum": 0.0,
            "title": "Zero",
            "type": "integer"
          }
        },
        "required": [
          "zero",
          "one",
          "two",
          "three_or_more"
        ],
        "title": "NonFunctioningCountBreakdown",
        "type": "object"
      },
      "NotificationPreferences": {
        "description": "Schema for updating notification preferences.",
        "properties": {
          "notification_enabled": {
            "description": "Enable or disable push notifications",
            "title": "Notification Enabled",
            "type": "boolean"
          }
        },
        "required": [
          "notification_enabled"
        ],
        "title": "NotificationPreferences",
        "type": "object"
      },
      "NotificationPreferencesResponse": {
        "description": "Schema for notification preferences response.",
        "properties": {
          "message": {
            "description": "Response message",
            "title": "Message",
            "type": "string"
          },
          "notification_enabled": {
            "description": "Current notification preference",
            "title": "Notification Enabled",
            "type": "boolean"
          }
        },
        "required": [
          "notification_enabled",
          "message"
        ],
        "title": "NotificationPreferencesResponse",
        "type": "object"
      },
      "OverallStatus": {
        "description": "Overall reliability status for the test.",
        "enum": [
          "excellent",
          "acceptable",
          "needs_attention",
          "insufficient_data"
        ],
        "title": "OverallStatus",
        "type": "string"
      },
      "OverallTimeStats": {
        "description": "Overall response time statistics across all sessions.",
        "properties": {
          "mean_per_question_seconds": {
            "description": "Mean time per question across all responses",
            "nullable": true,
            "title": "Mean Per Question Seconds",
            "type": "number"
          },
          "mean_test_duration_seconds": {
            "description": "Mean total test duration in seconds",
            "nullable": true,
            "title": "Mean Test Duration Seconds",
            "type": "number"
          },
          "median_test_duration_seconds": {
            "description": "Median total test duration in seconds",
            "nullable": true,
            "title": "Median Test Duration Seconds",
            "type": "number"
          }
        },
        "title": "OverallTimeStats",
        "type": "object"
      },
      "PaginatedTestHistoryResponse": {
        "description": "Schema for paginated test history results.\n\nIncludes pagination metadata to support UI pagination controls.",
        "properties": {
          "has_more": {
            "description": "Whether there are more results beyond this page",
            "title": "Has More",
            "type": "boolean"
          },
          "limit": {
            "description": "Number of results per page (max 100)",
            "maximum": 100.0,
            "minimum": 1.0,
            "title": "Limit",
            "type": "integer"
          },
          "offset": {
            "description": "Offset from the start of the results",
            "minimum": 0.0,
            "title": "Offset",
            "type": "integer"
          },
          "results": {
            "description": "List of test results for the current page",
            "items": {
              "$ref": "#/components/schemas/TestResultResponse"
            },
            "title": "Results",
            "type": "array"
          },
          "total_count": {
            "description": "Total number of test results available for this user",
            "minimum": 0.0,
            "title": "Total Count",
            "type": "integer"
          }
        },
        "required": [
          "results",
          "total_count",
          "limit",
          "offset",
          "has_more"
        ],
        "title": "PaginatedTestHistoryResponse",
        "type": "object"
      },
      "PersonFitDetails": {
        "description": "Detailed results from person-fit heuristic analysis.",
        "properties": {
          "details": {
            "description": "Human-readable explanation",
            "title": "Details",
            "type": "string"
          },
          "fit_flag": {
            "description": "Classification: 'normal' or 'aberrant'",
            "title": "Fit Flag",
            "type": "string"
          },
          "fit_ratio": {
            "description": "Proportion of unexpected responses (0.0-1.0)",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Fit Ratio",
            "type": "number"
          },
          "score_percentile": {
            "description": "Score category: 'high', 'medium', or 'low'",
            "title": "Score Percentile",
            "type": "string"
          },
          "total_responses": {
            "description": "Total responses analyzed",
            "minimum": 0.0,
            "title": "Total Responses",
            "type": "integer"
          },
          "unexpected_correct": {
            "description": "Hard questions answered correctly when expected wrong",
            "minimum": 0.0,
            "title": "Unexpected Correct",
            "type": "integer"
          },
          "unexpected_incorrect": {
            "description": "Easy questions answered incorrectly when expected right",
            "minimum": 0.0,
            "title": "Unexpected Incorrect",
            "type": "integer"
          }
        },
        "required": [
          "fit_ratio",
          "fit_flag",
          "unexpected_correct",
          "unexpected_incorrect",
          "total_responses",
          "score_percentile",
          "details"
        ],
        "title": "PersonFitDetails",
        "type": "object"
      },
      "PipelineLosses": {
        "description": "Schema for tracking questions lost at each stage of the generation pipeline.\n\nThis provides insights into where questions are being lost during the\ngeneration process, helping identify bottlenecks and optimization opportunities.",
        "properties": {
          "deduplication_loss": {
            "description": "Questions removed as duplicates",
            "title": "Deduplication Loss",
            "type": "integer"
          },
          "deduplication_loss_pct": {
            "description": "Deduplication loss as percentage of approved",
            "nullable": true,
            "title": "Deduplication Loss Pct",
            "type": "number"
          },
          "evaluation_loss": {
            "description": "Questions lost due to not being evaluated (generated - evaluated)",
            "title": "Evaluation Loss",
            "type": "integer"
          },
          "evaluation_loss_pct": {
            "description": "Evaluation loss as percentage of generated",
            "nullable": true,
            "title": "Evaluation Loss Pct",
            "type": "number"
          },
          "generation_loss": {
            "description": "Questions lost during generation (requested - generated)",
            "title": "Generation Loss",
            "type": "integer"
          },
          "generation_loss_pct": {
            "description": "Generation loss as percentage of requested",
            "nullable": true,
            "title": "Generation Loss Pct",
            "type": "number"
          },
          "insertion_loss": {
            "description": "Questions lost during database insertion (approved - duplicates - inserted)",
            "title": "Insertion Loss",
            "type": "integer"
          },
          "insertion_loss_pct": {
            "description": "Insertion loss as percentage of (approved - duplicates)",
            "nullable": true,
            "title": "Insertion Loss Pct",
            "type": "number"
          },
          "rejection_loss": {
            "description": "Questions rejected by arbiter (evaluated - approved)",
            "title": "Rejection Loss",
            "type": "integer"
          },
          "rejection_loss_pct": {
            "description": "Rejection loss as percentage of evaluated",
            "nullable": true,
            "title": "Rejection Loss Pct",
            "type": "number"
          },
          "total_loss": {
            "description": "Total questions lost across all stages (requested - inserted)",
            "title": "Total Loss",
            "type": "integer"
          }
        },
        "required": [
          "generation_loss",
          "evaluation_loss",
          "rejection_loss",
          "deduplication_loss",
          "insertion_loss",
          "total_loss"
        ],
        "title": "PipelineLosses",
        "type": "object"
      },
      "QualityDistribution": {
        "description": "Percentage distribution of quality tiers.",
        "properties": {
          "acceptable_pct": {
            "description": "Percentage of questions with acceptable discrimination",
            "maximum": 100.0,
            "minimum": 0.0,
            "title": "Acceptable Pct",
            "type": "number"
          },
          "excellent_pct": {
            "description": "Percentage of questions with excellent discrimination",
            "maximum": 100.0,
            "minimum": 0.0,
            "title": "Excellent Pct",
            "type": "number"
          },
          "good_pct": {
            "description": "Percentage of questions with good discrimination",
            "maximum": 100.0,
            "minimum": 0.0,
            "title": "Good Pct",
            "type": "number"
          },
          "problematic_pct": {
            "description": "Percentage of questions with poor, very poor, or negative discrimination",
            "maximum": 100.0,
            "minimum": 0.0,
            "title": "Problematic Pct",
            "type": "number"
          }
        },
        "required": [
          "excellent_pct",
          "good_pct",
          "acceptable_pct",
          "problematic_pct"
        ],
        "title": "QualityDistribution",
        "type": "object"
      },
      "QualityFlagUpdateRequest": {
        "description": "Request model for updating a question's quality flag.",
        "properties": {
          "quality_flag": {
            "enum": [
              "normal",
              "under_review",
              "deactivated"
            ],
            "title": "Quality Flag",
            "type": "string"
          },
          "reason": {
            "nullable": true,
            "title": "Reason",
            "type": "string"
          }
        },
        "required": [
          "quality_flag"
        ],
        "title": "QualityFlagUpdateRequest",
        "type": "object"
      },
      "QualityFlagUpdateResponse": {
        "description": "Response model for quality flag update.",
        "properties": {
          "new_flag": {
            "title": "New Flag",
            "type": "string"
          },
          "previous_flag": {
            "title": "Previous Flag",
            "type": "string"
          },
          "question_id": {
            "title": "Question Id",
            "type": "integer"
          },
          "reason": {
            "nullable": true,
            "title": "Reason",
            "type": "string"
          },
          "updated_at": {
            "title": "Updated At",
            "type": "string"
          }
        },
        "required": [
          "question_id",
          "previous_flag",
          "new_flag",
          "reason",
          "updated_at"
        ],
        "title": "QualityFlagUpdateResponse",
        "type": "object"
      },
      "QualityTier": {
        "description": "Quality tier classification based on discrimination value.",
        "enum": [
          "excellent",
          "good",
          "acceptable",
          "poor",
          "very_poor",
          "negative"
        ],
        "title": "QualityTier",
        "type": "string"
      },
      "QuestionGenerationRunCreate": {
        "description": "Schema for creating a question generation run record.\n\nUsed by the question-service to report execution metrics to the backend.\nSupports both initial \"running\" status reports and final completion reports.",
        "properties": {
          "approval_rate": {
            "description": "Approval rate (0.0-1.0)",
            "nullable": true,
            "title": "Approval Rate",
            "type": "number"
          },
          "arbiter_config_version": {
            "description": "Arbiter config version used",
            "maxLength": 50,
            "nullable": true,
            "title": "Arbiter Config Version",
            "type": "string"
          },
          "avg_arbiter_score": {
            "description": "Average arbiter score",
            "nullable": true,
            "title": "Avg Arbiter Score",
            "type": "number"
          },
          "completed_at": {
            "description": "When the generation run completed (null if still running)",
            "format": "date-time",
            "nullable": true,
            "title": "Completed At",
            "type": "string"
          },
          "difficulty_metrics": {
            "additionalProperties": {
              "type": "integer"
            },
            "description": "Questions generated per difficulty. Example: {\"easy\": 15, \"medium\": 22, \"hard\": 13}",
            "nullable": true,
            "title": "Difficulty Metrics",
            "type": "object"
          },
          "duplicate_rate": {
            "description": "Duplicate rate (0.0-1.0)",
            "nullable": true,
            "title": "Duplicate Rate",
            "type": "number"
          },
          "duplicates_found": {
            "default": 0,
            "description": "Total duplicates found",
            "title": "Duplicates Found",
            "type": "integer"
          },
          "duration_seconds": {
            "description": "Total duration in seconds (null if still running)",
            "nullable": true,
            "title": "Duration Seconds",
            "type": "number"
          },
          "environment": {
            "description": "Environment: production, staging, or development",
            "maxLength": 20,
            "nullable": true,
            "title": "Environment",
            "type": "string"
          },
          "error_summary": {
            "description": "Error breakdown. Example: {\"by_category\": {\"rate_limit\": 2}, \"critical_count\": 0}",
            "nullable": true,
            "title": "Error Summary",
            "type": "object"
          },
          "exact_duplicates": {
            "default": 0,
            "description": "Exact text duplicates found",
            "title": "Exact Duplicates",
            "type": "integer"
          },
          "exit_code": {
            "description": "Exit code (0-6 matching run_generation.py codes)",
            "nullable": true,
            "title": "Exit Code",
            "type": "integer"
          },
          "generation_failures": {
            "default": 0,
            "description": "Number of generation failures",
            "title": "Generation Failures",
            "type": "integer"
          },
          "generation_success_rate": {
            "description": "Generation success rate (0.0-1.0)",
            "nullable": true,
            "title": "Generation Success Rate",
            "type": "number"
          },
          "insertion_failures": {
            "default": 0,
            "description": "Database insertion failures",
            "title": "Insertion Failures",
            "type": "integer"
          },
          "max_arbiter_score": {
            "description": "Maximum arbiter score",
            "nullable": true,
            "title": "Max Arbiter Score",
            "type": "number"
          },
          "min_arbiter_score": {
            "description": "Minimum arbiter score",
            "nullable": true,
            "title": "Min Arbiter Score",
            "type": "number"
          },
          "min_arbiter_score_threshold": {
            "description": "Minimum arbiter score threshold for approval",
            "nullable": true,
            "title": "Min Arbiter Score Threshold",
            "type": "number"
          },
          "overall_success_rate": {
            "description": "Overall success rate (questions_inserted / questions_requested)",
            "nullable": true,
            "title": "Overall Success Rate",
            "type": "number"
          },
          "prompt_version": {
            "description": "Prompt version used",
            "maxLength": 50,
            "nullable": true,
            "title": "Prompt Version",
            "type": "string"
          },
          "provider_metrics": {
            "additionalProperties": {
              "type": "object"
            },
            "description": "Per-provider metrics breakdown. Example: {\"openai\": {\"generated\": 10, \"api_calls\": 15}}",
            "nullable": true,
            "title": "Provider Metrics",
            "type": "object"
          },
          "questions_approved": {
            "default": 0,
            "description": "Questions approved by arbiter",
            "title": "Questions Approved",
            "type": "integer"
          },
          "questions_evaluated": {
            "default": 0,
            "description": "Questions evaluated by arbiter",
            "title": "Questions Evaluated",
            "type": "integer"
          },
          "questions_generated": {
            "default": 0,
            "description": "Number of questions generated",
            "title": "Questions Generated",
            "type": "integer"
          },
          "questions_inserted": {
            "default": 0,
            "description": "Questions inserted into database",
            "title": "Questions Inserted",
            "type": "integer"
          },
          "questions_rejected": {
            "default": 0,
            "description": "Questions rejected by arbiter",
            "title": "Questions Rejected",
            "type": "integer"
          },
          "questions_requested": {
            "description": "Number of questions requested",
            "title": "Questions Requested",
            "type": "integer"
          },
          "semantic_duplicates": {
            "default": 0,
            "description": "Semantic duplicates found",
            "title": "Semantic Duplicates",
            "type": "integer"
          },
          "started_at": {
            "description": "When the generation run started",
            "format": "date-time",
            "title": "Started At",
            "type": "string"
          },
          "status": {
            "$ref": "#/components/schemas/GenerationRunStatusSchema",
            "description": "Run status: running, success, partial_failure, or failed"
          },
          "total_api_calls": {
            "default": 0,
            "description": "Total API calls across all providers",
            "title": "Total Api Calls",
            "type": "integer"
          },
          "total_errors": {
            "default": 0,
            "description": "Total errors encountered",
            "title": "Total Errors",
            "type": "integer"
          },
          "triggered_by": {
            "description": "Trigger source: scheduler, manual, or webhook",
            "maxLength": 50,
            "nullable": true,
            "title": "Triggered By",
            "type": "string"
          },
          "type_metrics": {
            "additionalProperties": {
              "type": "integer"
            },
            "description": "Questions generated per type. Example: {\"pattern_recognition\": 8, \"logical_reasoning\": 12}",
            "nullable": true,
            "title": "Type Metrics",
            "type": "object"
          }
        },
        "required": [
          "started_at",
          "status",
          "questions_requested"
        ],
        "title": "QuestionGenerationRunCreate",
        "type": "object"
      },
      "QuestionGenerationRunCreateResponse": {
        "description": "Response schema for creating a question generation run record.\n\nReturns the created run ID and status for confirmation.",
        "properties": {
          "id": {
            "description": "The created run ID",
            "title": "Id",
            "type": "integer"
          },
          "message": {
            "description": "Confirmation message",
            "title": "Message",
            "type": "string"
          },
          "status": {
            "$ref": "#/components/schemas/GenerationRunStatusSchema",
            "description": "Status of the created run"
          }
        },
        "required": [
          "id",
          "status",
          "message"
        ],
        "title": "QuestionGenerationRunCreateResponse",
        "type": "object"
      },
      "QuestionGenerationRunDetail": {
        "description": "Detailed schema for a single generation run with computed fields.\n\nExtends QuestionGenerationRunRead with computed pipeline loss metrics\nto help analyze where questions are being lost in the generation process.",
        "properties": {
          "approval_rate": {
            "description": "Approval rate",
            "nullable": true,
            "title": "Approval Rate",
            "type": "number"
          },
          "arbiter_config_version": {
            "description": "Arbiter config version used",
            "nullable": true,
            "title": "Arbiter Config Version",
            "type": "string"
          },
          "avg_arbiter_score": {
            "description": "Average arbiter score",
            "nullable": true,
            "title": "Avg Arbiter Score",
            "type": "number"
          },
          "completed_at": {
            "description": "When the generation run completed",
            "format": "date-time",
            "nullable": true,
            "title": "Completed At",
            "type": "string"
          },
          "created_at": {
            "description": "Record creation timestamp",
            "format": "date-time",
            "title": "Created At",
            "type": "string"
          },
          "difficulty_metrics": {
            "additionalProperties": {
              "type": "integer"
            },
            "description": "Questions generated per difficulty",
            "nullable": true,
            "title": "Difficulty Metrics",
            "type": "object"
          },
          "duplicate_rate": {
            "description": "Duplicate rate",
            "nullable": true,
            "title": "Duplicate Rate",
            "type": "number"
          },
          "duplicates_found": {
            "description": "Total duplicates found",
            "title": "Duplicates Found",
            "type": "integer"
          },
          "duration_seconds": {
            "description": "Total duration in seconds",
            "nullable": true,
            "title": "Duration Seconds",
            "type": "number"
          },
          "environment": {
            "description": "Environment",
            "nullable": true,
            "title": "Environment",
            "type": "string"
          },
          "error_summary": {
            "description": "Error breakdown",
            "nullable": true,
            "title": "Error Summary",
            "type": "object"
          },
          "exact_duplicates": {
            "description": "Exact text duplicates found",
            "title": "Exact Duplicates",
            "type": "integer"
          },
          "exit_code": {
            "description": "Exit code",
            "nullable": true,
            "title": "Exit Code",
            "type": "integer"
          },
          "generation_failures": {
            "description": "Number of generation failures",
            "title": "Generation Failures",
            "type": "integer"
          },
          "generation_success_rate": {
            "description": "Generation success rate",
            "nullable": true,
            "title": "Generation Success Rate",
            "type": "number"
          },
          "id": {
            "description": "Run ID",
            "title": "Id",
            "type": "integer"
          },
          "insertion_failures": {
            "description": "Database insertion failures",
            "title": "Insertion Failures",
            "type": "integer"
          },
          "max_arbiter_score": {
            "description": "Maximum arbiter score",
            "nullable": true,
            "title": "Max Arbiter Score",
            "type": "number"
          },
          "min_arbiter_score": {
            "description": "Minimum arbiter score",
            "nullable": true,
            "title": "Min Arbiter Score",
            "type": "number"
          },
          "min_arbiter_score_threshold": {
            "description": "Minimum arbiter score threshold",
            "nullable": true,
            "title": "Min Arbiter Score Threshold",
            "type": "number"
          },
          "overall_success_rate": {
            "description": "Overall success rate",
            "nullable": true,
            "title": "Overall Success Rate",
            "type": "number"
          },
          "pipeline_losses": {
            "$ref": "#/components/schemas/PipelineLosses",
            "description": "Computed metrics showing questions lost at each pipeline stage"
          },
          "prompt_version": {
            "description": "Prompt version used",
            "nullable": true,
            "title": "Prompt Version",
            "type": "string"
          },
          "provider_metrics": {
            "additionalProperties": {
              "type": "object"
            },
            "description": "Per-provider metrics breakdown",
            "nullable": true,
            "title": "Provider Metrics",
            "type": "object"
          },
          "questions_approved": {
            "description": "Questions approved by arbiter",
            "title": "Questions Approved",
            "type": "integer"
          },
          "questions_evaluated": {
            "description": "Questions evaluated by arbiter",
            "title": "Questions Evaluated",
            "type": "integer"
          },
          "questions_generated": {
            "description": "Number of questions generated",
            "title": "Questions Generated",
            "type": "integer"
          },
          "questions_inserted": {
            "description": "Questions inserted into database",
            "title": "Questions Inserted",
            "type": "integer"
          },
          "questions_rejected": {
            "description": "Questions rejected by arbiter",
            "title": "Questions Rejected",
            "type": "integer"
          },
          "questions_requested": {
            "description": "Number of questions requested",
            "title": "Questions Requested",
            "type": "integer"
          },
          "semantic_duplicates": {
            "description": "Semantic duplicates found",
            "title": "Semantic Duplicates",
            "type": "integer"
          },
          "started_at": {
            "description": "When the generation run started",
            "format": "date-time",
            "title": "Started At",
            "type": "string"
          },
          "status": {
            "$ref": "#/components/schemas/GenerationRunStatusSchema",
            "description": "Run status"
          },
          "total_api_calls": {
            "description": "Total API calls",
            "title": "Total Api Calls",
            "type": "integer"
          },
          "total_errors": {
            "description": "Total errors encountered",
            "title": "Total Errors",
            "type": "integer"
          },
          "triggered_by": {
            "description": "Trigger source",
            "nullable": true,
            "title": "Triggered By",
            "type": "string"
          },
          "type_metrics": {
            "additionalProperties": {
              "type": "integer"
            },
            "description": "Questions generated per type",
            "nullable": true,
            "title": "Type Metrics",
            "type": "object"
          }
        },
        "required": [
          "id",
          "started_at",
          "status",
          "questions_requested",
          "questions_generated",
          "generation_failures",
          "questions_evaluated",
          "questions_approved",
          "questions_rejected",
          "duplicates_found",
          "exact_duplicates",
          "semantic_duplicates",
          "questions_inserted",
          "insertion_failures",
          "total_errors",
          "total_api_calls",
          "created_at",
          "pipeline_losses"
        ],
        "title": "QuestionGenerationRunDetail",
        "type": "object"
      },
      "QuestionGenerationRunListResponse": {
        "description": "Schema for paginated list of generation runs.",
        "properties": {
          "page": {
            "description": "Current page number (1-indexed)",
            "title": "Page",
            "type": "integer"
          },
          "page_size": {
            "description": "Number of items per page",
            "title": "Page Size",
            "type": "integer"
          },
          "runs": {
            "description": "List of generation run summaries",
            "items": {
              "$ref": "#/components/schemas/QuestionGenerationRunSummary"
            },
            "title": "Runs",
            "type": "array"
          },
          "total": {
            "description": "Total number of runs matching filters",
            "title": "Total",
            "type": "integer"
          },
          "total_pages": {
            "description": "Total number of pages",
            "title": "Total Pages",
            "type": "integer"
          }
        },
        "required": [
          "runs",
          "total",
          "page",
          "page_size",
          "total_pages"
        ],
        "title": "QuestionGenerationRunListResponse",
        "type": "object"
      },
      "QuestionGenerationRunStats": {
        "description": "Schema for aggregated statistics over a time period.\n\nProvides summary metrics for trend analysis, provider comparison,\nand quality monitoring dashboards.",
        "properties": {
          "approval_rate_trend": {
            "description": "Trend direction: improving, declining, or stable",
            "nullable": true,
            "title": "Approval Rate Trend",
            "type": "string"
          },
          "avg_api_calls_per_question": {
            "description": "Average API calls per successfully inserted question",
            "nullable": true,
            "title": "Avg Api Calls Per Question",
            "type": "number"
          },
          "avg_approval_rate": {
            "description": "Average approval rate",
            "nullable": true,
            "title": "Avg Approval Rate",
            "type": "number"
          },
          "avg_arbiter_score": {
            "description": "Average arbiter score",
            "nullable": true,
            "title": "Avg Arbiter Score",
            "type": "number"
          },
          "avg_duplicate_rate": {
            "description": "Average duplicate rate",
            "nullable": true,
            "title": "Avg Duplicate Rate",
            "type": "number"
          },
          "avg_duration_seconds": {
            "description": "Average run duration",
            "nullable": true,
            "title": "Avg Duration Seconds",
            "type": "number"
          },
          "avg_overall_success_rate": {
            "description": "Average overall success rate",
            "nullable": true,
            "title": "Avg Overall Success Rate",
            "type": "number"
          },
          "failed_runs": {
            "description": "Runs with status 'failed'",
            "title": "Failed Runs",
            "type": "integer"
          },
          "max_arbiter_score": {
            "description": "Maximum arbiter score across all runs",
            "nullable": true,
            "title": "Max Arbiter Score",
            "type": "number"
          },
          "min_arbiter_score": {
            "description": "Minimum arbiter score across all runs",
            "nullable": true,
            "title": "Min Arbiter Score",
            "type": "number"
          },
          "partial_failure_runs": {
            "description": "Runs with status 'partial_failure'",
            "title": "Partial Failure Runs",
            "type": "integer"
          },
          "period_end": {
            "description": "End of the analysis period",
            "format": "date-time",
            "title": "Period End",
            "type": "string"
          },
          "period_start": {
            "description": "Start of the analysis period",
            "format": "date-time",
            "title": "Period Start",
            "type": "string"
          },
          "provider_summary": {
            "additionalProperties": {
              "type": "object"
            },
            "description": "Aggregated metrics per provider. Example: {'openai': {'total_generated': 100, 'avg_success_rate': 0.85}}",
            "nullable": true,
            "title": "Provider Summary",
            "type": "object"
          },
          "success_rate_trend": {
            "description": "Trend direction: improving, declining, or stable",
            "nullable": true,
            "title": "Success Rate Trend",
            "type": "string"
          },
          "successful_runs": {
            "description": "Runs with status 'success'",
            "title": "Successful Runs",
            "type": "integer"
          },
          "total_api_calls": {
            "description": "Total API calls",
            "title": "Total Api Calls",
            "type": "integer"
          },
          "total_duplicates_found": {
            "description": "Total duplicates found",
            "title": "Total Duplicates Found",
            "type": "integer"
          },
          "total_errors": {
            "description": "Total errors across all runs",
            "title": "Total Errors",
            "type": "integer"
          },
          "total_questions_generated": {
            "description": "Total questions generated",
            "title": "Total Questions Generated",
            "type": "integer"
          },
          "total_questions_inserted": {
            "description": "Total questions inserted",
            "title": "Total Questions Inserted",
            "type": "integer"
          },
          "total_questions_requested": {
            "description": "Total questions requested",
            "title": "Total Questions Requested",
            "type": "integer"
          },
          "total_runs": {
            "description": "Total number of runs in period",
            "title": "Total Runs",
            "type": "integer"
          }
        },
        "required": [
          "period_start",
          "period_end",
          "total_runs",
          "successful_runs",
          "failed_runs",
          "partial_failure_runs",
          "total_questions_requested",
          "total_questions_generated",
          "total_questions_inserted",
          "total_duplicates_found",
          "total_api_calls",
          "total_errors"
        ],
        "title": "QuestionGenerationRunStats",
        "type": "object"
      },
      "QuestionGenerationRunSummary": {
        "description": "Summary schema for listing generation runs.\n\nReturns essential fields without the full JSONB breakdowns\nto optimize list queries.",
        "properties": {
          "approval_rate": {
            "description": "Approval rate",
            "nullable": true,
            "title": "Approval Rate",
            "type": "number"
          },
          "avg_arbiter_score": {
            "description": "Average arbiter score",
            "nullable": true,
            "title": "Avg Arbiter Score",
            "type": "number"
          },
          "completed_at": {
            "description": "When the run completed",
            "format": "date-time",
            "nullable": true,
            "title": "Completed At",
            "type": "string"
          },
          "duration_seconds": {
            "description": "Duration in seconds",
            "nullable": true,
            "title": "Duration Seconds",
            "type": "number"
          },
          "environment": {
            "description": "Environment",
            "nullable": true,
            "title": "Environment",
            "type": "string"
          },
          "id": {
            "description": "Run ID",
            "title": "Id",
            "type": "integer"
          },
          "overall_success_rate": {
            "description": "Overall success rate",
            "nullable": true,
            "title": "Overall Success Rate",
            "type": "number"
          },
          "questions_inserted": {
            "description": "Questions inserted",
            "title": "Questions Inserted",
            "type": "integer"
          },
          "questions_requested": {
            "description": "Questions requested",
            "title": "Questions Requested",
            "type": "integer"
          },
          "started_at": {
            "description": "When the run started",
            "format": "date-time",
            "title": "Started At",
            "type": "string"
          },
          "status": {
            "$ref": "#/components/schemas/GenerationRunStatusSchema",
            "description": "Run status"
          },
          "total_errors": {
            "description": "Total errors",
            "title": "Total Errors",
            "type": "integer"
          },
          "triggered_by": {
            "description": "Trigger source",
            "nullable": true,
            "title": "Triggered By",
            "type": "string"
          }
        },
        "required": [
          "id",
          "started_at",
          "status",
          "questions_requested",
          "questions_inserted",
          "total_errors"
        ],
        "title": "QuestionGenerationRunSummary",
        "type": "object"
      },
      "QuestionResponse": {
        "description": "Schema for individual question response.",
        "properties": {
          "answer_options": {
            "description": "Answer options for multiple choice as list (e.g., ['A', 'B', 'C', 'D'])",
            "items": {
              "type": "string"
            },
            "nullable": true,
            "title": "Answer Options",
            "type": "array"
          },
          "difficulty_level": {
            "description": "Difficulty level (easy, medium, hard)",
            "title": "Difficulty Level",
            "type": "string"
          },
          "explanation": {
            "description": "Explanation for the correct answer (if available)",
            "nullable": true,
            "title": "Explanation",
            "type": "string"
          },
          "id": {
            "description": "Question ID",
            "title": "Id",
            "type": "integer"
          },
          "question_text": {
            "description": "The question text",
            "title": "Question Text",
            "type": "string"
          },
          "question_type": {
            "description": "Type of question (pattern, logic, etc.)",
            "title": "Question Type",
            "type": "string"
          }
        },
        "required": [
          "id",
          "question_text",
          "question_type",
          "difficulty_level"
        ],
        "title": "QuestionResponse",
        "type": "object"
      },
      "QuestionTypeTimeStats": {
        "description": "Response time statistics for a specific question type.",
        "properties": {
          "mean_seconds": {
            "description": "Mean response time in seconds",
            "nullable": true,
            "title": "Mean Seconds",
            "type": "number"
          }
        },
        "title": "QuestionTypeTimeStats",
        "type": "object"
      },
      "RecalibratedQuestion": {
        "description": "Details of a recalibrated question.",
        "properties": {
          "empirical_difficulty": {
            "description": "Empirical p-value (proportion of users answering correctly)",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Empirical Difficulty",
            "type": "number"
          },
          "new_label": {
            "description": "New difficulty label after recalibration",
            "title": "New Label",
            "type": "string"
          },
          "old_label": {
            "description": "Previous difficulty label before recalibration",
            "title": "Old Label",
            "type": "string"
          },
          "question_id": {
            "description": "Unique identifier of the question",
            "title": "Question Id",
            "type": "integer"
          },
          "response_count": {
            "description": "Number of responses used to calculate empirical difficulty",
            "minimum": 0.0,
            "title": "Response Count",
            "type": "integer"
          },
          "severity": {
            "$ref": "#/components/schemas/app__schemas__calibration__SeverityLevel",
            "description": "Severity of miscalibration that triggered recalibration"
          }
        },
        "required": [
          "question_id",
          "old_label",
          "new_label",
          "empirical_difficulty",
          "response_count",
          "severity"
        ],
        "title": "RecalibratedQuestion",
        "type": "object"
      },
      "RecalibrationRequest": {
        "description": "Request schema for POST /v1/admin/questions/recalibrate.\n\nAllows triggering recalibration with configurable options.",
        "example": {
          "dry_run": true,
          "min_responses": 100,
          "severity_threshold": "major"
        },
        "properties": {
          "dry_run": {
            "default": true,
            "description": "If true, preview changes without applying. If false, commit changes.",
            "title": "Dry Run",
            "type": "boolean"
          },
          "min_responses": {
            "default": 100,
            "description": "Minimum responses required for reliable recalibration",
            "maximum": 1000.0,
            "minimum": 1.0,
            "title": "Min Responses",
            "type": "integer"
          },
          "question_ids": {
            "description": "Specific question IDs to recalibrate. If null, all eligible questions are considered.",
            "items": {
              "type": "integer"
            },
            "nullable": true,
            "title": "Question Ids",
            "type": "array"
          },
          "severity_threshold": {
            "$ref": "#/components/schemas/SeverityLevel-Input",
            "default": "major",
            "description": "Minimum severity level to trigger recalibration (minor, major, severe)"
          }
        },
        "title": "RecalibrationRequest",
        "type": "object"
      },
      "RecalibrationResponse": {
        "description": "Response schema for POST /v1/admin/questions/recalibrate.\n\nReturns details of recalibrated and skipped questions.",
        "example": {
          "dry_run": true,
          "recalibrated": [
            {
              "empirical_difficulty": 0.82,
              "new_label": "easy",
              "old_label": "hard",
              "question_id": 123,
              "response_count": 156,
              "severity": "severe"
            }
          ],
          "skipped": [
            {
              "assigned_difficulty": "medium",
              "question_id": 456,
              "reason": "below_threshold",
              "severity": "minor"
            }
          ],
          "total_recalibrated": 5
        },
        "properties": {
          "dry_run": {
            "description": "Whether this was a dry run (preview only)",
            "title": "Dry Run",
            "type": "boolean"
          },
          "recalibrated": {
            "description": "Questions that were recalibrated (or would be if dry_run=true)",
            "items": {
              "$ref": "#/components/schemas/RecalibratedQuestion"
            },
            "title": "Recalibrated",
            "type": "array"
          },
          "skipped": {
            "description": "Questions that were skipped with reasons",
            "items": {
              "$ref": "#/components/schemas/SkippedQuestion"
            },
            "title": "Skipped",
            "type": "array"
          },
          "total_recalibrated": {
            "description": "Total number of questions recalibrated",
            "minimum": 0.0,
            "title": "Total Recalibrated",
            "type": "integer"
          }
        },
        "required": [
          "recalibrated",
          "skipped",
          "total_recalibrated",
          "dry_run"
        ],
        "title": "RecalibrationResponse",
        "type": "object"
      },
      "RecommendationCategory": {
        "description": "Category of reliability recommendation.",
        "enum": [
          "data_collection",
          "item_review",
          "threshold_warning"
        ],
        "title": "RecommendationCategory",
        "type": "string"
      },
      "RecommendationPriority": {
        "description": "Priority level for recommendations.",
        "enum": [
          "high",
          "medium",
          "low"
        ],
        "title": "RecommendationPriority",
        "type": "string"
      },
      "ReliabilityHistoryItem": {
        "description": "A single historical reliability metric record.\n\nUsed for trend analysis of reliability metrics over time.",
        "properties": {
          "calculated_at": {
            "description": "Timestamp when this metric was calculated",
            "format": "date-time",
            "title": "Calculated At",
            "type": "string"
          },
          "details": {
            "description": "Additional context such as interpretation, thresholds, etc.",
            "nullable": true,
            "title": "Details",
            "type": "object"
          },
          "id": {
            "description": "Unique identifier of the reliability metric record",
            "title": "Id",
            "type": "integer"
          },
          "metric_type": {
            "$ref": "#/components/schemas/MetricType",
            "description": "Type of reliability metric: cronbachs_alpha, test_retest, split_half"
          },
          "sample_size": {
            "description": "Number of sessions or pairs used in the calculation",
            "minimum": 0.0,
            "title": "Sample Size",
            "type": "integer"
          },
          "value": {
            "description": "The calculated reliability coefficient value",
            "title": "Value",
            "type": "number"
          }
        },
        "required": [
          "id",
          "metric_type",
          "value",
          "sample_size",
          "calculated_at"
        ],
        "title": "ReliabilityHistoryItem",
        "type": "object"
      },
      "ReliabilityHistoryResponse": {
        "description": "Response schema for GET /v1/admin/reliability/history.\n\nReturns historical reliability metrics for trend analysis.",
        "example": {
          "metrics": [
            {
              "calculated_at": "2025-12-06T10:30:00Z",
              "details": {
                "interpretation": "good",
                "meets_threshold": true,
                "num_items": 20
              },
              "id": 15,
              "metric_type": "cronbachs_alpha",
              "sample_size": 523,
              "value": 0.78
            },
            {
              "calculated_at": "2025-11-29T10:30:00Z",
              "details": {
                "interpretation": "good",
                "meets_threshold": true,
                "num_items": 20
              },
              "id": 14,
              "metric_type": "cronbachs_alpha",
              "sample_size": 450,
              "value": 0.76
            }
          ],
          "total_count": 15
        },
        "properties": {
          "metrics": {
            "description": "Historical reliability metrics ordered by calculated_at DESC",
            "items": {
              "$ref": "#/components/schemas/ReliabilityHistoryItem"
            },
            "title": "Metrics",
            "type": "array"
          },
          "total_count": {
            "description": "Total number of metrics matching the query",
            "minimum": 0.0,
            "title": "Total Count",
            "type": "integer"
          }
        },
        "required": [
          "total_count"
        ],
        "title": "ReliabilityHistoryResponse",
        "type": "object"
      },
      "ReliabilityInterpretation": {
        "description": "Interpretation of reliability coefficient values.\n\nThe interpretation hierarchy reflects standard psychometric thresholds:\n- excellent: >= 0.90 (professional-grade reliability)\n- good: >= 0.80 (acceptable for most purposes)\n- acceptable: >= 0.70 (minimum for research applications)\n- questionable: >= 0.60 (borderline, warrants attention)\n- poor: >= 0.50 (below acceptable for most purposes)\n- unacceptable: < 0.50 (not reliable enough for meaningful interpretation)\n\nNote: Thresholds may differ slightly between metric types (Cronbach's alpha,\ntest-retest, split-half) but the interpretation meanings are consistent.",
        "enum": [
          "excellent",
          "good",
          "acceptable",
          "questionable",
          "poor",
          "unacceptable"
        ],
        "title": "ReliabilityInterpretation",
        "type": "string"
      },
      "ReliabilityMetrics": {
        "description": "Reliability metrics for the factor analysis.",
        "properties": {
          "cronbachs_alpha": {
            "description": "Cronbach's alpha reliability coefficient (-1 to 1). Negative values indicate poor item correlation. Values >= 0.7 are acceptable.",
            "title": "Cronbachs Alpha",
            "type": "number"
          }
        },
        "required": [
          "cronbachs_alpha"
        ],
        "title": "ReliabilityMetrics",
        "type": "object"
      },
      "ReliabilityRecommendation": {
        "description": "Actionable recommendation for improving reliability metrics.\n\nRecommendations are generated based on current metric values and\ndata collection status.",
        "properties": {
          "category": {
            "$ref": "#/components/schemas/RecommendationCategory",
            "description": "Recommendation category: data_collection, item_review, threshold_warning"
          },
          "message": {
            "description": "Human-readable recommendation message",
            "title": "Message",
            "type": "string"
          },
          "priority": {
            "$ref": "#/components/schemas/RecommendationPriority",
            "description": "Priority level: high, medium, low"
          }
        },
        "required": [
          "category",
          "message",
          "priority"
        ],
        "title": "ReliabilityRecommendation",
        "type": "object"
      },
      "ReliabilityReportResponse": {
        "description": "Response schema for GET /v1/admin/reliability.\n\nProvides comprehensive reliability metrics report including internal\nconsistency (Cronbach's alpha), test-retest reliability, and split-half\nreliability with interpretations and recommendations.",
        "example": {
          "internal_consistency": {
            "cronbachs_alpha": 0.78,
            "interpretation": "good",
            "item_total_correlations": {
              "1": 0.45,
              "2": 0.52,
              "3": 0.38
            },
            "last_calculated": "2025-12-06T10:30:00Z",
            "meets_threshold": true,
            "num_items": 20,
            "num_sessions": 523
          },
          "overall_status": "acceptable",
          "recommendations": [
            {
              "category": "data_collection",
              "message": "Test-retest sample size is low (89 pairs). Target: 100+",
              "priority": "medium"
            },
            {
              "category": "item_review",
              "message": "Consider removing 3 items with negative item-total correlations",
              "priority": "high"
            }
          ],
          "split_half": {
            "last_calculated": "2025-12-06T10:30:00Z",
            "meets_threshold": true,
            "num_sessions": 523,
            "raw_correlation": 0.71,
            "spearman_brown": 0.83
          },
          "test_retest": {
            "correlation": 0.65,
            "interpretation": "acceptable",
            "last_calculated": "2025-12-06T10:30:00Z",
            "mean_interval_days": 45.3,
            "meets_threshold": true,
            "num_pairs": 89,
            "practice_effect": 2.1
          }
        },
        "properties": {
          "internal_consistency": {
            "$ref": "#/components/schemas/InternalConsistencyMetrics",
            "description": "Cronbach's alpha and related internal consistency metrics"
          },
          "overall_status": {
            "$ref": "#/components/schemas/OverallStatus",
            "description": "Overall reliability status: excellent, acceptable, needs_attention, insufficient_data"
          },
          "recommendations": {
            "description": "Actionable recommendations for improving reliability",
            "items": {
              "$ref": "#/components/schemas/ReliabilityRecommendation"
            },
            "title": "Recommendations",
            "type": "array"
          },
          "split_half": {
            "$ref": "#/components/schemas/SplitHalfMetrics",
            "description": "Split-half reliability metrics with Spearman-Brown correction"
          },
          "test_retest": {
            "$ref": "#/components/schemas/TestRetestMetrics",
            "description": "Test-retest reliability metrics"
          }
        },
        "required": [
          "internal_consistency",
          "test_retest",
          "split_half",
          "overall_status"
        ],
        "title": "ReliabilityReportResponse",
        "type": "object"
      },
      "ResponseItem": {
        "description": "Schema for individual response item.",
        "properties": {
          "question_id": {
            "description": "Question ID being answered",
            "title": "Question Id",
            "type": "integer"
          },
          "time_spent_seconds": {
            "description": "Time spent on this question in seconds",
            "nullable": true,
            "title": "Time Spent Seconds",
            "type": "integer"
          },
          "user_answer": {
            "description": "User's answer to the question",
            "title": "User Answer",
            "type": "string"
          }
        },
        "required": [
          "question_id",
          "user_answer"
        ],
        "title": "ResponseItem",
        "type": "object"
      },
      "ResponseSubmission": {
        "description": "Schema for submitting test responses.",
        "properties": {
          "responses": {
            "description": "List of responses for the test session",
            "items": {
              "$ref": "#/components/schemas/ResponseItem"
            },
            "title": "Responses",
            "type": "array"
          },
          "session_id": {
            "description": "Test session ID",
            "title": "Session Id",
            "type": "integer"
          },
          "time_limit_exceeded": {
            "default": false,
            "description": "Flag indicating if the time limit was exceeded (client-reported)",
            "title": "Time Limit Exceeded",
            "type": "boolean"
          }
        },
        "required": [
          "session_id",
          "responses"
        ],
        "title": "ResponseSubmission",
        "type": "object"
      },
      "ResponseTimeAnalyticsResponse": {
        "description": "Response schema for GET /v1/admin/analytics/response-times.\n\nProvides aggregate response time analytics across all completed test sessions.",
        "example": {
          "anomaly_summary": {
            "pct_flagged": 3.2,
            "sessions_with_extended_times": 8,
            "sessions_with_rapid_responses": 23
          },
          "by_difficulty": {
            "easy": {
              "mean_seconds": 25,
              "median_seconds": 22
            },
            "hard": {
              "mean_seconds": 52,
              "median_seconds": 48
            },
            "medium": {
              "mean_seconds": 38,
              "median_seconds": 35
            }
          },
          "by_question_type": {
            "logic": {
              "mean_seconds": 45
            },
            "math": {
              "mean_seconds": 38
            },
            "memory": {
              "mean_seconds": 30
            },
            "pattern": {
              "mean_seconds": 42
            },
            "spatial": {
              "mean_seconds": 55
            },
            "verbal": {
              "mean_seconds": 28
            }
          },
          "overall": {
            "mean_per_question_seconds": 36,
            "mean_test_duration_seconds": 720,
            "median_test_duration_seconds": 680
          },
          "total_responses_analyzed": 30000,
          "total_sessions_analyzed": 1500
        },
        "properties": {
          "anomaly_summary": {
            "$ref": "#/components/schemas/AnomalySummary",
            "description": "Summary of response time anomalies"
          },
          "by_difficulty": {
            "$ref": "#/components/schemas/ByDifficultyStats",
            "description": "Response time statistics by difficulty level"
          },
          "by_question_type": {
            "$ref": "#/components/schemas/ByQuestionTypeStats",
            "description": "Response time statistics by question type"
          },
          "overall": {
            "$ref": "#/components/schemas/OverallTimeStats",
            "description": "Overall response time statistics"
          },
          "total_responses_analyzed": {
            "description": "Total number of responses with time data included in analysis",
            "minimum": 0.0,
            "title": "Total Responses Analyzed",
            "type": "integer"
          },
          "total_sessions_analyzed": {
            "description": "Total number of completed sessions included in analysis",
            "minimum": 0.0,
            "title": "Total Sessions Analyzed",
            "type": "integer"
          }
        },
        "required": [
          "overall",
          "by_difficulty",
          "by_question_type",
          "anomaly_summary",
          "total_sessions_analyzed",
          "total_responses_analyzed"
        ],
        "title": "ResponseTimeAnalyticsResponse",
        "type": "object"
      },
      "SessionNeedingReview": {
        "description": "Summary of a session that needs admin review.",
        "properties": {
          "completed_at": {
            "description": "When the test was completed",
            "format": "date-time",
            "nullable": true,
            "title": "Completed At",
            "type": "string"
          },
          "flags": {
            "description": "List of flag types detected",
            "items": {
              "type": "string"
            },
            "title": "Flags",
            "type": "array"
          },
          "session_id": {
            "description": "Test session ID",
            "title": "Session Id",
            "type": "integer"
          },
          "severity_score": {
            "description": "Severity score",
            "minimum": 0.0,
            "title": "Severity Score",
            "type": "integer"
          },
          "user_id": {
            "description": "User ID who took the test",
            "title": "User Id",
            "type": "integer"
          },
          "validity_status": {
            "$ref": "#/components/schemas/ValidityStatus",
            "description": "Session validity status"
          }
        },
        "required": [
          "session_id",
          "user_id",
          "validity_status",
          "severity_score",
          "flags"
        ],
        "title": "SessionNeedingReview",
        "type": "object"
      },
      "SessionValidityResponse": {
        "description": "Full validity assessment for a single test session.\n\nResponse schema for GET /v1/admin/sessions/{id}/validity endpoint.",
        "example": {
          "completed_at": "2025-12-10T15:30:00Z",
          "confidence": 0.55,
          "details": {
            "guttman_check": {
              "correct_count": 12,
              "details": "Elevated Guttman error rate detected.",
              "error_count": 15,
              "error_rate": 0.25,
              "incorrect_count": 13,
              "interpretation": "elevated_errors",
              "max_possible_errors": 60,
              "total_responses": 25
            },
            "person_fit": {
              "details": "Response pattern is consistent with expected performance.",
              "fit_flag": "normal",
              "fit_ratio": 0.12,
              "score_percentile": "medium",
              "total_responses": 25,
              "unexpected_correct": 1,
              "unexpected_incorrect": 2
            },
            "time_check": {
              "details": "High severity concern(s) detected.",
              "extended_pause_count": 0,
              "fast_hard_correct_count": 1,
              "rapid_response_count": 4,
              "statistics": {
                "max_time": 120.5,
                "mean_time": 34.0,
                "min_time": 2.1,
                "total_responses": 25
              },
              "total_time_seconds": 850.5,
              "validity_concern": true
            }
          },
          "flag_details": [
            {
              "count": 4,
              "details": "4 responses completed in under 3 seconds each.",
              "severity": "high",
              "source": "time_check",
              "type": "multiple_rapid_responses"
            },
            {
              "details": "Elevated Guttman error rate: 0.25",
              "error_rate": 0.25,
              "severity": "medium",
              "source": "guttman_check",
              "type": "elevated_guttman_errors"
            }
          ],
          "flags": [
            "multiple_rapid_responses",
            "elevated_guttman_errors"
          ],
          "session_id": 123,
          "severity_score": 3,
          "user_id": 456,
          "validity_checked_at": "2025-12-10T15:30:05Z",
          "validity_status": "suspect"
        },
        "properties": {
          "completed_at": {
            "description": "When the test session was completed",
            "format": "date-time",
            "nullable": true,
            "title": "Completed At",
            "type": "string"
          },
          "confidence": {
            "description": "Confidence in validity assessment (1.0 = fully confident, 0.0 = no confidence)",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Confidence",
            "type": "number"
          },
          "details": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ValidityDetails"
              }
            ],
            "description": "Full breakdown of each validity check (if available)",
            "nullable": true
          },
          "flag_details": {
            "description": "Detailed information for each flag",
            "items": {
              "$ref": "#/components/schemas/ValidityFlag"
            },
            "title": "Flag Details",
            "type": "array"
          },
          "flags": {
            "description": "List of flag type identifiers detected",
            "items": {
              "type": "string"
            },
            "title": "Flags",
            "type": "array"
          },
          "session_id": {
            "description": "Test session ID",
            "title": "Session Id",
            "type": "integer"
          },
          "severity_score": {
            "description": "Combined severity score (higher = more concerning)",
            "minimum": 0.0,
            "title": "Severity Score",
            "type": "integer"
          },
          "user_id": {
            "description": "User ID who took the test",
            "title": "User Id",
            "type": "integer"
          },
          "validity_checked_at": {
            "description": "When validity analysis was performed",
            "format": "date-time",
            "nullable": true,
            "title": "Validity Checked At",
            "type": "string"
          },
          "validity_status": {
            "$ref": "#/components/schemas/ValidityStatus",
            "description": "Overall validity status: valid, suspect, or invalid"
          }
        },
        "required": [
          "session_id",
          "user_id",
          "validity_status",
          "severity_score",
          "confidence",
          "flags",
          "flag_details"
        ],
        "title": "SessionValidityResponse",
        "type": "object"
      },
      "SeverityBreakdown": {
        "description": "Breakdown of miscalibrated questions by severity level.",
        "properties": {
          "major": {
            "description": "Questions 0.10-0.25 outside expected range",
            "minimum": 0.0,
            "title": "Major",
            "type": "integer"
          },
          "minor": {
            "description": "Questions within 0.10 of expected range boundary",
            "minimum": 0.0,
            "title": "Minor",
            "type": "integer"
          },
          "severe": {
            "description": "Questions >0.25 outside expected range",
            "minimum": 0.0,
            "title": "Severe",
            "type": "integer"
          }
        },
        "required": [
          "minor",
          "major",
          "severe"
        ],
        "title": "SeverityBreakdown",
        "type": "object"
      },
      "SeverityLevel-Input": {
        "description": "Severity level for miscalibration.",
        "enum": [
          "minor",
          "major",
          "severe"
        ],
        "title": "SeverityLevel",
        "type": "string"
      },
      "SkippedQuestion": {
        "description": "Details of a question that was skipped during recalibration.",
        "properties": {
          "assigned_difficulty": {
            "description": "Current difficulty label",
            "title": "Assigned Difficulty",
            "type": "string"
          },
          "question_id": {
            "description": "Unique identifier of the question",
            "title": "Question Id",
            "type": "integer"
          },
          "reason": {
            "description": "Reason for skipping: 'below_threshold', 'not_in_question_ids', 'insufficient_data', 'correctly_calibrated', 'database_error'",
            "title": "Reason",
            "type": "string"
          },
          "severity": {
            "allOf": [
              {
                "$ref": "#/components/schemas/app__schemas__calibration__SeverityLevel"
              }
            ],
            "description": "Severity of miscalibration (null for correctly calibrated or insufficient data)",
            "nullable": true
          }
        },
        "required": [
          "question_id",
          "reason",
          "assigned_difficulty"
        ],
        "title": "SkippedQuestion",
        "type": "object"
      },
      "SplitHalfMetrics": {
        "description": "Metrics for split-half reliability.\n\nSplit-half reliability splits each test into odd/even halves, correlates\nthe scores, and applies Spearman-Brown correction for full-test estimate.",
        "properties": {
          "last_calculated": {
            "description": "Timestamp when this metric was last calculated",
            "format": "date-time",
            "nullable": true,
            "title": "Last Calculated",
            "type": "string"
          },
          "meets_threshold": {
            "description": "Whether Spearman-Brown corrected reliability meets threshold (>= 0.70)",
            "title": "Meets Threshold",
            "type": "boolean"
          },
          "num_sessions": {
            "description": "Number of test sessions used in the calculation",
            "minimum": 0.0,
            "title": "Num Sessions",
            "type": "integer"
          },
          "raw_correlation": {
            "description": "Raw correlation between odd and even halves. None if insufficient data.",
            "maximum": 1.0,
            "minimum": -1.0,
            "nullable": true,
            "title": "Raw Correlation",
            "type": "number"
          },
          "spearman_brown": {
            "description": "Spearman-Brown corrected reliability for full test length",
            "maximum": 1.0,
            "minimum": -1.0,
            "nullable": true,
            "title": "Spearman Brown",
            "type": "number"
          }
        },
        "required": [
          "meets_threshold",
          "num_sessions"
        ],
        "title": "SplitHalfMetrics",
        "type": "object"
      },
      "StartTestResponse": {
        "description": "Schema for starting a new test session.",
        "properties": {
          "questions": {
            "description": "Questions for this test",
            "items": {
              "$ref": "#/components/schemas/QuestionResponse"
            },
            "title": "Questions",
            "type": "array"
          },
          "session": {
            "$ref": "#/components/schemas/TestSessionResponse",
            "description": "Created test session"
          },
          "total_questions": {
            "description": "Total number of questions in test",
            "title": "Total Questions",
            "type": "integer"
          }
        },
        "required": [
          "session",
          "questions",
          "total_questions"
        ],
        "title": "StartTestResponse",
        "type": "object"
      },
      "SubmitTestResponse": {
        "description": "Schema for response submission result.",
        "properties": {
          "message": {
            "description": "Confirmation message",
            "title": "Message",
            "type": "string"
          },
          "responses_count": {
            "description": "Number of responses submitted",
            "title": "Responses Count",
            "type": "integer"
          },
          "result": {
            "$ref": "#/components/schemas/TestResultResponse",
            "description": "Test result with IQ score"
          },
          "session": {
            "$ref": "#/components/schemas/TestSessionResponse",
            "description": "Updated test session"
          }
        },
        "required": [
          "session",
          "result",
          "responses_count",
          "message"
        ],
        "title": "SubmitTestResponse",
        "type": "object"
      },
      "TestResultResponse": {
        "description": "Schema for test result data.",
        "properties": {
          "accuracy_percentage": {
            "description": "Accuracy percentage (0-100)",
            "title": "Accuracy Percentage",
            "type": "number"
          },
          "completed_at": {
            "description": "Timestamp of completion",
            "format": "date-time",
            "title": "Completed At",
            "type": "string"
          },
          "completion_time_seconds": {
            "description": "Time taken to complete test in seconds",
            "nullable": true,
            "title": "Completion Time Seconds",
            "type": "integer"
          },
          "confidence_interval": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ConfidenceIntervalSchema"
              }
            ],
            "description": "Confidence interval for the IQ score. Null when reliability data is insufficient (< 0.60).",
            "nullable": true
          },
          "correct_answers": {
            "description": "Number of correct answers",
            "title": "Correct Answers",
            "type": "integer"
          },
          "domain_scores": {
            "additionalProperties": {
              "type": "object"
            },
            "description": "Per-domain performance breakdown with correct, total, pct, and percentile for each cognitive domain",
            "nullable": true,
            "title": "Domain Scores",
            "type": "object"
          },
          "id": {
            "description": "Test result ID",
            "title": "Id",
            "type": "integer"
          },
          "iq_score": {
            "description": "Calculated IQ score",
            "title": "Iq Score",
            "type": "integer"
          },
          "percentile_rank": {
            "description": "Percentile rank (0-100, what % of population scores below)",
            "nullable": true,
            "title": "Percentile Rank",
            "type": "number"
          },
          "response_time_flags": {
            "description": "Summary of response time anomalies (rapid responses, extended times, validity concerns)",
            "nullable": true,
            "title": "Response Time Flags",
            "type": "object"
          },
          "strongest_domain": {
            "description": "Name of the highest-scoring cognitive domain",
            "nullable": true,
            "title": "Strongest Domain",
            "type": "string"
          },
          "test_session_id": {
            "description": "Associated test session ID",
            "title": "Test Session Id",
            "type": "integer"
          },
          "total_questions": {
            "description": "Total questions in test",
            "title": "Total Questions",
            "type": "integer"
          },
          "user_id": {
            "description": "User ID",
            "title": "User Id",
            "type": "integer"
          },
          "weakest_domain": {
            "description": "Name of the lowest-scoring cognitive domain",
            "nullable": true,
            "title": "Weakest Domain",
            "type": "string"
          }
        },
        "required": [
          "id",
          "test_session_id",
          "user_id",
          "iq_score",
          "total_questions",
          "correct_answers",
          "accuracy_percentage",
          "completed_at"
        ],
        "title": "TestResultResponse",
        "type": "object"
      },
      "TestRetestMetrics": {
        "description": "Metrics for test-retest reliability.\n\nTest-retest reliability measures consistency of scores across repeated\nadministrations. Uses Pearson correlation between consecutive test scores.",
        "properties": {
          "correlation": {
            "description": "Pearson correlation coefficient between test and retest scores. None if insufficient data.",
            "maximum": 1.0,
            "minimum": -1.0,
            "nullable": true,
            "title": "Correlation",
            "type": "number"
          },
          "interpretation": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ReliabilityInterpretation"
              }
            ],
            "description": "Interpretation of correlation: excellent (>=0.90), good (>=0.80), acceptable (>=0.70), questionable (>=0.60), poor (>=0.50), unacceptable (<0.50)",
            "nullable": true
          },
          "last_calculated": {
            "description": "Timestamp when this metric was last calculated",
            "format": "date-time",
            "nullable": true,
            "title": "Last Calculated",
            "type": "string"
          },
          "mean_interval_days": {
            "description": "Mean number of days between test and retest",
            "minimum": 0.0,
            "nullable": true,
            "title": "Mean Interval Days",
            "type": "number"
          },
          "meets_threshold": {
            "description": "Whether correlation meets the minimum acceptable threshold (> 0.50)",
            "title": "Meets Threshold",
            "type": "boolean"
          },
          "num_pairs": {
            "description": "Number of test-retest pairs used in the calculation",
            "minimum": 0.0,
            "title": "Num Pairs",
            "type": "integer"
          },
          "practice_effect": {
            "description": "Mean score gain on retest (positive indicates improvement)",
            "nullable": true,
            "title": "Practice Effect",
            "type": "number"
          }
        },
        "required": [
          "meets_threshold",
          "num_pairs"
        ],
        "title": "TestRetestMetrics",
        "type": "object"
      },
      "TestSessionAbandonResponse": {
        "description": "Schema for abandoning a test session.",
        "properties": {
          "message": {
            "description": "Success message",
            "title": "Message",
            "type": "string"
          },
          "responses_saved": {
            "description": "Number of responses saved before abandonment",
            "title": "Responses Saved",
            "type": "integer"
          },
          "session": {
            "$ref": "#/components/schemas/TestSessionResponse",
            "description": "Abandoned test session"
          }
        },
        "required": [
          "session",
          "message",
          "responses_saved"
        ],
        "title": "TestSessionAbandonResponse",
        "type": "object"
      },
      "TestSessionResponse": {
        "description": "Schema for test session response.",
        "properties": {
          "completed_at": {
            "description": "Session completion timestamp",
            "format": "date-time",
            "nullable": true,
            "title": "Completed At",
            "type": "string"
          },
          "id": {
            "description": "Test session ID",
            "title": "Id",
            "type": "integer"
          },
          "started_at": {
            "description": "Session start timestamp",
            "format": "date-time",
            "title": "Started At",
            "type": "string"
          },
          "status": {
            "description": "Session status (in_progress, completed, abandoned)",
            "title": "Status",
            "type": "string"
          },
          "time_limit_exceeded": {
            "default": false,
            "description": "Flag indicating if 30-minute time limit was exceeded",
            "title": "Time Limit Exceeded",
            "type": "boolean"
          },
          "user_id": {
            "description": "User ID",
            "title": "User Id",
            "type": "integer"
          }
        },
        "required": [
          "id",
          "user_id",
          "status",
          "started_at"
        ],
        "title": "TestSessionResponse",
        "type": "object"
      },
      "TestSessionStatusResponse": {
        "description": "Schema for checking test session status.",
        "properties": {
          "questions": {
            "description": "Questions for this session (if session is in_progress)",
            "items": {
              "$ref": "#/components/schemas/QuestionResponse"
            },
            "nullable": true,
            "title": "Questions",
            "type": "array"
          },
          "questions_count": {
            "description": "Number of questions in this session",
            "title": "Questions Count",
            "type": "integer"
          },
          "session": {
            "$ref": "#/components/schemas/TestSessionResponse",
            "description": "Test session details"
          }
        },
        "required": [
          "session",
          "questions_count"
        ],
        "title": "TestSessionStatusResponse",
        "type": "object"
      },
      "TimeCheckDetails": {
        "description": "Detailed results from response time plausibility check.",
        "properties": {
          "details": {
            "description": "Human-readable explanation",
            "title": "Details",
            "type": "string"
          },
          "extended_pause_count": {
            "description": "Number of responses over 5 minutes",
            "minimum": 0.0,
            "title": "Extended Pause Count",
            "type": "integer"
          },
          "fast_hard_correct_count": {
            "description": "Hard questions answered correctly under 10 seconds",
            "minimum": 0.0,
            "title": "Fast Hard Correct Count",
            "type": "integer"
          },
          "rapid_response_count": {
            "description": "Number of responses under 3 seconds",
            "minimum": 0.0,
            "title": "Rapid Response Count",
            "type": "integer"
          },
          "statistics": {
            "$ref": "#/components/schemas/TimeCheckStatistics",
            "description": "Response time statistics"
          },
          "total_time_seconds": {
            "description": "Total test completion time in seconds",
            "minimum": 0.0,
            "title": "Total Time Seconds",
            "type": "number"
          },
          "validity_concern": {
            "description": "True if any high-severity time flags detected",
            "title": "Validity Concern",
            "type": "boolean"
          }
        },
        "required": [
          "validity_concern",
          "total_time_seconds",
          "rapid_response_count",
          "extended_pause_count",
          "fast_hard_correct_count",
          "statistics",
          "details"
        ],
        "title": "TimeCheckDetails",
        "type": "object"
      },
      "TimeCheckStatistics": {
        "description": "Response time statistics from time plausibility check.",
        "properties": {
          "max_time": {
            "description": "Slowest response time in seconds",
            "minimum": 0.0,
            "title": "Max Time",
            "type": "number"
          },
          "mean_time": {
            "description": "Average response time in seconds",
            "minimum": 0.0,
            "title": "Mean Time",
            "type": "number"
          },
          "min_time": {
            "description": "Fastest response time in seconds",
            "minimum": 0.0,
            "title": "Min Time",
            "type": "number"
          },
          "total_responses": {
            "description": "Number of responses with valid time data",
            "minimum": 0.0,
            "title": "Total Responses",
            "type": "integer"
          }
        },
        "required": [
          "mean_time",
          "min_time",
          "max_time",
          "total_responses"
        ],
        "title": "TimeCheckStatistics",
        "type": "object"
      },
      "Token": {
        "description": "Schema for token response (login only).",
        "properties": {
          "access_token": {
            "description": "JWT access token",
            "title": "Access Token",
            "type": "string"
          },
          "refresh_token": {
            "description": "JWT refresh token",
            "title": "Refresh Token",
            "type": "string"
          },
          "token_type": {
            "default": "bearer",
            "description": "Token type",
            "title": "Token Type",
            "type": "string"
          },
          "user": {
            "$ref": "#/components/schemas/UserResponse",
            "description": "User information"
          }
        },
        "required": [
          "access_token",
          "refresh_token",
          "user"
        ],
        "title": "Token",
        "type": "object"
      },
      "TokenRefresh": {
        "description": "Schema for token refresh response.",
        "properties": {
          "access_token": {
            "description": "New JWT access token",
            "title": "Access Token",
            "type": "string"
          },
          "refresh_token": {
            "description": "New JWT refresh token",
            "title": "Refresh Token",
            "type": "string"
          },
          "token_type": {
            "default": "bearer",
            "description": "Token type",
            "title": "Token Type",
            "type": "string"
          },
          "user": {
            "$ref": "#/components/schemas/UserResponse",
            "description": "User information"
          }
        },
        "required": [
          "access_token",
          "refresh_token",
          "user"
        ],
        "title": "TokenRefresh",
        "type": "object"
      },
      "TriggerQuestionGenerationRequest": {
        "description": "Request model for triggering question generation.",
        "properties": {
          "count": {
            "default": 50,
            "nullable": true,
            "title": "Count",
            "type": "integer"
          },
          "dry_run": {
            "default": false,
            "title": "Dry Run",
            "type": "boolean"
          }
        },
        "title": "TriggerQuestionGenerationRequest",
        "type": "object"
      },
      "TriggerQuestionGenerationResponse": {
        "description": "Response model for question generation trigger.",
        "properties": {
          "job_id": {
            "title": "Job Id",
            "type": "string"
          },
          "message": {
            "title": "Message",
            "type": "string"
          },
          "pid": {
            "title": "Pid",
            "type": "integer"
          },
          "status": {
            "title": "Status",
            "type": "string"
          }
        },
        "required": [
          "message",
          "job_id",
          "pid",
          "status"
        ],
        "title": "TriggerQuestionGenerationResponse",
        "type": "object"
      },
      "TypeDiscrimination": {
        "description": "Discrimination statistics for a question type.",
        "properties": {
          "mean_discrimination": {
            "description": "Mean discrimination value for this question type",
            "title": "Mean Discrimination",
            "type": "number"
          },
          "negative_count": {
            "description": "Number of questions with negative discrimination of this type",
            "minimum": 0.0,
            "title": "Negative Count",
            "type": "integer"
          }
        },
        "required": [
          "mean_discrimination",
          "negative_count"
        ],
        "title": "TypeDiscrimination",
        "type": "object"
      },
      "UnseenQuestionsResponse": {
        "description": "Schema for response containing unseen questions.",
        "properties": {
          "questions": {
            "description": "List of unseen questions",
            "items": {
              "$ref": "#/components/schemas/QuestionResponse"
            },
            "title": "Questions",
            "type": "array"
          },
          "requested_count": {
            "description": "Number of questions requested",
            "title": "Requested Count",
            "type": "integer"
          },
          "total_count": {
            "description": "Total number of questions returned",
            "title": "Total Count",
            "type": "integer"
          }
        },
        "required": [
          "questions",
          "total_count",
          "requested_count"
        ],
        "title": "UnseenQuestionsResponse",
        "type": "object"
      },
      "UserLogin": {
        "description": "Schema for user login request.",
        "properties": {
          "email": {
            "description": "User email address",
            "format": "email",
            "title": "Email",
            "type": "string"
          },
          "password": {
            "description": "User password",
            "title": "Password",
            "type": "string"
          }
        },
        "required": [
          "email",
          "password"
        ],
        "title": "UserLogin",
        "type": "object"
      },
      "UserProfileUpdate": {
        "description": "Schema for updating user profile.",
        "properties": {
          "first_name": {
            "description": "User first name",
            "maxLength": 100,
            "minLength": 1,
            "nullable": true,
            "title": "First Name",
            "type": "string"
          },
          "last_name": {
            "description": "User last name",
            "maxLength": 100,
            "minLength": 1,
            "nullable": true,
            "title": "Last Name",
            "type": "string"
          },
          "notification_enabled": {
            "description": "Push notification preference",
            "nullable": true,
            "title": "Notification Enabled",
            "type": "boolean"
          }
        },
        "title": "UserProfileUpdate",
        "type": "object"
      },
      "UserRegister": {
        "description": "Schema for user registration request.",
        "properties": {
          "birth_year": {
            "description": "Year of birth (optional, for norming study)",
            "minimum": 1900.0,
            "nullable": true,
            "title": "Birth Year",
            "type": "integer"
          },
          "country": {
            "description": "Country of residence (optional)",
            "maxLength": 100,
            "minLength": 1,
            "nullable": true,
            "title": "Country",
            "type": "string"
          },
          "education_level": {
            "allOf": [
              {
                "$ref": "#/components/schemas/EducationLevelSchema"
              }
            ],
            "description": "Highest education level attained (optional)",
            "nullable": true
          },
          "email": {
            "description": "User email address",
            "format": "email",
            "title": "Email",
            "type": "string"
          },
          "first_name": {
            "description": "User first name",
            "maxLength": 100,
            "minLength": 1,
            "title": "First Name",
            "type": "string"
          },
          "last_name": {
            "description": "User last name",
            "maxLength": 100,
            "minLength": 1,
            "title": "Last Name",
            "type": "string"
          },
          "password": {
            "description": "User password (8-128 characters)",
            "maxLength": 128,
            "minLength": 8,
            "title": "Password",
            "type": "string"
          },
          "region": {
            "description": "State/Province/Region (optional)",
            "maxLength": 100,
            "minLength": 1,
            "nullable": true,
            "title": "Region",
            "type": "string"
          }
        },
        "required": [
          "email",
          "password",
          "first_name",
          "last_name"
        ],
        "title": "UserRegister",
        "type": "object"
      },
      "UserResponse": {
        "description": "Schema for user response.",
        "properties": {
          "birth_year": {
            "description": "Year of birth",
            "nullable": true,
            "title": "Birth Year",
            "type": "integer"
          },
          "country": {
            "description": "Country of residence",
            "nullable": true,
            "title": "Country",
            "type": "string"
          },
          "created_at": {
            "description": "Account creation timestamp",
            "format": "date-time",
            "title": "Created At",
            "type": "string"
          },
          "education_level": {
            "allOf": [
              {
                "$ref": "#/components/schemas/EducationLevelSchema"
              }
            ],
            "description": "Highest education level attained",
            "nullable": true
          },
          "email": {
            "description": "User email address",
            "title": "Email",
            "type": "string"
          },
          "first_name": {
            "description": "User first name",
            "title": "First Name",
            "type": "string"
          },
          "id": {
            "description": "User ID",
            "title": "Id",
            "type": "integer"
          },
          "last_login_at": {
            "description": "Last login timestamp",
            "format": "date-time",
            "nullable": true,
            "title": "Last Login At",
            "type": "string"
          },
          "last_name": {
            "description": "User last name",
            "title": "Last Name",
            "type": "string"
          },
          "notification_enabled": {
            "description": "Push notification preference",
            "title": "Notification Enabled",
            "type": "boolean"
          },
          "region": {
            "description": "State/Province/Region",
            "nullable": true,
            "title": "Region",
            "type": "string"
          }
        },
        "required": [
          "id",
          "email",
          "first_name",
          "last_name",
          "created_at",
          "notification_enabled"
        ],
        "title": "UserResponse",
        "type": "object"
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "title": "Location",
            "type": "array"
          },
          "msg": {
            "title": "Message",
            "type": "string"
          },
          "type": {
            "title": "Error Type",
            "type": "string"
          }
        },
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError",
        "type": "object"
      },
      "ValidityDetails": {
        "description": "Detailed breakdown of all validity check components.\n\nProvides full analysis results from each validity check for\ncomprehensive review of a session's validity assessment.",
        "properties": {
          "guttman_check": {
            "$ref": "#/components/schemas/GuttmanCheckDetails",
            "description": "Guttman error detection results"
          },
          "person_fit": {
            "$ref": "#/components/schemas/PersonFitDetails",
            "description": "Person-fit heuristic analysis results"
          },
          "time_check": {
            "$ref": "#/components/schemas/TimeCheckDetails",
            "description": "Response time plausibility check results"
          }
        },
        "required": [
          "person_fit",
          "time_check",
          "guttman_check"
        ],
        "title": "ValidityDetails",
        "type": "object"
      },
      "ValidityFlag": {
        "description": "Individual validity flag with type, severity, and details.\n\nRepresents a single detected concern from the validity analysis system.",
        "example": {
          "count": 5,
          "details": "5 responses completed in under 3 seconds each, suggesting random clicking or pre-known answers.",
          "severity": "high",
          "source": "time_check",
          "type": "multiple_rapid_responses"
        },
        "properties": {
          "count": {
            "description": "Number of occurrences (for countable flags like rapid responses)",
            "nullable": true,
            "title": "Count",
            "type": "integer"
          },
          "details": {
            "description": "Human-readable explanation of the flag",
            "title": "Details",
            "type": "string"
          },
          "error_rate": {
            "description": "Error rate (for Guttman flags)",
            "maximum": 1.0,
            "minimum": 0.0,
            "nullable": true,
            "title": "Error Rate",
            "type": "number"
          },
          "severity": {
            "$ref": "#/components/schemas/app__schemas__validity__SeverityLevel",
            "description": "Severity level of this flag"
          },
          "source": {
            "$ref": "#/components/schemas/FlagSource",
            "description": "Which validity check generated this flag"
          },
          "type": {
            "description": "Flag type identifier (e.g., 'multiple_rapid_responses', 'aberrant_response_pattern')",
            "title": "Type",
            "type": "string"
          }
        },
        "required": [
          "type",
          "severity",
          "source",
          "details"
        ],
        "title": "ValidityFlag",
        "type": "object"
      },
      "ValidityOverrideRequest": {
        "description": "Request schema for admin to override validity status.\n\nUsed with PATCH /v1/admin/sessions/{id}/validity endpoint.",
        "example": {
          "override_reason": "Manual review confirmed legitimate pattern. User has consistent test history and rapid responses were on very easy questions.",
          "validity_status": "valid"
        },
        "properties": {
          "override_reason": {
            "description": "Required explanation for the override (min 10 characters)",
            "maxLength": 1000,
            "minLength": 10,
            "title": "Override Reason",
            "type": "string"
          },
          "validity_status": {
            "$ref": "#/components/schemas/ValidityStatus",
            "description": "New validity status to set"
          }
        },
        "required": [
          "validity_status",
          "override_reason"
        ],
        "title": "ValidityOverrideRequest",
        "type": "object"
      },
      "ValidityOverrideResponse": {
        "description": "Response schema after admin overrides validity status.\n\nConfirms the override was applied and returns updated session validity.",
        "example": {
          "new_status": "valid",
          "overridden_at": "2025-12-12T10:30:00Z",
          "overridden_by": 1,
          "override_reason": "Manual review confirmed legitimate pattern.",
          "previous_status": "suspect",
          "session_id": 123
        },
        "properties": {
          "new_status": {
            "$ref": "#/components/schemas/ValidityStatus",
            "description": "New validity status after override"
          },
          "overridden_at": {
            "description": "Timestamp of the override",
            "format": "date-time",
            "title": "Overridden At",
            "type": "string"
          },
          "overridden_by": {
            "description": "Admin user ID who performed the override",
            "title": "Overridden By",
            "type": "integer"
          },
          "override_reason": {
            "description": "Reason provided for the override",
            "title": "Override Reason",
            "type": "string"
          },
          "previous_status": {
            "$ref": "#/components/schemas/ValidityStatus",
            "description": "Validity status before override"
          },
          "session_id": {
            "description": "Test session ID",
            "title": "Session Id",
            "type": "integer"
          }
        },
        "required": [
          "session_id",
          "previous_status",
          "new_status",
          "override_reason",
          "overridden_by",
          "overridden_at"
        ],
        "title": "ValidityOverrideResponse",
        "type": "object"
      },
      "ValidityStatus": {
        "description": "Overall validity status for a test session.",
        "enum": [
          "valid",
          "suspect",
          "invalid"
        ],
        "title": "ValidityStatus",
        "type": "string"
      },
      "ValidityStatusCounts": {
        "description": "Count of sessions by validity status.",
        "properties": {
          "invalid": {
            "description": "Number of sessions marked as invalid",
            "minimum": 0.0,
            "title": "Invalid",
            "type": "integer"
          },
          "suspect": {
            "description": "Number of sessions marked as suspect",
            "minimum": 0.0,
            "title": "Suspect",
            "type": "integer"
          },
          "total_sessions_analyzed": {
            "description": "Total number of sessions with validity analysis",
            "minimum": 0.0,
            "title": "Total Sessions Analyzed",
            "type": "integer"
          },
          "valid": {
            "description": "Number of sessions marked as valid",
            "minimum": 0.0,
            "title": "Valid",
            "type": "integer"
          }
        },
        "required": [
          "total_sessions_analyzed",
          "valid",
          "suspect",
          "invalid"
        ],
        "title": "ValidityStatusCounts",
        "type": "object"
      },
      "ValiditySummaryResponse": {
        "description": "Aggregate validity statistics across all sessions.\n\nResponse schema for GET /v1/admin/validity-report endpoint.",
        "example": {
          "action_needed": [
            {
              "completed_at": "2025-12-10T10:30:00Z",
              "flags": [
                "multiple_rapid_responses",
                "total_time_too_fast",
                "high_guttman_errors"
              ],
              "session_id": 123,
              "severity_score": 6,
              "user_id": 456,
              "validity_status": "invalid"
            },
            {
              "completed_at": "2025-12-10T14:15:00Z",
              "flags": [
                "aberrant_response_pattern",
                "elevated_guttman_errors"
              ],
              "session_id": 124,
              "severity_score": 3,
              "user_id": 789,
              "validity_status": "suspect"
            }
          ],
          "by_flag_type": {
            "aberrant_response_pattern": 15,
            "elevated_guttman_errors": 35,
            "extended_pauses": 45,
            "high_guttman_errors": 12,
            "multiple_rapid_responses": 25,
            "suspiciously_fast_on_hard": 18,
            "total_time_excessive": 12,
            "total_time_too_fast": 8
          },
          "generated_at": "2025-12-12T00:00:00Z",
          "period_days": 30,
          "summary": {
            "invalid": 20,
            "suspect": 60,
            "total_sessions_analyzed": 1000,
            "valid": 920
          },
          "trends": {
            "invalid_rate_30d": 0.022,
            "invalid_rate_7d": 0.018,
            "suspect_rate_30d": 0.06,
            "suspect_rate_7d": 0.055,
            "trend": "stable"
          }
        },
        "properties": {
          "action_needed": {
            "description": "Sessions flagged as invalid or suspect needing review",
            "items": {
              "$ref": "#/components/schemas/SessionNeedingReview"
            },
            "title": "Action Needed",
            "type": "array"
          },
          "by_flag_type": {
            "$ref": "#/components/schemas/FlagTypeBreakdown",
            "description": "Breakdown of flags by type"
          },
          "generated_at": {
            "description": "When this report was generated",
            "format": "date-time",
            "title": "Generated At",
            "type": "string"
          },
          "period_days": {
            "description": "Number of days analyzed in this report",
            "minimum": 1.0,
            "title": "Period Days",
            "type": "integer"
          },
          "summary": {
            "$ref": "#/components/schemas/ValidityStatusCounts",
            "description": "Count of sessions by validity status"
          },
          "trends": {
            "$ref": "#/components/schemas/ValidityTrend",
            "description": "Validity trend comparison (7-day vs 30-day)"
          }
        },
        "required": [
          "summary",
          "by_flag_type",
          "trends",
          "action_needed",
          "period_days",
          "generated_at"
        ],
        "title": "ValiditySummaryResponse",
        "type": "object"
      },
      "ValidityTrend": {
        "description": "Validity trend comparison between time periods.",
        "properties": {
          "invalid_rate_30d": {
            "description": "Proportion of invalid sessions in last 30 days",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Invalid Rate 30D",
            "type": "number"
          },
          "invalid_rate_7d": {
            "description": "Proportion of invalid sessions in last 7 days",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Invalid Rate 7D",
            "type": "number"
          },
          "suspect_rate_30d": {
            "description": "Proportion of suspect sessions in last 30 days",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Suspect Rate 30D",
            "type": "number"
          },
          "suspect_rate_7d": {
            "description": "Proportion of suspect sessions in last 7 days",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Suspect Rate 7D",
            "type": "number"
          },
          "trend": {
            "description": "Overall trend: 'improving', 'stable', or 'worsening'",
            "title": "Trend",
            "type": "string"
          }
        },
        "required": [
          "invalid_rate_7d",
          "invalid_rate_30d",
          "suspect_rate_7d",
          "suspect_rate_30d",
          "trend"
        ],
        "title": "ValidityTrend",
        "type": "object"
      },
      "WeightedScoringStatus": {
        "description": "Response model for weighted scoring status.",
        "properties": {
          "domain_weights": {
            "additionalProperties": {
              "type": "number"
            },
            "description": "Current domain weights if configured",
            "nullable": true,
            "title": "Domain Weights",
            "type": "object"
          },
          "enabled": {
            "description": "Whether weighted scoring is currently enabled",
            "title": "Enabled",
            "type": "boolean"
          },
          "updated_at": {
            "description": "When the setting was last updated",
            "format": "date-time",
            "nullable": true,
            "title": "Updated At",
            "type": "string"
          }
        },
        "required": [
          "enabled"
        ],
        "title": "WeightedScoringStatus",
        "type": "object"
      },
      "WeightedScoringToggleRequest": {
        "description": "Request model for toggling weighted scoring.",
        "properties": {
          "enabled": {
            "description": "Whether to enable or disable weighted scoring",
            "title": "Enabled",
            "type": "boolean"
          }
        },
        "required": [
          "enabled"
        ],
        "title": "WeightedScoringToggleRequest",
        "type": "object"
      },
      "WeightedScoringToggleResponse": {
        "description": "Response model for weighted scoring toggle operation.",
        "properties": {
          "enabled": {
            "description": "The new weighted scoring status after the operation",
            "title": "Enabled",
            "type": "boolean"
          },
          "message": {
            "description": "Human-readable message describing the operation result",
            "title": "Message",
            "type": "string"
          },
          "updated_at": {
            "description": "When the setting was updated",
            "format": "date-time",
            "title": "Updated At",
            "type": "string"
          }
        },
        "required": [
          "enabled",
          "message",
          "updated_at"
        ],
        "title": "WeightedScoringToggleResponse",
        "type": "object"
      },
      "WorstOffenderQuestion": {
        "description": "A question with the most distractor issues.",
        "properties": {
          "difficulty_level": {
            "description": "Assigned difficulty level (easy, medium, hard)",
            "title": "Difficulty Level",
            "type": "string"
          },
          "effective_option_count": {
            "description": "Effective number of options (inverse Simpson index)",
            "minimum": 0.0,
            "title": "Effective Option Count",
            "type": "number"
          },
          "inverted_count": {
            "description": "Number of inverted distractors",
            "minimum": 0.0,
            "title": "Inverted Count",
            "type": "integer"
          },
          "non_functioning_count": {
            "description": "Number of non-functioning distractors",
            "minimum": 0.0,
            "title": "Non Functioning Count",
            "type": "integer"
          },
          "question_id": {
            "description": "Unique identifier of the question",
            "title": "Question Id",
            "type": "integer"
          },
          "question_type": {
            "description": "Type of the question (pattern, logic, spatial, etc.)",
            "title": "Question Type",
            "type": "string"
          },
          "total_responses": {
            "description": "Total number of responses for this question",
            "minimum": 0.0,
            "title": "Total Responses",
            "type": "integer"
          }
        },
        "required": [
          "question_id",
          "question_type",
          "difficulty_level",
          "non_functioning_count",
          "inverted_count",
          "total_responses",
          "effective_option_count"
        ],
        "title": "WorstOffenderQuestion",
        "type": "object"
      },
      "app__schemas__calibration__SeverityLevel": {
        "description": "Severity level for miscalibration.",
        "enum": [
          "minor",
          "major",
          "severe"
        ],
        "title": "SeverityLevel",
        "type": "string"
      },
      "app__schemas__validity__SeverityLevel": {
        "description": "Severity level for validity flags.",
        "enum": [
          "high",
          "medium",
          "low"
        ],
        "title": "SeverityLevel",
        "type": "string"
      }
    },
    "securitySchemes": {
      "HTTPBearer": {
        "scheme": "bearer",
        "type": "http"
      }
    }
  },
  "info": {
    "contact": {
      "email": "support@aiq.app",
      "name": "AIQ Support"
    },
    "description": "**AIQ API** - A backend service for AI-generated cognitive assessments.\n\nThis API provides:\n* User authentication and profile management\n* Periodic cognitive testing with AI-generated questions\n* Test session management and response submission\n* Historical test results and trend analysis\n\n## Authentication\n\nMost endpoints require authentication using JWT Bearer tokens. Obtain tokens via the `/v1/auth/login` endpoint.\n\n## Testing Cadence\n\nUsers are recommended to take tests every 3 months for optimal cognitive tracking.",
    "license": {
      "name": "MIT"
    },
    "title": "AIQ API",
    "version": "0.1.0"
  },
  "openapi": "3.1.0",
  "paths": {
    "/": {
      "get": {
        "description": "Root endpoint.",
        "operationId": "root__get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "Root"
      }
    },
    "/v1/admin/analytics/factor-analysis": {
      "get": {
        "description": "Perform factor analysis to calculate empirical g-loadings per domain.\n\nThis endpoint runs a factor analysis on all completed test sessions to\ndetermine how strongly each cognitive domain correlates with general\nintelligence (g). Results can be used to inform weighted scoring.\n\n**Requirements:**\n- Minimum 500 completed test sessions\n- Questions must have at least min_responses_per_question responses\n\n**Returns:**\n- g_loadings: Correlation of each domain with the g-factor (0-1)\n- variance_explained: How much variance the g-factor explains\n- reliability: Cronbach's alpha for internal consistency\n- recommendations: Actionable insights based on the results\n\n**Interpretation:**\n- Higher g-loadings indicate stronger correlation with general intelligence\n- Variance explained > 40% suggests a strong general factor\n- Cronbach's alpha >= 0.7 indicates acceptable reliability\n\nRequires X-Admin-Token header with valid admin token.",
        "operationId": "get_factor_analysis_v1_admin_analytics_factor_analysis_get",
        "parameters": [
          {
            "description": "Minimum responses per question for inclusion",
            "in": "query",
            "name": "min_responses_per_question",
            "required": false,
            "schema": {
              "default": 30,
              "description": "Minimum responses per question for inclusion",
              "maximum": 200,
              "minimum": 10,
              "title": "Min Responses Per Question",
              "type": "integer"
            }
          },
          {
            "description": "Maximum responses to fetch. Set to 0 for no limit (use with caution).",
            "in": "query",
            "name": "max_responses",
            "required": false,
            "schema": {
              "default": 10000,
              "description": "Maximum responses to fetch. Set to 0 for no limit (use with caution).",
              "maximum": 1000000,
              "minimum": 0,
              "title": "Max Responses",
              "type": "integer"
            }
          },
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FactorAnalysisResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "400": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InsufficientSampleResponse"
                }
              }
            },
            "description": "Bad Request"
          },
          "401": {
            "description": "Invalid admin token"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Factor Analysis",
        "tags": [
          "admin",
          "Admin - Analytics"
        ]
      }
    },
    "/v1/admin/analytics/response-times": {
      "get": {
        "description": "Get aggregate response time analytics across all completed test sessions.\n\nReturns comprehensive timing statistics including overall test duration,\nbreakdown by difficulty level and question type, and a summary of\ntiming anomalies (rapid responses, extended times, validity concerns).\n\nRequires X-Admin-Token header with valid admin token.\n\n**Overall Statistics:**\n- Mean and median total test duration in seconds\n- Mean time per question across all responses\n\n**By Difficulty:**\n- Mean and median response time for easy, medium, and hard questions\n\n**By Question Type:**\n- Mean response time for each question type (pattern, logic, spatial, math, verbal, memory)\n\n**Anomaly Summary:**\n- Count of sessions with rapid responses (< 3 seconds per question)\n- Count of sessions with extended response times (> 5 minutes per question)\n- Percentage of sessions flagged with validity concerns\n\nArgs:\n    db: Database session\n    _: Admin token validation dependency\n\nReturns:\n    ResponseTimeAnalyticsResponse with aggregate timing statistics\n\nExample:\n    ```\n    curl \"https://api.example.com/v1/admin/analytics/response-times\" \\\n      -H \"X-Admin-Token: your-admin-token\"\n    ```",
        "operationId": "get_response_time_analytics_v1_admin_analytics_response_times_get",
        "parameters": [
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ResponseTimeAnalyticsResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Response Time Analytics",
        "tags": [
          "admin",
          "Admin - Analytics"
        ]
      }
    },
    "/v1/admin/background-jobs": {
      "get": {
        "description": "List all registered background jobs.\n\nReturns a list of all jobs registered in the process registry,\noptionally filtered by job type and/or status.\n\nRequires X-Admin-Token header with valid admin token.\n\nArgs:\n    job_type: Optional filter by job type\n    status: Optional filter by status\n    include_finished: Whether to include finished jobs\n    _: Admin token validation dependency\n\nReturns:\n    BackgroundJobListResponse with list of jobs and counts\n\nExample:\n    ```\n    # List all running jobs\n    curl \"https://api.example.com/v1/admin/background-jobs?status=running\"           -H \"X-Admin-Token: your-admin-token\"\n\n    # List only question generation jobs\n    curl \"https://api.example.com/v1/admin/background-jobs?job_type=question_generation\"           -H \"X-Admin-Token: your-admin-token\"\n    ```",
        "operationId": "list_background_jobs_v1_admin_background_jobs_get",
        "parameters": [
          {
            "description": "Filter by job type (e.g., 'question_generation')",
            "in": "query",
            "name": "job_type",
            "required": false,
            "schema": {
              "description": "Filter by job type (e.g., 'question_generation')",
              "nullable": true,
              "title": "Job Type",
              "type": "string"
            }
          },
          {
            "description": "Filter by status (running, completed, failed, terminated)",
            "in": "query",
            "name": "status",
            "required": false,
            "schema": {
              "description": "Filter by status (running, completed, failed, terminated)",
              "nullable": true,
              "title": "Status",
              "type": "string"
            }
          },
          {
            "description": "Include finished jobs in results",
            "in": "query",
            "name": "include_finished",
            "required": false,
            "schema": {
              "default": true,
              "description": "Include finished jobs in results",
              "title": "Include Finished",
              "type": "boolean"
            }
          },
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BackgroundJobListResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "List Background Jobs",
        "tags": [
          "admin",
          "Admin - Generation"
        ]
      }
    },
    "/v1/admin/background-jobs/cleanup": {
      "post": {
        "description": "Remove finished jobs from the registry.\n\nThis endpoint triggers cleanup of all completed, failed, and terminated\njobs from the registry. This is useful for freeing memory and keeping\nthe job list manageable.\n\nNote: Cleanup also happens automatically when the server shuts down.\n\nRequires X-Admin-Token header with valid admin token.\n\nReturns:\n    Number of jobs cleaned up\n\nExample:\n    ```\n    curl -X POST \"https://api.example.com/v1/admin/background-jobs/cleanup\"           -H \"X-Admin-Token: your-admin-token\"\n    ```",
        "operationId": "cleanup_finished_jobs_v1_admin_background_jobs_cleanup_post",
        "parameters": [
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Cleanup Finished Jobs",
        "tags": [
          "admin",
          "Admin - Generation"
        ]
      }
    },
    "/v1/admin/background-jobs/stats": {
      "get": {
        "description": "Get statistics about registered background jobs.\n\nReturns counts of jobs by status (running, completed, failed, terminated).\n\nRequires X-Admin-Token header with valid admin token.\n\nReturns:\n    BackgroundJobStatsResponse with job counts\n\nExample:\n    ```\n    curl \"https://api.example.com/v1/admin/background-jobs/stats\"           -H \"X-Admin-Token: your-admin-token\"\n    ```",
        "operationId": "get_background_job_stats_v1_admin_background_jobs_stats_get",
        "parameters": [
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BackgroundJobStatsResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Background Job Stats",
        "tags": [
          "admin",
          "Admin - Generation"
        ]
      }
    },
    "/v1/admin/background-jobs/{job_id}": {
      "delete": {
        "description": "Terminate a running background job.\n\nSends SIGTERM (or SIGKILL if force=True) to the process.\nThis is useful for stopping runaway or stuck jobs.\n\nRequires X-Admin-Token header with valid admin token.\n\nArgs:\n    job_id: The unique job ID from the registry\n    force: If True, use SIGKILL instead of SIGTERM\n    _: Admin token validation dependency\n\nReturns:\n    Termination status\n\nRaises:\n    HTTPException 404: If the job is not found\n    HTTPException 400: If the job is not running\n\nExample:\n    ```\n    # Graceful termination\n    curl -X DELETE \"https://api.example.com/v1/admin/background-jobs/question_generation_20241221120000_1_12345\"           -H \"X-Admin-Token: your-admin-token\"\n\n    # Force kill\n    curl -X DELETE \"https://api.example.com/v1/admin/background-jobs/question_generation_20241221120000_1_12345?force=true\"           -H \"X-Admin-Token: your-admin-token\"\n    ```",
        "operationId": "terminate_background_job_v1_admin_background_jobs__job_id__delete",
        "parameters": [
          {
            "in": "path",
            "name": "job_id",
            "required": true,
            "schema": {
              "title": "Job Id",
              "type": "string"
            }
          },
          {
            "description": "Use SIGKILL instead of SIGTERM",
            "in": "query",
            "name": "force",
            "required": false,
            "schema": {
              "default": false,
              "description": "Use SIGKILL instead of SIGTERM",
              "title": "Force",
              "type": "boolean"
            }
          },
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Terminate Background Job",
        "tags": [
          "admin",
          "Admin - Generation"
        ]
      },
      "get": {
        "description": "Get detailed information about a specific background job.\n\nRequires X-Admin-Token header with valid admin token.\n\nArgs:\n    job_id: The unique job ID from the registry\n    _: Admin token validation dependency\n\nReturns:\n    BackgroundJobResponse with job details\n\nRaises:\n    HTTPException 404: If the job is not found\n\nExample:\n    ```\n    curl \"https://api.example.com/v1/admin/background-jobs/question_generation_20241221120000_1_12345\"           -H \"X-Admin-Token: your-admin-token\"\n    ```",
        "operationId": "get_background_job_v1_admin_background_jobs__job_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "job_id",
            "required": true,
            "schema": {
              "title": "Job Id",
              "type": "string"
            }
          },
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BackgroundJobResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Background Job",
        "tags": [
          "admin",
          "Admin - Generation"
        ]
      }
    },
    "/v1/admin/config/domain-weights": {
      "get": {
        "description": "Get the current domain weights configuration.\n\nReturns the configured domain weights used for weighted scoring calculations.\n\nRequires X-Admin-Token header with valid admin token.\n\nReturns:\n    DomainWeightsResponse with weights, or None if not configured\n\nExample:\n    ```\n    curl \"https://api.example.com/v1/admin/config/domain-weights\" \\\n      -H \"X-Admin-Token: your-admin-token\"\n    ```",
        "operationId": "get_domain_weights_config_v1_admin_config_domain_weights_get",
        "parameters": [
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/DomainWeightsResponse"
                    }
                  ],
                  "nullable": true,
                  "title": "Response Get Domain Weights Config V1 Admin Config Domain Weights Get"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Domain Weights Config",
        "tags": [
          "admin",
          "Admin - Config"
        ]
      },
      "post": {
        "description": "Set the domain weights for weighted scoring.\n\nDomain weights determine how much each cognitive domain contributes to the\nfinal IQ score. Weights should reflect each domain's g-loading (correlation\nwith general intelligence).\n\nThe weights should ideally sum to 1.0, but will be normalized during\nscoring calculations if they don't.\n\nRequires X-Admin-Token header with valid admin token.\n\nArgs:\n    request: DomainWeightsRequest with weights dictionary\n\nReturns:\n    DomainWeightsResponse with confirmation\n\nExample:\n    ```\n    curl -X POST \"https://api.example.com/v1/admin/config/domain-weights\" \\\n      -H \"X-Admin-Token: your-admin-token\" \\\n      -H \"Content-Type: application/json\" \\\n      -d '{\"weights\": {\"pattern\": 0.20, \"logic\": 0.18, \"spatial\": 0.16, \"math\": 0.17, \"verbal\": 0.15, \"memory\": 0.14}}'\n    ```",
        "operationId": "set_domain_weights_config_v1_admin_config_domain_weights_post",
        "parameters": [
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DomainWeightsRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DomainWeightsResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Set Domain Weights Config",
        "tags": [
          "admin",
          "Admin - Config"
        ]
      }
    },
    "/v1/admin/config/weighted-scoring": {
      "get": {
        "description": "Get the current weighted scoring configuration status.\n\nReturns whether weighted scoring is enabled and the current domain weights\nif configured.\n\nRequires X-Admin-Token header with valid admin token.\n\nReturns:\n    WeightedScoringStatus with enabled flag and domain weights\n\nExample:\n    ```\n    curl \"https://api.example.com/v1/admin/config/weighted-scoring\" \\\n      -H \"X-Admin-Token: your-admin-token\"\n    ```",
        "operationId": "get_weighted_scoring_status_v1_admin_config_weighted_scoring_get",
        "parameters": [
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WeightedScoringStatus"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Weighted Scoring Status",
        "tags": [
          "admin",
          "Admin - Config"
        ]
      },
      "post": {
        "description": "Enable or disable weighted scoring.\n\nWhen enabled, IQ scores are calculated using domain weights that reflect\neach domain's correlation with general intelligence (g-loading). When\ndisabled, all domains are weighted equally.\n\nRequires X-Admin-Token header with valid admin token.\n\nArgs:\n    request: WeightedScoringToggleRequest with enabled flag\n\nReturns:\n    WeightedScoringToggleResponse with new status and confirmation message\n\nExample:\n    ```\n    curl -X POST \"https://api.example.com/v1/admin/config/weighted-scoring\" \\\n      -H \"X-Admin-Token: your-admin-token\" \\\n      -H \"Content-Type: application/json\" \\\n      -d '{\"enabled\": true}'\n    ```",
        "operationId": "toggle_weighted_scoring_v1_admin_config_weighted_scoring_post",
        "parameters": [
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/WeightedScoringToggleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WeightedScoringToggleResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Toggle Weighted Scoring",
        "tags": [
          "admin",
          "Admin - Config"
        ]
      }
    },
    "/v1/admin/day-30-reminders/preview": {
      "get": {
        "description": "Preview users who are eligible for Day 30 reminder notifications.\n\nThis endpoint returns a list of users who would receive Day 30 reminders\nif the send endpoint were called. Useful for verifying the query logic\nand previewing the notification recipients before sending.\n\nRequires X-Admin-Token header with valid admin token.\n\nArgs:\n    limit: Maximum number of users to return (1-100, default: 50)\n    db: Database session\n    _: Admin token validation dependency\n\nReturns:\n    Day30ReminderPreviewResponse with list of eligible users\n\nExample:\n    ```\n    curl \"https://api.example.com/v1/admin/day-30-reminders/preview?limit=10\" \\\n      -H \"X-Admin-Token: your-admin-token\"\n    ```",
        "operationId": "preview_day_30_reminders_v1_admin_day_30_reminders_preview_get",
        "parameters": [
          {
            "description": "Maximum users to return",
            "in": "query",
            "name": "limit",
            "required": false,
            "schema": {
              "default": 50,
              "description": "Maximum users to return",
              "maximum": 100,
              "minimum": 1,
              "title": "Limit",
              "type": "integer"
            }
          },
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Day30ReminderPreviewResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Preview Day 30 Reminders",
        "tags": [
          "admin",
          "Admin - Notifications"
        ]
      }
    },
    "/v1/admin/day-30-reminders/send": {
      "post": {
        "description": "Send Day 30 reminder notifications to eligible users.\n\nThis endpoint identifies users who completed their first test approximately\n30 days ago and sends them a reminder notification. This is part of Phase 2.2\n(Provisional Notifications) to re-engage users early in their journey.\n\nThe notification is designed for provisional authorization:\n- No sound (silent delivery)\n- No badge increment\n- Appears only in Notification Center\n\nUsers with full notification authorization will also receive this notification,\nbut with the same silent characteristics for consistency.\n\nRequires X-Admin-Token header with valid admin token.\n\nReturns:\n    Day30ReminderResponse with counts of users found and notifications sent\n\nExample:\n    ```\n    curl -X POST https://api.example.com/v1/admin/day-30-reminders/send \\\n      -H \"X-Admin-Token: your-admin-token\"\n    ```",
        "operationId": "send_day_30_reminders_v1_admin_day_30_reminders_send_post",
        "parameters": [
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Day30ReminderResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Send Day 30 Reminders",
        "tags": [
          "admin",
          "Admin - Notifications"
        ]
      }
    },
    "/v1/admin/generation-runs": {
      "get": {
        "description": "List question generation runs with pagination, filtering, and sorting.\n\nReturns a paginated list of generation run summaries (without full JSONB breakdowns)\nto optimize query performance. Use GET /v1/admin/generation-runs/{id} to retrieve\nfull details for a specific run.\n\nRequires X-Service-Key header with valid service API key.\n\n**Filters:**\n- `status`: Filter by run status (running, success, partial_failure, failed)\n- `environment`: Filter by environment (production, staging, development)\n- `start_date`/`end_date`: Filter by date range (ISO 8601 format)\n- `min_success_rate`/`max_success_rate`: Filter by success rate range (0.0-1.0)\n\n**Sorting:**\n- `sort_by`: Field to sort by (started_at, duration_seconds, overall_success_rate)\n- `sort_order`: Sort direction (asc, desc)\n\n**Pagination:**\n- `page`: Page number (1-indexed, default: 1)\n- `page_size`: Items per page (1-100, default: 20)\n\nExample:\n    ```\n    curl \"https://api.example.com/v1/admin/generation-runs?status=success&page=1&page_size=10\" \\\n      -H \"X-Service-Key: your-service-key\"\n    ```",
        "operationId": "list_generation_runs_v1_admin_generation_runs_get",
        "parameters": [
          {
            "description": "Page number (1-indexed)",
            "in": "query",
            "name": "page",
            "required": false,
            "schema": {
              "default": 1,
              "description": "Page number (1-indexed)",
              "minimum": 1,
              "title": "Page",
              "type": "integer"
            }
          },
          {
            "description": "Items per page (1-100)",
            "in": "query",
            "name": "page_size",
            "required": false,
            "schema": {
              "default": 20,
              "description": "Items per page (1-100)",
              "maximum": 100,
              "minimum": 1,
              "title": "Page Size",
              "type": "integer"
            }
          },
          {
            "description": "Filter by run status",
            "in": "query",
            "name": "status",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/GenerationRunStatusSchema"
                }
              ],
              "description": "Filter by run status",
              "nullable": true,
              "title": "Status"
            }
          },
          {
            "description": "Filter by environment",
            "in": "query",
            "name": "environment",
            "required": false,
            "schema": {
              "description": "Filter by environment",
              "maxLength": 20,
              "nullable": true,
              "title": "Environment",
              "type": "string"
            }
          },
          {
            "description": "Filter runs started on or after this date (ISO format)",
            "in": "query",
            "name": "start_date",
            "required": false,
            "schema": {
              "description": "Filter runs started on or after this date (ISO format)",
              "format": "date-time",
              "nullable": true,
              "title": "Start Date",
              "type": "string"
            }
          },
          {
            "description": "Filter runs started on or before this date (ISO format)",
            "in": "query",
            "name": "end_date",
            "required": false,
            "schema": {
              "description": "Filter runs started on or before this date (ISO format)",
              "format": "date-time",
              "nullable": true,
              "title": "End Date",
              "type": "string"
            }
          },
          {
            "description": "Filter by minimum overall success rate",
            "in": "query",
            "name": "min_success_rate",
            "required": false,
            "schema": {
              "description": "Filter by minimum overall success rate",
              "maximum": 1.0,
              "minimum": 0.0,
              "nullable": true,
              "title": "Min Success Rate",
              "type": "number"
            }
          },
          {
            "description": "Filter by maximum overall success rate",
            "in": "query",
            "name": "max_success_rate",
            "required": false,
            "schema": {
              "description": "Filter by maximum overall success rate",
              "maximum": 1.0,
              "minimum": 0.0,
              "nullable": true,
              "title": "Max Success Rate",
              "type": "number"
            }
          },
          {
            "description": "Field to sort by",
            "in": "query",
            "name": "sort_by",
            "required": false,
            "schema": {
              "default": "started_at",
              "description": "Field to sort by",
              "enum": [
                "started_at",
                "duration_seconds",
                "overall_success_rate"
              ],
              "title": "Sort By",
              "type": "string"
            }
          },
          {
            "description": "Sort order (asc or desc)",
            "in": "query",
            "name": "sort_order",
            "required": false,
            "schema": {
              "default": "desc",
              "description": "Sort order (asc or desc)",
              "enum": [
                "asc",
                "desc"
              ],
              "title": "Sort Order",
              "type": "string"
            }
          },
          {
            "in": "header",
            "name": "x-service-key",
            "required": true,
            "schema": {
              "title": "X-Service-Key",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/QuestionGenerationRunListResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "List Generation Runs",
        "tags": [
          "admin",
          "Admin - Generation"
        ]
      },
      "post": {
        "description": "Create a new question generation run record.\n\nThis endpoint accepts metrics from the question-service after a generation\nrun completes. It supports both initial \"running\" status reports and final\ncompletion reports with full metrics.\n\nRequires X-Service-Key header with valid service API key.\n\nArgs:\n    run_data: Question generation run metrics\n    db: Database session\n    _: Service key validation dependency\n\nReturns:\n    QuestionGenerationRunCreateResponse with created run ID\n\nExample:\n    ```\n    curl -X POST https://api.example.com/v1/admin/generation-runs \\\n      -H \"X-Service-Key: your-service-key\" \\\n      -H \"Content-Type: application/json\" \\\n      -d '{\n        \"started_at\": \"2024-12-05T10:00:00Z\",\n        \"completed_at\": \"2024-12-05T10:05:00Z\",\n        \"duration_seconds\": 300.5,\n        \"status\": \"success\",\n        \"exit_code\": 0,\n        \"questions_requested\": 50,\n        \"questions_generated\": 48,\n        \"questions_inserted\": 45,\n        \"overall_success_rate\": 0.9,\n        \"environment\": \"production\",\n        \"triggered_by\": \"scheduler\"\n      }'\n    ```",
        "operationId": "create_generation_run_v1_admin_generation_runs_post",
        "parameters": [
          {
            "in": "header",
            "name": "x-service-key",
            "required": true,
            "schema": {
              "title": "X-Service-Key",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/QuestionGenerationRunCreate"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/QuestionGenerationRunCreateResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Create Generation Run",
        "tags": [
          "admin",
          "Admin - Generation"
        ]
      }
    },
    "/v1/admin/generation-runs/stats": {
      "get": {
        "description": "Get aggregated statistics for generation runs over a time period.\n\nReturns aggregate metrics including success rates, approval rates, arbiter scores,\nprovider comparisons, and trend indicators. Useful for dashboards, trend analysis,\nand quality monitoring.\n\nRequires X-Service-Key header with valid service API key.\n\n**Query Parameters:**\n- `start_date`: Start of the analysis period (ISO 8601 format, required)\n- `end_date`: End of the analysis period (ISO 8601 format, required)\n- `environment`: Optional filter by environment (production, staging, development)\n\n**Trend Indicators:**\nThe response includes trend indicators comparing the first half vs second half\nof the analysis period. Possible values: \"improving\", \"declining\", \"stable\".\nA difference of less than 5% is considered \"stable\".\n\n**Provider Summary:**\nAggregated metrics per provider extracted from JSONB provider_metrics fields.\nIncludes total questions generated, total API calls, and success rates per provider.\n\nArgs:\n    start_date: Start of the analysis period\n    end_date: End of the analysis period\n    environment: Optional environment filter\n    db: Database session\n    _: Service key validation dependency\n\nReturns:\n    QuestionGenerationRunStats with aggregated metrics and trends\n\nExample:\n    ```\n    curl \"https://api.example.com/v1/admin/generation-runs/stats?start_date=2024-11-01T00:00:00Z&end_date=2024-12-01T00:00:00Z\" \\\n      -H \"X-Service-Key: your-service-key\"\n    ```",
        "operationId": "get_generation_runs_stats_v1_admin_generation_runs_stats_get",
        "parameters": [
          {
            "description": "Start of the analysis period (ISO format, required)",
            "in": "query",
            "name": "start_date",
            "required": true,
            "schema": {
              "description": "Start of the analysis period (ISO format, required)",
              "format": "date-time",
              "title": "Start Date",
              "type": "string"
            }
          },
          {
            "description": "End of the analysis period (ISO format, required)",
            "in": "query",
            "name": "end_date",
            "required": true,
            "schema": {
              "description": "End of the analysis period (ISO format, required)",
              "format": "date-time",
              "title": "End Date",
              "type": "string"
            }
          },
          {
            "description": "Filter by environment",
            "in": "query",
            "name": "environment",
            "required": false,
            "schema": {
              "description": "Filter by environment",
              "maxLength": 20,
              "nullable": true,
              "title": "Environment",
              "type": "string"
            }
          },
          {
            "in": "header",
            "name": "x-service-key",
            "required": true,
            "schema": {
              "title": "X-Service-Key",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/QuestionGenerationRunStats"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Generation Runs Stats",
        "tags": [
          "admin",
          "Admin - Generation"
        ]
      }
    },
    "/v1/admin/generation-runs/{run_id}": {
      "get": {
        "description": "Get detailed information for a specific generation run.\n\nReturns full run details including all JSONB breakdown fields and computed\npipeline loss metrics showing where questions were lost at each stage.\n\nRequires X-Service-Key header with valid service API key.\n\n**Pipeline Loss Metrics:**\nThe response includes a `pipeline_losses` object that tracks questions lost at:\n- `generation_loss`: Failed during LLM generation (requested - generated)\n- `evaluation_loss`: Not evaluated by arbiter (generated - evaluated)\n- `rejection_loss`: Rejected by arbiter (evaluated - approved)\n- `deduplication_loss`: Removed as duplicates\n- `insertion_loss`: Failed during database insertion\n- `total_loss`: Total lost across all stages (requested - inserted)\n\nEach loss includes both absolute count and percentage values.\n\nArgs:\n    run_id: The unique identifier of the generation run\n    db: Database session\n    _: Service key validation dependency\n\nReturns:\n    QuestionGenerationRunDetail with full run details and computed losses\n\nRaises:\n    HTTPException 404: If the run with the specified ID is not found\n\nExample:\n    ```\n    curl \"https://api.example.com/v1/admin/generation-runs/123\" \\\n      -H \"X-Service-Key: your-service-key\"\n    ```",
        "operationId": "get_generation_run_v1_admin_generation_runs__run_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "run_id",
            "required": true,
            "schema": {
              "title": "Run Id",
              "type": "integer"
            }
          },
          {
            "in": "header",
            "name": "x-service-key",
            "required": true,
            "schema": {
              "title": "X-Service-Key",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/QuestionGenerationRunDetail"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Generation Run",
        "tags": [
          "admin",
          "Admin - Generation"
        ]
      }
    },
    "/v1/admin/question-generation-status/{job_id}": {
      "get": {
        "description": "Check the status of a question generation job by job ID.\n\nThis endpoint is deprecated. Use GET /v1/admin/background-jobs/{job_id} instead\nfor more detailed job information from the process registry.\n\nFor legacy compatibility, this endpoint also accepts a PID as job_id\nand will look up the job in the registry by PID.\n\nArgs:\n    job_id: Job ID (from registry) or Process ID (legacy)\n    _: Admin token validation dependency\n\nReturns:\n    Job status information",
        "operationId": "get_question_generation_status_v1_admin_question_generation_status__job_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "job_id",
            "required": true,
            "schema": {
              "title": "Job Id",
              "type": "string"
            }
          },
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Question Generation Status",
        "tags": [
          "admin",
          "Admin - Generation"
        ]
      }
    },
    "/v1/admin/questions/calibration-health": {
      "get": {
        "description": "Get calibration health summary for all questions.\n\nReturns a comprehensive overview of how well AI-assigned difficulty labels\nmatch empirical user performance data. Questions with empirical p-values\noutside the expected range for their assigned difficulty are flagged as\nmiscalibrated.\n\nRequires X-Admin-Token header with valid admin token.\n\n**Expected p-value ranges by difficulty:**\n- Easy: 0.70 - 0.90 (70-90% correct)\n- Medium: 0.40 - 0.70 (40-70% correct)\n- Hard: 0.15 - 0.40 (15-40% correct)\n\n**Severity levels:**\n- Minor: Within 0.10 of expected range boundary\n- Major: 0.10-0.25 outside expected range\n- Severe: >0.25 outside expected range\n\n**Response includes:**\n- Summary statistics (total, calibrated, miscalibrated, rate)\n- Breakdown by severity level\n- Breakdown by difficulty level\n- Top 10 most severely miscalibrated questions\n\nArgs:\n    min_responses: Minimum response count for reliable validation (default: 100)\n    db: Database session\n    _: Admin token validation dependency\n\nReturns:\n    CalibrationHealthResponse with comprehensive calibration status\n\nExample:\n    ```\n    curl \"https://api.example.com/v1/admin/questions/calibration-health?min_responses=100\" \\\n      -H \"X-Admin-Token: your-admin-token\"\n    ```",
        "operationId": "get_calibration_health_v1_admin_questions_calibration_health_get",
        "parameters": [
          {
            "description": "Minimum responses required for reliable validation",
            "in": "query",
            "name": "min_responses",
            "required": false,
            "schema": {
              "default": 100,
              "description": "Minimum responses required for reliable validation",
              "maximum": 1000,
              "minimum": 1,
              "title": "Min Responses",
              "type": "integer"
            }
          },
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CalibrationHealthResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Calibration Health",
        "tags": [
          "admin",
          "Admin - Calibration"
        ]
      }
    },
    "/v1/admin/questions/discrimination-report": {
      "get": {
        "description": "Get comprehensive discrimination report for all questions.\n\nProvides an overview of question discrimination quality across the entire\nquestion pool, useful for monitoring test quality and identifying\nproblematic questions that need attention.\n\nRequires X-Admin-Token header with valid admin token.\n\n**Quality Tiers:**\n- Excellent: r >= 0.40 (very good discrimination)\n- Good: 0.30 <= r < 0.40 (good discrimination)\n- Acceptable: 0.20 <= r < 0.30 (adequate discrimination)\n- Poor: 0.10 <= r < 0.20 (poor discrimination)\n- Very Poor: 0.00 <= r < 0.10 (very poor discrimination)\n- Negative: r < 0.00 (problematic - high scorers miss more)\n\n**Report Sections:**\n- summary: Count of questions in each quality tier\n- quality_distribution: Percentage breakdown of quality tiers\n- by_difficulty: Mean discrimination and negative count by difficulty level\n- by_type: Mean discrimination and negative count by question type\n- action_needed: Questions requiring immediate_review or monitoring\n- trends: 30-day mean discrimination and new negatives this week\n\nArgs:\n    min_responses: Minimum response count for question inclusion (default: 30)\n    action_list_limit: Maximum items per action_needed list (default: 100).\n        Results are ordered by discrimination (worst first) so the most\n        problematic questions appear at the top.\n    db: Database session\n    _: Admin token validation dependency\n\nReturns:\n    DiscriminationReportResponse with comprehensive quality metrics\n\nExample:\n    ```\n    curl \"https://api.example.com/v1/admin/questions/discrimination-report?min_responses=50&action_list_limit=25\" \\\n      -H \"X-Admin-Token: your-admin-token\"\n    ```",
        "operationId": "get_discrimination_report_endpoint_v1_admin_questions_discrimination_report_get",
        "parameters": [
          {
            "description": "Minimum responses required for a question to be included in the report",
            "in": "query",
            "name": "min_responses",
            "required": false,
            "schema": {
              "default": 30,
              "description": "Minimum responses required for a question to be included in the report",
              "maximum": 1000,
              "minimum": 1,
              "title": "Min Responses",
              "type": "integer"
            }
          },
          {
            "description": "Maximum items per action_needed list (immediate_review, monitor)",
            "in": "query",
            "name": "action_list_limit",
            "required": false,
            "schema": {
              "default": 100,
              "description": "Maximum items per action_needed list (immediate_review, monitor)",
              "maximum": 1000,
              "minimum": 1,
              "title": "Action List Limit",
              "type": "integer"
            }
          },
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DiscriminationReportResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Discrimination Report Endpoint",
        "tags": [
          "admin",
          "Admin - Discrimination"
        ]
      }
    },
    "/v1/admin/questions/distractor-summary": {
      "get": {
        "description": "Get aggregate distractor analysis statistics across all questions.\n\nProvides a summary of distractor effectiveness across all multiple-choice\nquestions with sufficient response data. This helps identify systemic\nissues with question quality and prioritize question improvements.\n\nRequires X-Admin-Token header with valid admin token.\n\n**Summary Statistics:**\n- Total questions analyzed (meeting minimum response threshold)\n- Questions with non-functioning distractors (selected by <2%)\n- Questions with inverted distractors (high scorers prefer wrong answers)\n\n**Breakdown by Non-Functioning Count:**\n- How many questions have 0, 1, 2, or 3+ non-functioning distractors\n\n**Worst Offenders:**\n- Top 10 questions with the most distractor issues, sorted by severity\n- Severity is calculated as: (non_functioning * 2) + inverted\n\n**By Question Type:**\n- Stats grouped by question type (pattern, logic, spatial, etc.)\n- Helps identify if certain question types have more distractor issues\n\nArgs:\n    min_responses: Minimum number of responses required for analysis (default: 50)\n    question_type: Optional filter by question type\n    db: Database session\n    _: Admin token validation dependency\n\nReturns:\n    DistractorSummaryResponse with aggregate statistics\n\nExample:\n    ```\n    # Get summary for all questions\n    curl \"https://api.example.com/v1/admin/questions/distractor-summary\" \\\n      -H \"X-Admin-Token: your-admin-token\"\n\n    # Filter by question type\n    curl \"https://api.example.com/v1/admin/questions/distractor-summary?question_type=pattern\" \\\n      -H \"X-Admin-Token: your-admin-token\"\n\n    # Increase minimum response threshold\n    curl \"https://api.example.com/v1/admin/questions/distractor-summary?min_responses=100\" \\\n      -H \"X-Admin-Token: your-admin-token\"\n    ```",
        "operationId": "get_distractor_summary_v1_admin_questions_distractor_summary_get",
        "parameters": [
          {
            "description": "Minimum responses required for analysis",
            "in": "query",
            "name": "min_responses",
            "required": false,
            "schema": {
              "default": 50,
              "description": "Minimum responses required for analysis",
              "maximum": 1000,
              "minimum": 1,
              "title": "Min Responses",
              "type": "integer"
            }
          },
          {
            "description": "Filter by question type (pattern, logic, spatial, math, verbal, memory)",
            "in": "query",
            "name": "question_type",
            "required": false,
            "schema": {
              "description": "Filter by question type (pattern, logic, spatial, math, verbal, memory)",
              "nullable": true,
              "title": "Question Type",
              "type": "string"
            }
          },
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DistractorSummaryResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Distractor Summary",
        "tags": [
          "admin",
          "Admin - Distractors"
        ]
      }
    },
    "/v1/admin/questions/recalibrate": {
      "post": {
        "description": "Trigger recalibration of question difficulty labels based on empirical data.\n\nUpdates difficulty labels for questions where the AI-assigned label\ndoesn't match actual user performance. Preserves original labels for\naudit purposes.\n\nRequires X-Admin-Token header with valid admin token.\n\n**Expected p-value ranges by difficulty:**\n- Easy: 0.70 - 0.90 (70-90% correct)\n- Medium: 0.40 - 0.70 (40-70% correct)\n- Hard: 0.15 - 0.40 (15-40% correct)\n\n**Severity levels (determines threshold):**\n- Minor: Within 0.10 of expected range boundary\n- Major: 0.10-0.25 outside expected range\n- Severe: >0.25 outside expected range\n\n**Recalibration modes:**\n- dry_run=true: Preview changes without applying (default)\n- dry_run=false: Commit changes to database\n\n**Filtering options:**\n- question_ids: Limit to specific questions\n- severity_threshold: Only recalibrate questions at or above this severity\n- min_responses: Require minimum response count for reliability\n\nArgs:\n    request: Recalibration parameters\n    db: Database session\n    _: Admin token validation dependency\n\nReturns:\n    RecalibrationResponse with recalibrated and skipped questions\n\nExample:\n    ```\n    # Dry run to preview changes\n    curl -X POST \"https://api.example.com/v1/admin/questions/recalibrate\" \\\n      -H \"X-Admin-Token: your-admin-token\" \\\n      -H \"Content-Type: application/json\" \\\n      -d '{\"dry_run\": true, \"min_responses\": 100, \"severity_threshold\": \"major\"}'\n\n    # Apply changes\n    curl -X POST \"https://api.example.com/v1/admin/questions/recalibrate\" \\\n      -H \"X-Admin-Token: your-admin-token\" \\\n      -H \"Content-Type: application/json\" \\\n      -d '{\"dry_run\": false, \"min_responses\": 100, \"severity_threshold\": \"major\"}'\n    ```",
        "operationId": "recalibrate_difficulty_labels_v1_admin_questions_recalibrate_post",
        "parameters": [
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RecalibrationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RecalibrationResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Recalibrate Difficulty Labels",
        "tags": [
          "admin",
          "Admin - Calibration"
        ]
      }
    },
    "/v1/admin/questions/{question_id}/discrimination-detail": {
      "get": {
        "description": "Get detailed discrimination info for a specific question.\n\nProvides in-depth discrimination analysis for a single question, including\ncomparison to type and difficulty averages, percentile ranking, and\nquality flag status.\n\nRequires X-Admin-Token header with valid admin token.\n\n**Response Fields:**\n- discrimination: Current point-biserial correlation value\n- quality_tier: Classification (excellent, good, acceptable, poor, very_poor, negative)\n- response_count: Number of responses used for calculation\n- compared_to_type_avg: How this question compares to its type average (above, below, at)\n- compared_to_difficulty_avg: How this question compares to its difficulty average\n- percentile_rank: Position among all questions (0-100)\n- quality_flag: Current flag status (normal, under_review, deactivated)\n- history: Historical discrimination values (if available)\n\nArgs:\n    question_id: The unique identifier of the question to analyze\n    db: Database session\n    _: Admin token validation dependency\n\nReturns:\n    DiscriminationDetailResponse with detailed question analysis\n\nRaises:\n    HTTPException 404: If the question is not found\n\nExample:\n    ```\n    curl \"https://api.example.com/v1/admin/questions/123/discrimination-detail\" \\\n      -H \"X-Admin-Token: your-admin-token\"\n    ```",
        "operationId": "get_discrimination_detail_endpoint_v1_admin_questions__question_id__discrimination_detail_get",
        "parameters": [
          {
            "in": "path",
            "name": "question_id",
            "required": true,
            "schema": {
              "title": "Question Id",
              "type": "integer"
            }
          },
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DiscriminationDetailResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "404": {
            "description": "Question not found"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Discrimination Detail Endpoint",
        "tags": [
          "admin",
          "Admin - Discrimination"
        ]
      }
    },
    "/v1/admin/questions/{question_id}/distractor-analysis": {
      "get": {
        "description": "Get detailed distractor analysis for a single question.\n\nAnalyzes the effectiveness of each answer option (distractor) for a\nmultiple-choice question. This helps identify non-functioning distractors\n(rarely selected) and inverted distractors (high scorers prefer them).\n\nRequires X-Admin-Token header with valid admin token.\n\n**Status Classifications:**\n- Functioning: Selected by >=5% of respondents (good distractor)\n- Weak: Selected by 2-5% of respondents (marginal)\n- Non-functioning: Selected by <2% of respondents (not attracting anyone)\n\n**Discrimination Classifications:**\n- Good: Bottom quartile selects more than top (positive index > 0.10)\n- Neutral: Similar selection rates across ability levels (|index| <= 0.10)\n- Inverted: Top quartile selects more than bottom (index < -0.10)\n  This is problematic as it suggests high-ability test-takers are attracted\n  to the \"wrong\" answer.\n\n**Effective Option Count:**\nCalculated using the inverse Simpson index. A value of 4.0 for a 4-option\nquestion means all options are selected equally. A value of 1.0 means\nessentially only one option is ever selected.\n\nArgs:\n    question_id: The unique identifier of the question to analyze\n    min_responses: Minimum number of responses required for analysis (default: 50)\n    db: Database session\n    _: Admin token validation dependency\n\nReturns:\n    DistractorAnalysisResponse with detailed analysis for each option\n\nRaises:\n    HTTPException 404: If the question is not found\n    HTTPException 400: If the question is not a multiple-choice question\n\nExample:\n    ```\n    curl \"https://api.example.com/v1/admin/questions/123/distractor-analysis?min_responses=50\" \\\n      -H \"X-Admin-Token: your-admin-token\"\n    ```",
        "operationId": "get_distractor_analysis_v1_admin_questions__question_id__distractor_analysis_get",
        "parameters": [
          {
            "in": "path",
            "name": "question_id",
            "required": true,
            "schema": {
              "title": "Question Id",
              "type": "integer"
            }
          },
          {
            "description": "Minimum responses required for analysis",
            "in": "query",
            "name": "min_responses",
            "required": false,
            "schema": {
              "default": 50,
              "description": "Minimum responses required for analysis",
              "maximum": 1000,
              "minimum": 1,
              "title": "Min Responses",
              "type": "integer"
            }
          },
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DistractorAnalysisResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "400": {
            "description": "Question is not a multiple-choice question"
          },
          "404": {
            "description": "Question not found"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Distractor Analysis",
        "tags": [
          "admin",
          "Admin - Distractors"
        ]
      }
    },
    "/v1/admin/questions/{question_id}/quality-flag": {
      "patch": {
        "description": "Update the quality flag for a question.\n\nAllows admins to manually manage question quality status. Questions can be:\n- Set to \"under_review\" for further investigation\n- Set to \"deactivated\" to permanently exclude from tests (requires reason)\n- Set back to \"normal\" to return to active use\n\nRequires X-Admin-Token header with valid admin token.\n\n**Flag Values:**\n- `normal`: Question is active and eligible for test selection\n- `under_review`: Question is temporarily excluded pending review\n- `deactivated`: Question is permanently excluded from test selection\n\n**Validation:**\n- A reason is **required** when setting the flag to \"deactivated\"\n- A reason is optional but recommended for \"under_review\"\n\nArgs:\n    question_id: The unique identifier of the question to update\n    request: The quality flag update request containing new flag and optional reason\n    db: Database session\n    _: Admin token validation dependency\n\nReturns:\n    QualityFlagUpdateResponse with previous and new flag values\n\nRaises:\n    HTTPException 404: If the question is not found\n    HTTPException 422: If reason is missing when deactivating\n\nExample:\n    ```\n    curl -X PATCH \"https://api.example.com/v1/admin/questions/123/quality-flag\" \\\n      -H \"X-Admin-Token: your-admin-token\" \\\n      -H \"Content-Type: application/json\" \\\n      -d '{\"quality_flag\": \"deactivated\", \"reason\": \"Ambiguous wording confirmed by review\"}'\n    ```",
        "operationId": "update_quality_flag_v1_admin_questions__question_id__quality_flag_patch",
        "parameters": [
          {
            "in": "path",
            "name": "question_id",
            "required": true,
            "schema": {
              "title": "Question Id",
              "type": "integer"
            }
          },
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/QualityFlagUpdateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/QualityFlagUpdateResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "404": {
            "description": "Question not found"
          },
          "422": {
            "description": "Validation error - reason required for deactivation"
          }
        },
        "summary": "Update Quality Flag",
        "tags": [
          "admin",
          "Admin - Discrimination"
        ]
      }
    },
    "/v1/admin/reliability": {
      "get": {
        "description": "Get reliability metrics report for admin dashboard.\n\nReturns comprehensive reliability metrics including:\n- **Cronbach's alpha**: Measures internal consistency (how well items measure\n  the same construct). Target: >= 0.70 for acceptable reliability.\n- **Test-retest reliability**: Measures score stability over time using Pearson\n  correlation between consecutive tests. Target: > 0.50 for acceptable reliability.\n- **Split-half reliability**: Measures internal consistency by splitting tests\n  into odd/even halves with Spearman-Brown correction. Target: >= 0.70.\n\n**Interpretation thresholds:**\n- Excellent: alpha/r >= 0.90\n- Good: alpha/r >= 0.80\n- Acceptable: alpha/r >= 0.70 (alpha/split-half) or r > 0.50 (test-retest)\n- Poor: Below acceptable thresholds\n\n**Data requirements:**\n- Cronbach's alpha and split-half: Minimum 100 completed test sessions\n- Test-retest: Minimum 30 users who have taken the test multiple times\n\nWhen `store_metrics=true` (default), calculated metrics are persisted to the\ndatabase for historical trend analysis via the `/reliability/history` endpoint.\n\nRequires X-Admin-Token header with valid admin token.\n\n**Caching (RE-FI-019):**\nResults are cached for 5 minutes when `store_metrics=false` to avoid\nrecalculating expensive metrics on every request. When `store_metrics=true`,\nfresh calculations are performed to ensure accurate data is stored.",
        "operationId": "get_reliability_report_endpoint_v1_admin_reliability_get",
        "parameters": [
          {
            "description": "Minimum sessions required for alpha/split-half calculations",
            "in": "query",
            "name": "min_sessions",
            "required": false,
            "schema": {
              "default": 100,
              "description": "Minimum sessions required for alpha/split-half calculations",
              "minimum": 10,
              "title": "Min Sessions",
              "type": "integer"
            }
          },
          {
            "description": "Minimum retest pairs required for test-retest calculation",
            "in": "query",
            "name": "min_retest_pairs",
            "required": false,
            "schema": {
              "default": 30,
              "description": "Minimum retest pairs required for test-retest calculation",
              "minimum": 10,
              "title": "Min Retest Pairs",
              "type": "integer"
            }
          },
          {
            "description": "Whether to persist calculated metrics to the database",
            "in": "query",
            "name": "store_metrics",
            "required": false,
            "schema": {
              "default": true,
              "description": "Whether to persist calculated metrics to the database",
              "title": "Store Metrics",
              "type": "boolean"
            }
          },
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReliabilityReportResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "401": {
            "description": "Invalid admin token"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Reliability Report Endpoint",
        "tags": [
          "admin",
          "Admin - Reliability"
        ]
      }
    },
    "/v1/admin/reliability/history": {
      "get": {
        "description": "Get historical reliability metrics for trend analysis.\n\nReturns stored reliability metrics from the database, optionally filtered\nby metric type and time period. Metrics are ordered by calculated_at DESC\n(most recent first).\n\n**Use cases:**\n- Track how reliability metrics change over time as more data is collected\n- Compare reliability across different time periods\n- Monitor the impact of item removals or additions on reliability\n\n**Query parameters:**\n- `metric_type`: Optional filter to retrieve only one type of metric\n  (cronbachs_alpha, test_retest, or split_half)\n- `days`: Number of days of history to retrieve (default: 90, max: 365)\n\nRequires X-Admin-Token header with valid admin token.",
        "operationId": "get_reliability_history_endpoint_v1_admin_reliability_history_get",
        "parameters": [
          {
            "description": "Filter by metric type: cronbachs_alpha, test_retest, split_half",
            "in": "query",
            "name": "metric_type",
            "required": false,
            "schema": {
              "description": "Filter by metric type: cronbachs_alpha, test_retest, split_half",
              "enum": [
                "cronbachs_alpha",
                "test_retest",
                "split_half"
              ],
              "nullable": true,
              "title": "Metric Type",
              "type": "string"
            }
          },
          {
            "description": "Number of days of history to retrieve (1-365)",
            "in": "query",
            "name": "days",
            "required": false,
            "schema": {
              "default": 90,
              "description": "Number of days of history to retrieve (1-365)",
              "maximum": 365,
              "minimum": 1,
              "title": "Days",
              "type": "integer"
            }
          },
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReliabilityHistoryResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "401": {
            "description": "Invalid admin token"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Reliability History Endpoint",
        "tags": [
          "admin",
          "Admin - Reliability"
        ]
      }
    },
    "/v1/admin/scoring/compare/{session_id}": {
      "get": {
        "description": "Calculate and compare both equal-weight and weighted IQ scores for a test session.\n\nThis endpoint is useful for A/B testing weighted scoring before enabling it.\nIt recalculates both scores from the stored domain_scores and allows comparison\nwithout affecting the stored result.\n\nRequires X-Admin-Token header with valid admin token.\n\nArgs:\n    session_id: The test session ID to calculate comparison for\n\nReturns:\n    ABComparisonResult with both scores, difference, and details\n\nExample:\n    ```\n    curl \"https://api.example.com/v1/admin/scoring/compare/123\" \\\n      -H \"X-Admin-Token: your-admin-token\"\n    ```",
        "operationId": "compare_scoring_methods_v1_admin_scoring_compare__session_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "session_id",
            "required": true,
            "schema": {
              "title": "Session Id",
              "type": "integer"
            }
          },
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ABComparisonResult"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Compare Scoring Methods",
        "tags": [
          "admin",
          "Admin - Config"
        ]
      }
    },
    "/v1/admin/sessions/{session_id}/validity": {
      "get": {
        "description": "Get detailed validity analysis for a single test session.\n\nReturns the validity assessment for a specific test session, including\nthe overall validity status, severity score, confidence level, and\ndetailed breakdown of each validity check component.\n\nRequires X-Admin-Token header with valid admin token.\n\n**Validity Status:**\n- `valid`: No significant concerns, session is valid\n- `suspect`: Moderate concerns, may need manual review\n- `invalid`: Strong concerns, requires admin review\n\n**Severity Score:**\nCombined score from all validity checks:\n- Aberrant person-fit: +2 points\n- High-severity time flags: +2 points each\n- High Guttman errors: +2 points\n- Elevated Guttman errors: +1 point\n\n**Confidence:**\nInverse of severity (1.0 = fully confident, decreases by 0.15 per severity point)\n\n**On-Demand Analysis:**\nIf the session has not been validity-checked yet (sessions from before CD-007),\nvalidity analysis will be performed on-demand and the result will be returned\n(but not stored).\n\nArgs:\n    session_id: The test session ID to analyze\n    db: Database session\n    _: Admin token validation dependency\n\nReturns:\n    SessionValidityResponse with full validity breakdown\n\nRaises:\n    HTTPException 404: If the test session is not found\n\nExample:\n    ```\n    curl \"https://api.example.com/v1/admin/sessions/123/validity\" \\\n      -H \"X-Admin-Token: your-admin-token\"\n    ```",
        "operationId": "get_session_validity_v1_admin_sessions__session_id__validity_get",
        "parameters": [
          {
            "in": "path",
            "name": "session_id",
            "required": true,
            "schema": {
              "title": "Session Id",
              "type": "integer"
            }
          },
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SessionValidityResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "404": {
            "description": "Test session not found"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Session Validity",
        "tags": [
          "admin",
          "Admin - Validity"
        ]
      },
      "patch": {
        "description": "Override the validity status of a test session after admin review.\n\nAllows administrators to manually change the validity assessment for a\nsession after investigating the flags. This is essential for handling\nfalse positives (legitimate sessions incorrectly flagged) and false\nnegatives (invalid sessions that passed automatic checks).\n\nRequires X-Admin-Token header with valid admin token.\n\n**Important Notes:**\n- A reason must be provided (minimum 10 characters) for audit purposes\n- The previous validity status is preserved for audit trail\n- Override timestamp and admin placeholder are recorded\n- All override actions are logged for security monitoring\n\n**Use Cases:**\n- Clearing a false positive: User was flagged for rapid responses but\n  review confirms they're a fast reader with consistent test history\n- Marking a false negative: Session passed checks but investigation\n  reveals the account was shared or test was taken inappropriately\n- Downgrading after investigation: Session was flagged as \"invalid\"\n  but evidence suggests only moderate concern (\"suspect\")\n\nArgs:\n    session_id: The test session ID to update\n    request: Override request with new status and reason\n    db: Database session\n    _: Admin token validation dependency\n\nReturns:\n    ValidityOverrideResponse confirming the update\n\nRaises:\n    HTTPException 404: If the test session is not found\n\nExample:\n    ```\n    curl -X PATCH \"https://api.example.com/v1/admin/sessions/123/validity\" \\\n      -H \"X-Admin-Token: your-admin-token\" \\\n      -H \"Content-Type: application/json\" \\\n      -d '{\n        \"validity_status\": \"valid\",\n        \"override_reason\": \"Manual review confirmed legitimate pattern. User has consistent test history and rapid responses were on very easy questions.\"\n      }'\n    ```",
        "operationId": "override_session_validity_v1_admin_sessions__session_id__validity_patch",
        "parameters": [
          {
            "in": "path",
            "name": "session_id",
            "required": true,
            "schema": {
              "title": "Session Id",
              "type": "integer"
            }
          },
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ValidityOverrideRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidityOverrideResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "404": {
            "description": "Test session not found"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Override Session Validity",
        "tags": [
          "admin",
          "Admin - Validity"
        ]
      }
    },
    "/v1/admin/trigger-question-generation": {
      "post": {
        "description": "Manually trigger the question generation job.\n\nThis endpoint allows administrators to trigger the question generation\nprocess on-demand instead of waiting for the scheduled cron job.\n\nThe job is registered in the process registry for tracking. Use\nGET /v1/admin/background-jobs to list all registered jobs and\nGET /v1/admin/background-jobs/{job_id} to check status.\n\nRequires X-Admin-Token header with valid admin token.\n\nArgs:\n    request: Question generation parameters\n    _: Admin token validation dependency\n\nReturns:\n    TriggerQuestionGenerationResponse with job_id for tracking\n\nExample:\n    ```\n    curl -X POST https://api.example.com/v1/admin/trigger-question-generation           -H \"X-Admin-Token: your-admin-token\"           -H \"Content-Type: application/json\"           -d '{\"count\": 50, \"dry_run\": false}'\n    ```",
        "operationId": "trigger_question_generation_v1_admin_trigger_question_generation_post",
        "parameters": [
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TriggerQuestionGenerationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TriggerQuestionGenerationResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Trigger Question Generation",
        "tags": [
          "admin",
          "Admin - Generation"
        ]
      }
    },
    "/v1/admin/validity-report": {
      "get": {
        "description": "Get aggregate validity statistics across all test sessions.\n\nReturns a comprehensive summary of validity analysis results including\nstatus breakdowns, flag type counts, trend comparisons, and a list of\nsessions requiring admin review.\n\nRequires X-Admin-Token header with valid admin token.\n\n**Summary Statistics:**\n- Total sessions analyzed in the period\n- Count by validity status (valid, suspect, invalid)\n\n**Flag Type Breakdown:**\n- Count of each flag type detected across sessions\n- Helps identify most common validity concerns\n\n**Trend Analysis:**\n- Compares invalid/suspect rates between last 7 days and full period\n- Trend indicator: \"improving\", \"stable\", or \"worsening\"\n\n**Action Needed:**\n- List of sessions with invalid or suspect status needing review\n- Sorted by severity score (most severe first)\n- Limited to top 50 sessions to keep response manageable\n\nArgs:\n    days: Number of days to analyze (default: 30, max: 365)\n    status: Optional filter by validity status\n    db: Database session\n    _: Admin token validation dependency\n\nReturns:\n    ValiditySummaryResponse with aggregate validity statistics\n\nExample:\n    ```\n    # Get 30-day validity report\n    curl \"https://api.example.com/v1/admin/validity-report\" \\\n      -H \"X-Admin-Token: your-admin-token\"\n\n    # Get 7-day report for invalid sessions only\n    curl \"https://api.example.com/v1/admin/validity-report?days=7&status=invalid\" \\\n      -H \"X-Admin-Token: your-admin-token\"\n    ```",
        "operationId": "get_validity_report_v1_admin_validity_report_get",
        "parameters": [
          {
            "description": "Number of days to analyze (default: 30)",
            "in": "query",
            "name": "days",
            "required": false,
            "schema": {
              "default": 30,
              "description": "Number of days to analyze (default: 30)",
              "maximum": 365,
              "minimum": 1,
              "title": "Days",
              "type": "integer"
            }
          },
          {
            "description": "Filter by validity status (valid, suspect, invalid)",
            "in": "query",
            "name": "status",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ValidityStatus"
                }
              ],
              "description": "Filter by validity status (valid, suspect, invalid)",
              "nullable": true,
              "title": "Status"
            }
          },
          {
            "in": "header",
            "name": "x-admin-token",
            "required": true,
            "schema": {
              "title": "X-Admin-Token",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValiditySummaryResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Validity Report",
        "tags": [
          "admin",
          "Admin - Validity"
        ]
      }
    },
    "/v1/analytics/events": {
      "post": {
        "description": "Submit a batch of analytics events from the client.\n\nThis endpoint accepts analytics events from iOS and other clients.\nEvents are stored for product analytics, debugging, and user\nexperience insights.\n\nAuthentication is optional - pre-auth events (like app launch)\ncan be submitted without a token.\n\nArgs:\n    batch: Batch of analytics events to submit\n    current_user: Current authenticated user (optional)\n    db: Database session\n\nReturns:\n    Response indicating how many events were received\n\nExample:\n    POST /api/v1/analytics/events\n    {\n        \"events\": [\n            {\n                \"event_name\": \"user.login\",\n                \"timestamp\": \"2024-01-15T10:30:00Z\",\n                \"properties\": {\"email_domain\": \"gmail.com\"}\n            }\n        ],\n        \"client_platform\": \"ios\",\n        \"app_version\": \"1.2.0\"\n    }",
        "operationId": "submit_analytics_events_v1_analytics_events_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AnalyticsEventsBatch"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AnalyticsEventsResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "summary": "Submit Analytics Events",
        "tags": [
          "analytics"
        ]
      }
    },
    "/v1/analytics/questions/problematic": {
      "get": {
        "description": "Identify questions with poor psychometric properties.\n\nCategorizes problematic questions into four groups:\n1. Too easy: > 95% of users answer correctly\n2. Too hard: < 5% of users answer correctly\n3. Poor discrimination: discrimination < 0.2 (doesn't separate ability levels well)\n4. Negative discrimination: discrimination < 0 (low performers do better)\n\nArgs:\n    min_responses: Minimum responses required to flag (default: 30)\n    db: Database session\n\nReturns:\n    Dictionary with categorized problematic questions:\n    {\n        \"too_easy\": [...],\n        \"too_hard\": [...],\n        \"poor_discrimination\": [...],\n        \"negative_discrimination\": [...]\n    }\n\nExample:\n    GET /api/v1/analytics/questions/problematic?min_responses=50\n    Response:\n    {\n        \"too_easy\": [\n            {\n                \"question_id\": 15,\n                \"question_type\": \"verbal\",\n                \"difficulty_level\": \"easy\",\n                \"empirical_difficulty\": 0.97,\n                \"discrimination\": 0.15,\n                \"response_count\": 82\n            }\n        ],\n        \"too_hard\": [],\n        \"poor_discrimination\": [...],\n        \"negative_discrimination\": []\n    }\n\nUse Cases:\n    - Quality control: identify questions that need review or deactivation\n    - Test improvement: find questions that don't contribute to measurement\n    - LLM evaluation: assess which types of generated questions have issues\n\nNotes:\n    - Negative discrimination indicates a problematic question that should\n      likely be deactivated, as it suggests low-ability users do better\n    - Too easy/hard questions provide little information and should be reviewed\n    - Poor discrimination questions don't help separate high/low performers",
        "operationId": "get_problematic_questions_v1_analytics_questions_problematic_get",
        "parameters": [
          {
            "description": "Minimum responses required to flag as problematic",
            "in": "query",
            "name": "min_responses",
            "required": false,
            "schema": {
              "default": 30,
              "description": "Minimum responses required to flag as problematic",
              "maximum": 1000,
              "minimum": 2,
              "title": "Min Responses",
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": {
                    "items": {
                      "type": "object"
                    },
                    "type": "array"
                  },
                  "title": "Response Get Problematic Questions V1 Analytics Questions Problematic Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Problematic Questions",
        "tags": [
          "analytics"
        ]
      }
    },
    "/v1/analytics/questions/statistics": {
      "get": {
        "description": "Get performance statistics for all questions.\n\nReturns list of questions with their empirical statistics,\nordered by response count (most responses first).\n\nArgs:\n    min_responses: Minimum response count to include (default: 0 for all)\n    db: Database session\n\nReturns:\n    List of question statistics, ordered by response count DESC\n\nExample:\n    GET /api/v1/analytics/questions/statistics?min_responses=30\n    Response:\n    [\n        {\n            \"question_id\": 42,\n            \"question_type\": \"mathematical\",\n            \"difficulty_level\": \"medium\",\n            \"empirical_difficulty\": 0.72,\n            \"discrimination\": 0.45,\n            \"response_count\": 150,\n            \"has_sufficient_data\": true,\n            \"is_active\": true\n        },\n        ...\n    ]\n\nUse Cases:\n    - Monitor overall question pool quality\n    - Identify which questions have sufficient calibration data\n    - Compare empirical vs assigned difficulty levels",
        "operationId": "get_all_questions_stats_v1_analytics_questions_statistics_get",
        "parameters": [
          {
            "description": "Minimum response count to include",
            "in": "query",
            "name": "min_responses",
            "required": false,
            "schema": {
              "default": 0,
              "description": "Minimum response count to include",
              "maximum": 1000,
              "minimum": 0,
              "title": "Min Responses",
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "type": "object"
                  },
                  "title": "Response Get All Questions Stats V1 Analytics Questions Statistics Get",
                  "type": "array"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get All Questions Stats",
        "tags": [
          "analytics"
        ]
      }
    },
    "/v1/analytics/questions/{question_id}/statistics": {
      "get": {
        "description": "Get performance statistics for a specific question.\n\nReturns empirical difficulty (p-value), discrimination, and response count.\n\nArgs:\n    question_id: Question ID\n    db: Database session\n\nReturns:\n    Dictionary with question statistics:\n    {\n        \"question_id\": int,\n        \"empirical_difficulty\": float or None,\n        \"discrimination\": float or None,\n        \"response_count\": int,\n        \"has_sufficient_data\": bool\n    }\n\nExample:\n    GET /api/v1/analytics/questions/42/statistics\n    Response:\n    {\n        \"question_id\": 42,\n        \"empirical_difficulty\": 0.72,\n        \"discrimination\": 0.45,\n        \"response_count\": 150,\n        \"has_sufficient_data\": true\n    }\n\nNotes:\n    - empirical_difficulty: proportion correct (0.0 = very hard, 1.0 = very easy)\n    - discrimination: item-total correlation (-1.0 to 1.0, higher = better)\n    - has_sufficient_data: true if response_count >= 30",
        "operationId": "get_question_stats_v1_analytics_questions__question_id__statistics_get",
        "parameters": [
          {
            "in": "path",
            "name": "question_id",
            "required": true,
            "schema": {
              "title": "Question Id",
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Get Question Stats V1 Analytics Questions  Question Id  Statistics Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Question Stats",
        "tags": [
          "analytics"
        ]
      }
    },
    "/v1/auth/login": {
      "post": {
        "description": "Authenticate user and return access + refresh tokens.\n\nArgs:\n    credentials: User login credentials\n    db: Database session\n\nReturns:\n    Access and refresh JWT tokens with user information\n\nRaises:\n    HTTPException: 401 if credentials are invalid",
        "operationId": "login_user_v1_auth_login_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UserLogin"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Token"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Login User",
        "tags": [
          "auth"
        ]
      }
    },
    "/v1/auth/logout": {
      "post": {
        "description": "Logout user (client-side token invalidation).\n\nNote: Since we're using stateless JWT tokens, actual logout happens\non the client side by discarding the tokens. This endpoint validates\nthat the user is authenticated and allows the client to confirm logout.\n\nArgs:\n    current_user: Current authenticated user\n\nReturns:\n    No content (204)",
        "operationId": "logout_user_v1_auth_logout_post",
        "responses": {
          "204": {
            "description": "Successful Response"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "summary": "Logout User",
        "tags": [
          "auth"
        ]
      }
    },
    "/v1/auth/refresh": {
      "post": {
        "description": "Refresh access token using refresh token.\n\nArgs:\n    current_user: Current authenticated user from refresh token\n    db: Database session\n\nReturns:\n    New access and refresh tokens with user information\n\nRaises:\n    HTTPException: 401 if refresh token is invalid",
        "operationId": "refresh_access_token_v1_auth_refresh_post",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TokenRefresh"
                }
              }
            },
            "description": "Successful Response"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "summary": "Refresh Access Token",
        "tags": [
          "auth"
        ]
      }
    },
    "/v1/auth/register": {
      "post": {
        "description": "Register a new user account.\n\nArgs:\n    user_data: User registration data\n    db: Database session\n\nReturns:\n    Created user information with access and refresh tokens\n\nRaises:\n    HTTPException: 409 if email already exists",
        "operationId": "register_user_v1_auth_register_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UserRegister"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Token"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Register User",
        "tags": [
          "auth"
        ]
      }
    },
    "/v1/feedback/submit": {
      "post": {
        "description": "Submit user feedback, bug report, or feature request.\n\nThis endpoint allows users to submit feedback even before authentication,\nmaking it useful for reporting onboarding issues or bugs encountered\nduring the registration process.\n\nRate limit: 5 submissions per hour per IP address.\n\nArgs:\n    feedback_data: Feedback submission data\n    request: FastAPI request object (for IP extraction)\n    db: Database session\n    current_user: Optional authenticated user (injected by dependency)\n\nReturns:\n    Feedback submission confirmation with submission ID\n\nRaises:\n    HTTPException: 429 if rate limit exceeded, 500 on server error",
        "operationId": "submit_feedback_v1_feedback_submit_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/FeedbackSubmitRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FeedbackSubmitResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "summary": "Submit Feedback",
        "tags": [
          "feedback"
        ]
      }
    },
    "/v1/health": {
      "get": {
        "description": "Health check endpoint.\nReturns basic health status of the API.",
        "operationId": "health_check_v1_health_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "Health Check",
        "tags": [
          "health"
        ]
      }
    },
    "/v1/notifications/preferences": {
      "get": {
        "description": "Get current notification preferences for the user.\n\nArgs:\n    current_user: Current authenticated user\n\nReturns:\n    Current notification preferences",
        "operationId": "get_notification_preferences_v1_notifications_preferences_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NotificationPreferencesResponse"
                }
              }
            },
            "description": "Successful Response"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "summary": "Get Notification Preferences",
        "tags": [
          "notifications"
        ]
      },
      "put": {
        "description": "Update notification preferences for the current user.\n\nThis endpoint allows users to enable or disable push notifications\nwithout removing their device token.\n\nArgs:\n    preferences: Notification preferences\n    current_user: Current authenticated user\n    db: Database session\n\nReturns:\n    Updated notification preferences",
        "operationId": "update_notification_preferences_v1_notifications_preferences_put",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NotificationPreferences"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NotificationPreferencesResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "summary": "Update Notification Preferences",
        "tags": [
          "notifications"
        ]
      }
    },
    "/v1/notifications/register-device": {
      "delete": {
        "description": "Unregister the APNs device token for the current user.\n\nThis endpoint allows users to remove their device token, typically\nwhen logging out or when they no longer want to receive notifications.\n\nArgs:\n    current_user: Current authenticated user\n    db: Database session\n\nReturns:\n    Success response with confirmation message",
        "operationId": "unregister_device_token_v1_notifications_register_device_delete",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeviceTokenResponse"
                }
              }
            },
            "description": "Successful Response"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "summary": "Unregister Device Token",
        "tags": [
          "notifications"
        ]
      },
      "post": {
        "description": "Register or update the APNs device token for the current user.\n\nThis endpoint allows iOS devices to register their APNs device token\nso the backend can send push notifications. The token is stored in\nthe user's profile and will be updated if the device token changes.\n\nArgs:\n    token_data: Device token registration data\n    current_user: Current authenticated user\n    db: Database session\n\nReturns:\n    Success response with confirmation message",
        "operationId": "register_device_token_v1_notifications_register_device_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DeviceTokenRegister"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeviceTokenResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "summary": "Register Device Token",
        "tags": [
          "notifications"
        ]
      }
    },
    "/v1/ping": {
      "get": {
        "description": "Simple ping endpoint for basic connectivity testing.",
        "operationId": "ping_v1_ping_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "Ping",
        "tags": [
          "health"
        ]
      }
    },
    "/v1/questions/unseen": {
      "get": {
        "description": "Get unseen questions for the current user.\n\nThis endpoint returns questions that the user has never seen before,\nfiltered from the active question pool. Questions are selected to ensure\nno repetition for the user.\n\nArgs:\n    count: Number of questions to return (default: 20, max: 100)\n    current_user: Current authenticated user\n    db: Database session\n\nReturns:\n    List of unseen questions with metadata\n\nRaises:\n    HTTPException: If insufficient questions are available",
        "operationId": "get_unseen_questions_v1_questions_unseen_get",
        "parameters": [
          {
            "description": "Number of unseen questions to fetch (1-100)",
            "in": "query",
            "name": "count",
            "required": false,
            "schema": {
              "default": 20,
              "description": "Number of unseen questions to fetch (1-100)",
              "maximum": 100,
              "minimum": 1,
              "title": "Count",
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UnseenQuestionsResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "summary": "Get Unseen Questions",
        "tags": [
          "questions"
        ]
      }
    },
    "/v1/test/active": {
      "get": {
        "description": "Get the user's active (in_progress) test session if any.\n\nArgs:\n    current_user: Current authenticated user\n    db: Database session\n\nReturns:\n    Active test session or None",
        "operationId": "get_active_test_session_v1_test_active_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/TestSessionStatusResponse"
                    }
                  ],
                  "nullable": true,
                  "title": "Response Get Active Test Session V1 Test Active Get"
                }
              }
            },
            "description": "Successful Response"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "summary": "Get Active Test Session",
        "tags": [
          "test"
        ]
      }
    },
    "/v1/test/history": {
      "get": {
        "description": "Get historical test results for the current user with pagination.\n\nResults are returned in reverse chronological order (most recent first).\n\nArgs:\n    limit: Maximum number of results per page (default 50, max 100)\n    offset: Number of results to skip for pagination (default 0)\n    current_user: Current authenticated user\n    db: Database session\n\nReturns:\n    Paginated test results with total count and pagination metadata",
        "operationId": "get_test_history_v1_test_history_get",
        "parameters": [
          {
            "description": "Maximum number of results to return (default 50, max 100)",
            "in": "query",
            "name": "limit",
            "required": false,
            "schema": {
              "default": 50,
              "description": "Maximum number of results to return (default 50, max 100)",
              "maximum": 100,
              "minimum": 1,
              "title": "Limit",
              "type": "integer"
            }
          },
          {
            "description": "Number of results to skip for pagination",
            "in": "query",
            "name": "offset",
            "required": false,
            "schema": {
              "default": 0,
              "description": "Number of results to skip for pagination",
              "minimum": 0,
              "title": "Offset",
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedTestHistoryResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "summary": "Get Test History",
        "tags": [
          "test"
        ]
      }
    },
    "/v1/test/results/{result_id}": {
      "get": {
        "description": "Get a specific test result by ID.\n\nArgs:\n    result_id: Test result ID\n    current_user: Current authenticated user\n    db: Database session\n\nReturns:\n    Test result details with IQ score\n\nRaises:\n    HTTPException: If result not found or doesn't belong to user",
        "operationId": "get_test_result_v1_test_results__result_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "result_id",
            "required": true,
            "schema": {
              "title": "Result Id",
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TestResultResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "summary": "Get Test Result",
        "tags": [
          "test"
        ]
      }
    },
    "/v1/test/session/{session_id}": {
      "get": {
        "description": "Get details for a specific test session.\n\nArgs:\n    session_id: Test session ID\n    current_user: Current authenticated user\n    db: Database session\n\nReturns:\n    Test session details with questions (if session is in_progress)\n\nRaises:\n    HTTPException: If session not found or doesn't belong to user",
        "operationId": "get_test_session_v1_test_session__session_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "session_id",
            "required": true,
            "schema": {
              "title": "Session Id",
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TestSessionStatusResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "summary": "Get Test Session",
        "tags": [
          "test"
        ]
      }
    },
    "/v1/test/start": {
      "post": {
        "description": "Start a new test session for the current user.\n\nCreates a new test session, fetches unseen questions, and marks them\nas seen for the user. Returns the session details and questions.\n\nArgs:\n    question_count: Number of questions to include in test\n    current_user: Current authenticated user\n    db: Database session\n\nReturns:\n    Test session and questions\n\nRaises:\n    HTTPException: If user has active test or insufficient questions\n\nNote:\n    Active Session Prevention Strategy (BCQ-045):\n    This endpoint uses a dual-check pattern to prevent duplicate active sessions:\n\n    1. Application-level check (below): Queries for existing active session BEFORE\n       creating a new one. Returns HTTP 400 with session_id in error message,\n       allowing clients to offer \"Resume existing session\" functionality.\n\n    2. Database-level check (in db.flush()): The partial unique index\n       ix_test_sessions_user_active catches race conditions when two requests\n       pass the app-level check simultaneously. Returns HTTP 409 without\n       session_id (unavailable due to rollback).\n\n    Both checks are intentionally kept because:\n    - App-level provides better UX (session_id for recovery options)\n    - DB-level is a last-resort safeguard for race conditions\n    - The DB constraint guarantees correctness even if app logic is bypassed",
        "operationId": "start_test_v1_test_start_post",
        "parameters": [
          {
            "description": "Number of questions for this test (1-100)",
            "in": "query",
            "name": "question_count",
            "required": false,
            "schema": {
              "default": 20,
              "description": "Number of questions for this test (1-100)",
              "maximum": 100,
              "minimum": 1,
              "title": "Question Count",
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StartTestResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "summary": "Start Test",
        "tags": [
          "test"
        ]
      }
    },
    "/v1/test/submit": {
      "post": {
        "description": "Submit responses for a test session.\n\nValidates and stores all user responses, compares them against correct\nanswers, and marks the test session as completed.\n\nArgs:\n    submission: Response submission with session_id and responses\n    current_user: Current authenticated user\n    db: Database session\n\nReturns:\n    Submission confirmation with updated session details\n\nRaises:\n    HTTPException: If session not found, not authorized, already completed,\n                  or validation fails",
        "operationId": "submit_test_v1_test_submit_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ResponseSubmission"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SubmitTestResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "summary": "Submit Test",
        "tags": [
          "test"
        ]
      }
    },
    "/v1/test/{session_id}/abandon": {
      "post": {
        "description": "Abandon an in-progress test session.\n\nMarks the test session as abandoned without calculating results.\nAny responses saved during the test will be preserved but no\ntest result will be created.\n\nArgs:\n    session_id: Test session ID to abandon\n    current_user: Current authenticated user\n    db: Database session\n\nReturns:\n    Abandoned session details with response count\n\nRaises:\n    HTTPException: If session not found, not authorized, or already completed",
        "operationId": "abandon_test_v1_test__session_id__abandon_post",
        "parameters": [
          {
            "in": "path",
            "name": "session_id",
            "required": true,
            "schema": {
              "title": "Session Id",
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TestSessionAbandonResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "summary": "Abandon Test",
        "tags": [
          "test"
        ]
      }
    },
    "/v1/user/delete-account": {
      "delete": {
        "description": "Delete user account and all associated data (GDPR right to erasure).\n\nThis endpoint permanently deletes:\n- User profile and credentials\n- All test sessions\n- All test responses\n- All test results\n- All user-question associations\n\nThis action is irreversible and complies with GDPR Article 17\n(Right to Erasure).\n\nArgs:\n    current_user: Current authenticated user\n    db: Database session\n\nReturns:\n    No content (204) on successful deletion\n\nRaises:\n    HTTPException: 500 if database error occurs during deletion",
        "operationId": "delete_user_account_v1_user_delete_account_delete",
        "responses": {
          "204": {
            "description": "Successful Response"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "summary": "Delete User Account",
        "tags": [
          "user"
        ]
      }
    },
    "/v1/user/profile": {
      "get": {
        "description": "Get current user's profile information.\n\nArgs:\n    current_user: Current authenticated user\n\nReturns:\n    User profile information",
        "operationId": "get_user_profile_v1_user_profile_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserResponse"
                }
              }
            },
            "description": "Successful Response"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "summary": "Get User Profile",
        "tags": [
          "user"
        ]
      },
      "put": {
        "description": "Update current user's profile information.\n\nOnly provided fields will be updated. Fields not included in the\nrequest body will remain unchanged.\n\nArgs:\n    profile_update: Profile fields to update\n    current_user: Current authenticated user\n    db: Database session\n\nReturns:\n    Updated user profile information",
        "operationId": "update_user_profile_v1_user_profile_put",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UserProfileUpdate"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "summary": "Update User Profile",
        "tags": [
          "user"
        ]
      }
    }
  },
  "tags": [
    {
      "description": "Health check endpoints for monitoring application status",
      "name": "health"
    },
    {
      "description": "Authentication endpoints for user registration, login, and token management",
      "name": "auth"
    },
    {
      "description": "User profile management endpoints",
      "name": "user"
    },
    {
      "description": "Question retrieval endpoints for fetching unseen IQ test questions",
      "name": "questions"
    },
    {
      "description": "Test session management, response submission, and results retrieval endpoints",
      "name": "test"
    }
  ]
}
